<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8">
<meta name="generator" content="ReSpec 35.4.3">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-color:var(--warning-border,#f11);border-width:.2em;border-style:solid;background:#fbe9e9;background:var(--warning-bg,#fbe9e9);color:#000;color:var(--text,#000)}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
pre.idl{padding:1em;position:relative}
pre.idl>code{color:#000;color:var(--text,#000)}
@media print{
pre.idl{white-space:pre-wrap}
}
.idlHeader{display:block;width:150px;background:#8ccbf2;background:var(--def-border,#8ccbf2);color:#fff;color:var(--defrow-border,#fff);font-family:sans-serif;font-weight:700;margin:-1em 0 1em -1em;height:28px;line-height:28px}
.idlHeader a.self-link{margin-left:.3cm;text-decoration:none;border-bottom:none;color:inherit}
.idlID{font-weight:700;color:#005a9c}
.idlType{color:#005a9c}
.idlName{color:#ff4500}
.idlName a{color:#ff4500;border-bottom:1px dotted #ff4500;text-decoration:none}
a.idlEnumItem{color:#000;border-bottom:1px dotted #ccc;text-decoration:none}
.idlSuperclass{font-style:italic;color:#005a9c}
.idlDefaultValue,.idlParamName{font-style:italic}
.extAttr{color:#666}
.idlSectionComment{color:gray}
.idlIncludes a{font-weight:700}
.respec-button-copy-paste:focus{text-decoration:none;border-color:#51a7e8;outline:0;box-shadow:0 0 5px rgba(81,167,232,.5)}
.respec-button-copy-paste:is(:focus:hover,.selected:focus){border-color:#51a7e8}
.respec-button-copy-paste:is(:hover,:active,.zeroclipboard-is-hover,.zeroclipboard-is-active){text-decoration:none;background-color:#ddd;background-image:linear-gradient(#eee,#ddd);border-color:#ccc}
.respec-button-copy-paste:is(:active,.selected,.zeroclipboard-is-active){background-color:#dcdcdc;background-image:none;border-color:#b5b5b5;box-shadow:inset 0 2px 4px rgba(0,0,0,.15)}
.respec-button-copy-paste.selected:hover{background-color:#cfcfcf}
.respec-button-copy-paste:is(:disabled,:disabled:hover,.disabled,.disabled:hover){color:rgba(102,102,102,.5);cursor:default;background-color:rgba(229,229,229,.5);background-image:none;border-color:rgba(197,197,197,.5);box-shadow:none}
@media print{
.respec-button-copy-paste{visibility:hidden}
}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;background:var(--indextable-hover-bg,#fff);color:#000;color:var(--text,#000);box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);box-shadow:0 1em 3em -.4em var(--tocsidebar-shadow,rgba(0,0,0,.3)),0 0 1px 1px var(--tocsidebar-shadow,rgba(0,0,0,.05));border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;border-bottom-color:var(--indextable-hover-bg,#fff);top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1;border-bottom-color:var(--indextable-hover-bg,#a2a9b1)}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;color:var(--text,#000);margin-top:.25em}
.dfn-panel ul a[href]{color:#333;color:var(--text,#333)}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
  
  
<title>Modern Algorithms in the Web Cryptography API</title>
  
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:italic}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
  
<link rel="stylesheet" href="https://w3c.github.io/webcrypto/webcrypto.css" type="text/css">
  
<style>

  var.overline {
    /* We don't use text-decoration: overline because it's rendered way too high */
    text-decoration: underline;
    text-underline-offset: -1.33ex;
    text-decoration-skip-ink: none;
    text-decoration-thickness: 1px !important;
  }
  
</style>
  

<meta name="color-scheme" content="light">
<meta name="description" content="This specification defines a number of post-quantum secure and
      modern cryptographic algorithms for the Web Cryptography API,
      namely ML-KEM, ML-DSA, SLH-DSA, AES-OCB, ChaCha20-Poly1305,
      SHA-3, cSHAKE, KMAC, and Argon2.">
<style>
.hljs{--base:#fafafa;--mono-1:#383a42;--mono-2:#686b77;--mono-3:#717277;--hue-1:#0b76c5;--hue-2:#336ae3;--hue-3:#a626a4;--hue-4:#42803c;--hue-5:#ca4706;--hue-5-2:#c91243;--hue-6:#986801;--hue-6-2:#9a6a01}
@media (prefers-color-scheme:dark){
.hljs{--base:#282c34;--mono-1:#abb2bf;--mono-2:#818896;--mono-3:#5c6370;--hue-1:#56b6c2;--hue-2:#61aeee;--hue-3:#c678dd;--hue-4:#98c379;--hue-5:#e06c75;--hue-5-2:#be5046;--hue-6:#d19a66;--hue-6-2:#e6c07b}
}
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;color:var(--mono-1,#383a42);background:#fafafa;background:var(--base,#fafafa)}
.hljs-comment,.hljs-quote{color:#717277;color:var(--mono-3,#717277);font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4;color:var(--hue-3,#a626a4)}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;color:var(--hue-5,#ca4706);font-weight:700}
.hljs-literal{color:#0b76c5;color:var(--hue-1,#0b76c5)}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c;color:var(--hue-4,#42803c)}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01;color:var(--hue-6-2,#9a6a01)}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801;color:var(--hue-6,#986801)}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3;color:var(--hue-2,#336ae3)}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var:hover{text-decoration:underline;cursor:pointer}
var.respec-hl{color:var(--color,#000);background-color:var(--bg-color);box-shadow:0 0 0 2px var(--bg-color)}
@media (prefers-color-scheme:dark){
var.respec-hl{filter:saturate(.9) brightness(.9)}
}
var.respec-hl-c1{--bg-color:#f4d200}
var.respec-hl-c2{--bg-color:#ff87a2}
var.respec-hl-c3{--bg-color:#96e885}
var.respec-hl-c4{--bg-color:#3eeed2}
var.respec-hl-c5{--bg-color:#eacfb6}
var.respec-hl-c6{--bg-color:#82ddff}
var.respec-hl-c7{--bg-color:#ffbcf2}
@media print{
var.respec-hl{background:0 0;color:#000;box-shadow:unset}
}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#222}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#222;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "github": "WICG/webcrypto-modern-algos",
  "editors": [
    {
      "name": "Daniel Huigens",
      "url": "mailto:daniel.huigens@proton.ch",
      "company": "Proton AG",
      "companyURL": "https://proton.me/"
    },
    {
      "name": "Filip Skokan",
      "url": "mailto:panva.ip@gmail.com",
      "company": "Okta",
      "companyURL": "https://www.okta.com/"
    }
  ],
  "shortName": "webcrypto-modern-algos",
  "specStatus": "CG-DRAFT",
  "group": "wicg",
  "xref": [
    "WebIDL",
    "webcrypto",
    "infra",
    "html"
  ],
  "localBiblio": {
    "JWA": {
      "aliasOf": "RFC7518"
    },
    "FIPS-202": {
      "title": "SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions",
      "href": "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf",
      "publisher": "NIST",
      "date": "August 2015",
      "id": "fips-202"
    },
    "FIPS-203": {
      "title": "Module-Lattice-Based Key-Encapsulation Mechanism Standard",
      "href": "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf",
      "publisher": "NIST",
      "date": "August 2024",
      "id": "fips-203"
    },
    "FIPS-204": {
      "title": "Module-Lattice-Based Digital Signature Standard",
      "href": "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf",
      "publisher": "NIST",
      "date": "August 2024",
      "id": "fips-204"
    },
    "FIPS-205": {
      "title": "Stateless Hash-Based Digital Signature Standard",
      "href": "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.205.pdf",
      "publisher": "NIST",
      "date": "August 2024",
      "id": "fips-205"
    },
    "NIST-SP800-185": {
      "title": "NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash",
      "href": "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf",
      "publisher": "NIST",
      "date": "December 2016",
      "id": "nist-sp800-185"
    },
    "draft-ietf-jose-pqc-kem-01": {
      "title": "Post-Quantum Key Encapsulation Mechanisms (PQ KEMs) for JOSE and COSE",
      "href": "https://www.ietf.org/archive/id/draft-ietf-jose-pqc-kem-01.html",
      "publisher": "IETF",
      "date": "May 2025",
      "id": "draft-ietf-jose-pqc-kem-01"
    },
    "draft-ietf-cose-dilithium-07": {
      "title": "ML-DSA for JOSE and COSE",
      "href": "https://www.ietf.org/archive/id/draft-ietf-cose-dilithium-07.html",
      "publisher": "IETF",
      "date": "June 2025",
      "id": "draft-ietf-cose-dilithium-07"
    },
    "draft-ietf-cose-sphincs-plus-05": {
      "title": "SLH-DSA for JOSE and COSE",
      "href": "https://www.ietf.org/archive/id/draft-ietf-cose-sphincs-plus-05.html",
      "publisher": "IETF",
      "date": "October 2024"
    },
    "CSOR": {
      "title": "Computer Security Objects Register",
      "href": "https://csrc.nist.gov/projects/computer-security-objects-register/algorithm-registration",
      "publisher": "NIST",
      "id": "csor"
    },
    "draft-ietf-lamps-kyber-certificates": {
      "title": "Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Key-Encapsulation Mechanism (ML-KEM)",
      "href": "https://datatracker.ietf.org/doc/draft-ietf-lamps-kyber-certificates/",
      "publisher": "IETF",
      "id": "draft-ietf-lamps-kyber-certificates"
    },
    "draft-ietf-lamps-dilithium-certificates": {
      "title": "Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Digital Signature Algorithm (ML-DSA)",
      "href": "https://datatracker.ietf.org/doc/draft-ietf-lamps-dilithium-certificates/",
      "publisher": "IETF",
      "id": "draft-ietf-lamps-dilithium-certificates"
    }
  },
  "publishISODate": "2025-08-11T00:00:00.000Z",
  "generatedSubtitle": "Draft Community Group Report 11 August 2025"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/cg-draft"></head>

<body class="h-entry" data-cite="WEBIDL WebIDL webcrypto infra html"><div class="head">
    
    <h1 id="title" class="title">Modern Algorithms in the Web Cryptography API</h1> 
    <p id="w3c-state">
      <a href="https://www.w3.org/standards/types#reports">Draft Community Group Report</a>
      <time class="dt-published" datetime="2025-08-11">11 August 2025</time>
    </p>
    <dl>
      
      <dt>Latest published version:</dt><dd>
              <a href="https://www.w3.org/webcrypto-modern-algos/">https://www.w3.org/webcrypto-modern-algos/</a>
            </dd>
      <dt>Latest editor's draft:</dt><dd><a href="https://wicg.github.io/webcrypto-modern-algos/">https://wicg.github.io/webcrypto-modern-algos/</a></dd>
      
      
      
      
      <dt>Editors:</dt><dd class="editor p-author h-card vcard">
    <a class="ed_mailto u-email email p-name" href="mailto:daniel.huigens@proton.ch">Daniel Huigens</a> (<a class="p-org org h-org" href="https://proton.me/">Proton AG</a>)
  </dd><dd class="editor p-author h-card vcard">
    <a class="ed_mailto u-email email p-name" href="mailto:panva.ip@gmail.com">Filip Skokan</a> (<a class="p-org org h-org" href="https://www.okta.com/">Okta</a>)
  </dd>
      
      
      <dt>Feedback:</dt><dd>
        <a href="https://github.com/WICG/webcrypto-modern-algos/">GitHub WICG/webcrypto-modern-algos</a>
        (<a href="https://github.com/WICG/webcrypto-modern-algos/pulls/">pull requests</a>,
        <a href="https://github.com/WICG/webcrypto-modern-algos/issues/new/choose">new issue</a>,
        <a href="https://github.com/WICG/webcrypto-modern-algos/issues/">open issues</a>)
      </dd>
      
    </dl>
    
    <p class="copyright">
          <a href="https://www.w3.org/policies/#copyright">Copyright</a>
          ©
          2025
          
          the Contributors to the Modern Algorithms in the Web Cryptography API
          Specification, published by the
          <a href="https://www.w3.org/groups/cg/wicg">Web Platform Incubator Community Group</a> under the
          <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>. A human-readable
                <a href="https://www.w3.org/community/about/agreements/cla-deed/">summary</a>
                is available.
              
        </p>
    <hr title="Separator for header">
  </div>
  <section id="abstract" class="introductory"><h2>Abstract</h2>
    <p>
      This specification defines a number of post-quantum secure and
      modern cryptographic algorithms for the <cite><a class="bibref" data-link-type="biblio" href="#bib-webcrypto" title="Web Cryptography Level 2">Web Cryptography API</a></cite>,
      namely ML-KEM, ML-DSA, SLH-DSA, AES-OCB, ChaCha20-Poly1305,
      SHA-3, cSHAKE, KMAC, and Argon2.
    </p>
  </section>
  <section id="sotd" class="introductory"><h2>Status of This Document</h2><p>
      This specification was published by the
      <a href="https://www.w3.org/groups/cg/wicg">Web Platform Incubator Community Group</a>. It is not a W3C Standard nor is it
      on the W3C Standards Track.
      
            Please note that under the
            <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>
            there is a limited opt-out and other conditions apply.
          
      Learn more about
      <a href="https://www.w3.org/community/">W3C Community and Business Groups</a>.
    </p>
    <p>
      This is an unofficial proposal.
    </p>
  <p>
    <a href="https://github.com/WICG/webcrypto-modern-algos/issues/">GitHub Issues</a> are preferred for
          discussion of this specification.
        
    
  </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#specification-conventions"><bdi class="secno">2. </bdi>Specification Conventions</a></li><li class="tocline"><a class="tocxref" href="#partial-subtlecrypto-interface"><bdi class="secno">3. </bdi>Partial SubtleCrypto interface</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#subtlecrypto-interface-datatypes"><bdi class="secno">3.1 </bdi>Data Types</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#subtlecrypto-interface-keyformat"><bdi class="secno">3.1.1 </bdi>Key Formats</a></li><li class="tocline"><a class="tocxref" href="#subtlecrypto-interface-keyusage"><bdi class="secno">3.1.2 </bdi>Key Usages</a></li></ol></li><li class="tocline"><a class="tocxref" href="#partial-subtlecrypto-interface-methods"><bdi class="secno">3.2 </bdi>Methods and Parameters</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#SubtleCrypto-method-encapsulateKey"><bdi class="secno">3.2.1 </bdi>The encapsulateKey method</a></li><li class="tocline"><a class="tocxref" href="#SubtleCrypto-method-encapsulateBits"><bdi class="secno">3.2.2 </bdi>The encapsulateBits method</a></li><li class="tocline"><a class="tocxref" href="#SubtleCrypto-method-decapsulateKey"><bdi class="secno">3.2.3 </bdi>The decapsulateKey method</a></li><li class="tocline"><a class="tocxref" href="#SubtleCrypto-method-decapsulateBits"><bdi class="secno">3.2.4 </bdi>The decapsulateBits method</a></li><li class="tocline"><a class="tocxref" href="#SubtleCrypto-method-getPublicKey"><bdi class="secno">3.2.5 </bdi>The getPublicKey method</a></li><li class="tocline"><a class="tocxref" href="#SubtleCrypto-method-supports"><bdi class="secno">3.2.6 </bdi>The supports method</a></li></ol></li><li class="tocline"><a class="tocxref" href="#partial-subtlecrypto-interface-checking-support-for-algorithm"><bdi class="secno">3.3 </bdi>Checking support for an algorithm</a></li></ol></li><li class="tocline"><a class="tocxref" href="#encapsulation"><bdi class="secno">4. </bdi>Encapsulation dictionaries</a></li><li class="tocline"><a class="tocxref" href="#JsonWebKey-dictionary"><bdi class="secno">5. </bdi>JsonWebKey dictionary</a></li><li class="tocline"><a class="tocxref" href="#ml-kem"><bdi class="secno">6. </bdi>ML-KEM</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#ml-kem-description"><bdi class="secno">6.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#ml-kem-registration"><bdi class="secno">6.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#ml-kem-operations"><bdi class="secno">6.3 </bdi>Operations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#ml-kem-operations-encapsulate"><bdi class="secno">6.3.1 </bdi>Encapsulate</a></li><li class="tocline"><a class="tocxref" href="#ml-kem-operations-decapsulate"><bdi class="secno">6.3.2 </bdi>Decapsulate</a></li><li class="tocline"><a class="tocxref" href="#ml-kem-operations-generate-key"><bdi class="secno">6.3.3 </bdi>Generate Key</a></li><li class="tocline"><a class="tocxref" href="#ml-kem-operations-import-key"><bdi class="secno">6.3.4 </bdi>Import Key</a></li><li class="tocline"><a class="tocxref" href="#ml-kem-operations-export-key"><bdi class="secno">6.3.5 </bdi>Export Key</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#ml-dsa"><bdi class="secno">7. </bdi>ML-DSA</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#ml-dsa-description"><bdi class="secno">7.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#ml-dsa-registration"><bdi class="secno">7.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#context-params"><bdi class="secno">7.3 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="ContextParams" data-dfn-for=""><code>ContextParams</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#ml-dsa-operations"><bdi class="secno">7.4 </bdi>Operations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#ml-dsa-operations-sign"><bdi class="secno">7.4.1 </bdi>Sign</a></li><li class="tocline"><a class="tocxref" href="#ml-dsa-operations-verify"><bdi class="secno">7.4.2 </bdi>Verify</a></li><li class="tocline"><a class="tocxref" href="#ml-dsa-operations-generate-key"><bdi class="secno">7.4.3 </bdi>Generate Key</a></li><li class="tocline"><a class="tocxref" href="#ml-dsa-operations-import-key"><bdi class="secno">7.4.4 </bdi>Import Key</a></li><li class="tocline"><a class="tocxref" href="#ml-dsa-operations-export-key"><bdi class="secno">7.4.5 </bdi>Export Key</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#slh-dsa"><bdi class="secno">8. </bdi>SLH-DSA</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#slh-dsa-description"><bdi class="secno">8.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#slh-dsa-registration"><bdi class="secno">8.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#slh-dsa-operations"><bdi class="secno">8.3 </bdi>Operations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#slh-dsa-operations-sign"><bdi class="secno">8.3.1 </bdi>Sign</a></li><li class="tocline"><a class="tocxref" href="#slh-dsa-operations-verify"><bdi class="secno">8.3.2 </bdi>Verify</a></li><li class="tocline"><a class="tocxref" href="#slh-dsa-operations-generate-key"><bdi class="secno">8.3.3 </bdi>Generate Key</a></li><li class="tocline"><a class="tocxref" href="#slh-dsa-operations-import-key"><bdi class="secno">8.3.4 </bdi>Import Key</a></li><li class="tocline"><a class="tocxref" href="#slh-dsa-operations-export-key"><bdi class="secno">8.3.5 </bdi>Export Key</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#aes-ocb"><bdi class="secno">9. </bdi>AES-OCB</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#aes-ocb-description"><bdi class="secno">9.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#aes-ocb-registration"><bdi class="secno">9.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#aead-params"><bdi class="secno">9.3 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="AeadParams" data-dfn-for=""><code>AeadParams</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#aes-ocb-operations"><bdi class="secno">9.4 </bdi>Operations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#aes-ocb-operations-encrypt"><bdi class="secno">9.4.1 </bdi>Encrypt</a></li><li class="tocline"><a class="tocxref" href="#aes-ocb-operations-decrypt"><bdi class="secno">9.4.2 </bdi>Decrypt</a></li><li class="tocline"><a class="tocxref" href="#aes-ocb-operations-generate-key"><bdi class="secno">9.4.3 </bdi>Generate Key</a></li><li class="tocline"><a class="tocxref" href="#aes-ocb-operations-import-key"><bdi class="secno">9.4.4 </bdi>Import Key</a></li><li class="tocline"><a class="tocxref" href="#aes-ocb-operations-export-key"><bdi class="secno">9.4.5 </bdi>Export Key</a></li><li class="tocline"><a class="tocxref" href="#aes-ocb-operations-get-key-length"><bdi class="secno">9.4.6 </bdi>Get key length</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#chacha20-poly1305"><bdi class="secno">10. </bdi>ChaCha20-Poly1305</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#chacha20-poly1305-description"><bdi class="secno">10.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#chacha20-poly1305-registration"><bdi class="secno">10.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#chacha20-poly1305-operations"><bdi class="secno">10.3 </bdi>Operations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#chacha20-poly1305-operations-encrypt"><bdi class="secno">10.3.1 </bdi>Encrypt</a></li><li class="tocline"><a class="tocxref" href="#chacha20-poly1305-operations-decrypt"><bdi class="secno">10.3.2 </bdi>Decrypt</a></li><li class="tocline"><a class="tocxref" href="#chacha20-poly1305-operations-generate-key"><bdi class="secno">10.3.3 </bdi>Generate Key</a></li><li class="tocline"><a class="tocxref" href="#chacha20-poly1305-operations-import-key"><bdi class="secno">10.3.4 </bdi>Import Key</a></li><li class="tocline"><a class="tocxref" href="#chacha20-poly1305-operations-export-key"><bdi class="secno">10.3.5 </bdi>Export Key</a></li><li class="tocline"><a class="tocxref" href="#chacha20-poly1305-operations-get-key-length"><bdi class="secno">10.3.6 </bdi>Get key length</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#sha3"><bdi class="secno">11. </bdi>SHA-3</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#sha3-description"><bdi class="secno">11.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#sha3-registration"><bdi class="secno">11.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#sha3-operations"><bdi class="secno">11.3 </bdi>Operations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#sha3-operations-digest"><bdi class="secno">11.3.1 </bdi>Digest</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#cshake"><bdi class="secno">12. </bdi>cSHAKE</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#cshake-description"><bdi class="secno">12.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#cshake-registration"><bdi class="secno">12.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#cshake-params"><bdi class="secno">12.3 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="CShakeParams" data-dfn-for=""><code>CShakeParams</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#cshake-operations"><bdi class="secno">12.4 </bdi>Operations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#cshake-operations-digest"><bdi class="secno">12.4.1 </bdi>Digest</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#kmac"><bdi class="secno">13. </bdi>KMAC</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#kmac-description"><bdi class="secno">13.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#kmac-registration"><bdi class="secno">13.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#kmac-keygen-params"><bdi class="secno">13.3 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="KmacKeyGenParams" data-dfn-for=""><code>KmacKeyGenParams</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#kmac-importparams"><bdi class="secno">13.4 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="KmacImportParams" data-dfn-for=""><code>KmacImportParams</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#KmacKeyAlgorithm-dictionary"><bdi class="secno">13.5 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="KmacKeyAlgorithm" data-dfn-for=""><code>KmacKeyAlgorithm</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#kmac-params"><bdi class="secno">13.6 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="KmacParams" data-dfn-for=""><code>KmacParams</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#kmac-operations"><bdi class="secno">13.7 </bdi>Operations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#kmac-operations-sign"><bdi class="secno">13.7.1 </bdi>Sign</a></li><li class="tocline"><a class="tocxref" href="#kmac-operations-verify"><bdi class="secno">13.7.2 </bdi>Verify</a></li><li class="tocline"><a class="tocxref" href="#kmac-operations-generate-key"><bdi class="secno">13.7.3 </bdi>Generate Key</a></li><li class="tocline"><a class="tocxref" href="#kmac-operations-import-key"><bdi class="secno">13.7.4 </bdi>Import Key</a></li><li class="tocline"><a class="tocxref" href="#kmac-operations-export-key"><bdi class="secno">13.7.5 </bdi>Export Key</a></li><li class="tocline"><a class="tocxref" href="#kmac-operations-get-key-length"><bdi class="secno">13.7.6 </bdi>Get key length</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#argon2"><bdi class="secno">14. </bdi>Argon2</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#argon2-description"><bdi class="secno">14.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#argon2-registration"><bdi class="secno">14.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#argon2-params"><bdi class="secno">14.3 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="Argon2Params" data-dfn-for=""><code>Argon2Params</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#argon2-operations"><bdi class="secno">14.4 </bdi>Operations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#argon2-operations-derive-bits"><bdi class="secno">14.4.1 </bdi>Derive Bits</a></li><li class="tocline"><a class="tocxref" href="#argon2-operations-import-key"><bdi class="secno">14.4.2 </bdi>Import key</a></li><li class="tocline"><a class="tocxref" href="#argon2-operations-get-key-length"><bdi class="secno">14.4.3 </bdi>Get key length</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#usage-example"><bdi class="secno">15. </bdi>Usage Example</a></li><li class="tocline"><a class="tocxref" href="#jwk-mapping"><bdi class="secno">A. </bdi>Mapping between JSON Web Key / JSON Web Algorithm</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#algorithm-mappings"><bdi class="secno">A.1 </bdi>Algorithm mappings</a></li></ol></li><li class="tocline"><a class="tocxref" href="#pkcs8-mapping"><bdi class="secno">B. </bdi>Mapping between Algorithm and PKCS#8 PrivateKeyInfo</a></li><li class="tocline"><a class="tocxref" href="#spki-mapping"><bdi class="secno">C. </bdi>Mapping between Algorithm and SubjectPublicKeyInfo</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">D. </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">E. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">E.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">E.2 </bdi>Informative references</a></li></ol></li></ol></nav>
  <section id="introduction" class="informative"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div><p><em>This section is non-normative.</em></p>
    
    <p>
      This proposal aims to modernize the set of cryptographic algorithms
      available in the <cite><a class="bibref" data-link-type="biblio" href="#bib-webcrypto" title="Web Cryptography Level 2">Web Cryptography API</a></cite>, such that
      web applications can make use of post-quantum secure and
      performant cryptographic algorithms.
      To this end, the following cryptographic algorithms are added:
      </p><ul>
        <li><a href="#ml-kem">ML-KEM</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-203" title="Module-Lattice-Based Key-Encapsulation Mechanism Standard">FIPS-203</a></cite>]</li>
        <li><a href="#ml-dsa">ML-DSA</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-204" title="Module-Lattice-Based Digital Signature Standard">FIPS-204</a></cite>]</li>
        <li><a href="#slh-dsa">SLH-DSA</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-205" title="Stateless Hash-Based Digital Signature Standard">FIPS-205</a></cite>]</li>
        <li><a href="#aes-ocb">AES-OCB</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7253" title="The OCB Authenticated-Encryption Algorithm">RFC7253</a></cite>]</li>
        <li><a href="#chacha20-poly1305">ChaCha20-Poly1305</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8439" title="ChaCha20 and Poly1305 for IETF Protocols">RFC8439</a></cite>]</li>
        <li><a href="#sha3">SHA3-256, SHA3-384, and SHA3-512</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-202" title="SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions">FIPS-202</a></cite>]</li>
        <li><a href="#cshake">cSHAKE128, cSHAKE256</a>, <a href="#kmac">KMAC128 and KMAC256</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>]</li>
        <li><a href="#argon2">Argon2d, Argon2i, and Argon2id</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9106" title="Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications">RFC9106</a></cite>]</li>
      </ul>
    <p></p>
    <p>
      To accommodate the usage of ML-KEM, and possibly future other KEMs,
      this proposal introduces functions for key encapsulation and decapsulation;
      <a href="#dfn-SubtleCrypto-method-encapsulateKey" id="ref-for-dfn-SubtleCrypto-method-encapsulateKey-1"><code>SubtleCrypto.encapsulateKey</code></a>,
      <a href="#dfn-SubtleCrypto-method-encapsulateBits" id="ref-for-dfn-SubtleCrypto-method-encapsulateBits-1"><code>SubtleCrypto.encapsulateBits</code></a>,
      <a href="#dfn-SubtleCrypto-method-decapsulateKey" id="ref-for-dfn-SubtleCrypto-method-decapsulateKey-1"><code>SubtleCrypto.decapsulateKey</code></a> and
      <a href="#dfn-SubtleCrypto-method-decapsulateBits" id="ref-for-dfn-SubtleCrypto-method-decapsulateBits-1"><code>SubtleCrypto.decapsulateBits</code></a>.
    </p>
    <p>
      Additionally, this proposal introduces the <a href="#dfn-SubtleCrypto-method-getPublicKey" id="ref-for-dfn-SubtleCrypto-method-getPublicKey-1"><code>SubtleCrypto.getPublicKey</code></a> function,
      which provides a convenient way to derive a public key from an asymmetric private key,
      eliminating the need to store both the public and private key separately when only the private key is needed.
    </p>
    <p>
      Finally, this proposal aims to make feature detection easier,
      by adding a <a href="#dfn-SubtleCrypto-method-supports" id="ref-for-dfn-SubtleCrypto-method-supports-1"><code>SubtleCrypto.supports</code></a> function,
      which can be used to detect whether a given algorithm identifier
      (including any parameters) is supported for the given operation.
    </p>
  </section>
  <section id="specification-conventions"><div class="header-wrapper"><h2 id="x2-specification-conventions"><bdi class="secno">2. </bdi>Specification Conventions</h2><a class="self-link" href="#specification-conventions" aria-label="Permalink for Section 2."></a></div>
    
    <p>
      This specification follows the <a href="https://www.w3.org/TR/webcrypto-2/#algorithm-conventions">conventions</a>
      laid out in Section 18.3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-webcrypto" title="Web Cryptography Level 2">webcrypto</a></cite>]. None of the algorithms defined here
      are required to be implemented, but if a conforming User Agent implements an
      algorithm, it <em class="rfc2119">MUST</em> implement all of the supported operations specified in this
      document, and must perform the steps to <a href="https://www.w3.org/TR/webcrypto-2/#concept-define-an-algorithm">define an algorithm</a>
      specified in section 18.4.3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-webcrypto" title="Web Cryptography Level 2">webcrypto</a></cite>] for each of the supported operations.
    </p>
  </section>

  <section id="partial-subtlecrypto-interface"><div class="header-wrapper"><h2 id="x3-partial-subtlecrypto-interface"><bdi class="secno">3. </bdi>Partial SubtleCrypto interface</h2><a class="self-link" href="#partial-subtlecrypto-interface" aria-label="Permalink for Section 3."></a></div>
    
    <p>
      This section extends the <a data-link-type="interface" data-lt="SubtleCrypto" href="https://www.w3.org/TR/webcrypto-2/#dfn-SubtleCrypto"><code>SubtleCrypto</code></a> interface of [<cite><a class="bibref" data-link-type="biblio" href="#bib-webcrypto" title="Web Cryptography Level 2">webcrypto</a></cite>].
    </p>
    <pre class="idl def" id="webidl-993669945"><span class="idlHeader"><a class="self-link" href="#webidl-993669945">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-subtlecrypto-partial-1" data-title="SubtleCrypto">[<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>,<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=(Window,Worker)</span>]
partial interface <a data-idl="partial" data-link-type="interface" data-title="SubtleCrypto" class="idlID" data-dfn-for="SubtleCrypto" href="https://www.w3.org/TR/webcrypto-2/#dfn-SubtleCrypto">SubtleCrypto</a> {<span data-idl="" class="idlMethod" id="idl-def-subtlecrypto-encapsulatekey-encapsulationalgorithm-encapsulationkey-sharedkeyalgorithm-extractable-keyusages" data-title="encapsulateKey" data-dfn-for="SubtleCrypto"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dfn-EncapsulatedKey" class="internalDFN" id="ref-for-dfn-EncapsulatedKey-1"><code>EncapsulatedKey</code></a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dfn-SubtleCrypto-method-encapsulateKey" id="ref-for-dfn-SubtleCrypto-method-encapsulateKey-2"><code>encapsulateKey</code></a>(<span class="idlType">
    <a data-link-type="typedef" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithmidentifier">AlgorithmIdentifier</a></span> <span class="idlParamName">encapsulationAlgorithm</span>,<span class="idlType">
    <a data-link-type="interface" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey">CryptoKey</a></span> <span class="idlParamName">encapsulationKey</span>,<span class="idlType">
    <a data-link-type="typedef" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithmidentifier">AlgorithmIdentifier</a></span> <span class="idlParamName">sharedKeyAlgorithm</span>,<span class="idlType">
    <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a></span> <span class="idlParamName">extractable</span>,<span class="idlType">
    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="#dom-keyusage" class="internalDFN" id="ref-for-dom-keyusage-1"><code>KeyUsage</code></a>&gt;</span> <span class="idlParamName">keyUsages</span>
  );</span><span data-idl="" class="idlMethod" id="idl-def-subtlecrypto-encapsulatebits-encapsulationalgorithm-encapsulationkey" data-title="encapsulateBits" data-dfn-for="SubtleCrypto"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dfn-EncapsulatedBits" class="internalDFN" id="ref-for-dfn-EncapsulatedBits-1"><code>EncapsulatedBits</code></a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dfn-SubtleCrypto-method-encapsulateBits" id="ref-for-dfn-SubtleCrypto-method-encapsulateBits-2"><code>encapsulateBits</code></a>(<span class="idlType">
    <a data-link-type="typedef" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithmidentifier">AlgorithmIdentifier</a></span> <span class="idlParamName">encapsulationAlgorithm</span>,<span class="idlType">
    <a data-link-type="interface" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey">CryptoKey</a></span> <span class="idlParamName">encapsulationKey</span>
  );</span><span data-idl="" class="idlMethod" id="idl-def-subtlecrypto-decapsulatekey-decapsulationalgorithm-decapsulationkey-ciphertext-sharedkeyalgorithm-extractable-keyusages" data-title="decapsulateKey" data-dfn-for="SubtleCrypto"><span class="idlType">

  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="interface" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey">CryptoKey</a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dfn-SubtleCrypto-method-decapsulateKey" id="ref-for-dfn-SubtleCrypto-method-decapsulateKey-2"><code>decapsulateKey</code></a>(<span class="idlType">
    <a data-link-type="typedef" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithmidentifier">AlgorithmIdentifier</a></span> <span class="idlParamName">decapsulationAlgorithm</span>,<span class="idlType">
    <a data-link-type="interface" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey">CryptoKey</a></span> <span class="idlParamName">decapsulationKey</span>,<span class="idlType">
    <a data-link-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <span class="idlParamName">ciphertext</span>,<span class="idlType">
    <a data-link-type="typedef" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithmidentifier">AlgorithmIdentifier</a></span> <span class="idlParamName">sharedKeyAlgorithm</span>,<span class="idlType">
    <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a></span> <span class="idlParamName">extractable</span>,<span class="idlType">
    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="#dom-keyusage" class="internalDFN" id="ref-for-dom-keyusage-2"><code>KeyUsage</code></a>&gt;</span> <span class="idlParamName">keyUsages</span>
  );</span><span data-idl="" class="idlMethod" id="idl-def-subtlecrypto-decapsulatebits-decapsulationalgorithm-decapsulationkey-ciphertext" data-title="decapsulateBits" data-dfn-for="SubtleCrypto"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer">ArrayBuffer</a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dfn-SubtleCrypto-method-decapsulateBits" id="ref-for-dfn-SubtleCrypto-method-decapsulateBits-2"><code>decapsulateBits</code></a>(<span class="idlType">
    <a data-link-type="typedef" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithmidentifier">AlgorithmIdentifier</a></span> <span class="idlParamName">decapsulationAlgorithm</span>,<span class="idlType">
    <a data-link-type="interface" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey">CryptoKey</a></span> <span class="idlParamName">decapsulationKey</span>,<span class="idlType">
    <a data-link-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <span class="idlParamName">ciphertext</span>
  );</span><span data-idl="" class="idlMethod" id="idl-def-subtlecrypto-getpublickey-key-keyusages" data-title="getPublicKey" data-dfn-for="SubtleCrypto"><span class="idlType">

  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="interface" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey">CryptoKey</a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dfn-SubtleCrypto-method-getPublicKey" id="ref-for-dfn-SubtleCrypto-method-getPublicKey-2"><code>getPublicKey</code></a>(<span class="idlType">
    <a data-link-type="interface" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey">CryptoKey</a></span> <span class="idlParamName">key</span>,<span class="idlType">
    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="#dom-keyusage" class="internalDFN" id="ref-for-dom-keyusage-3"><code>KeyUsage</code></a>&gt;</span> <span class="idlParamName">keyUsages</span>
  );</span><span data-idl="" class="idlMethod" id="idl-def-subtlecrypto-supports-operation-algorithm-length" data-title="supports" data-dfn-for="SubtleCrypto">

  static<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dfn-SubtleCrypto-method-supports" id="ref-for-dfn-SubtleCrypto-method-supports-2"><code>supports</code></a>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">operation</span>,<span class="idlType">
                   <a data-link-type="typedef" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithmidentifier">AlgorithmIdentifier</a></span> <span class="idlParamName">algorithm</span>,
                   optional<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a>?</span> <span class="idlParamName">length</span> = null);</span><span data-idl="" class="idlMethod" id="idl-def-subtlecrypto-supports!overload-1" data-title="supports!overload-1" data-dfn-for="SubtleCrypto">
  static<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dfn-SubtleCrypto-method-supports-additionalAlgorithm" id="ref-for-dfn-SubtleCrypto-method-supports-additionalAlgorithm-1"><code>supports</code></a>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">operation</span>,<span class="idlType">
                   <a data-link-type="typedef" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithmidentifier">AlgorithmIdentifier</a></span> <span class="idlParamName">algorithm</span>,<span class="idlType">
                   <a data-link-type="typedef" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithmidentifier">AlgorithmIdentifier</a></span> <span class="idlParamName">additionalAlgorithm</span>);</span>
};</span></code></pre>

    <section id="subtlecrypto-interface-datatypes"><div class="header-wrapper"><h3 id="x3-1-data-types"><bdi class="secno">3.1 </bdi>Data Types</h3><a class="self-link" href="#subtlecrypto-interface-datatypes" aria-label="Permalink for Section 3.1"></a></div>
      
      <section id="subtlecrypto-interface-keyformat"><div class="header-wrapper"><h4 id="x3-1-1-key-formats"><bdi class="secno">3.1.1 </bdi>Key Formats</h4><a class="self-link" href="#subtlecrypto-interface-keyformat" aria-label="Permalink for Section 3.1.1"></a></div>
        
        <p>
          This specification replaces the definition of <a href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyFormat"><code>KeyFormat</code></a>
          in [<cite><a class="bibref" data-link-type="biblio" href="#bib-webcrypto" title="Web Cryptography Level 2">webcrypto</a></cite>] with the following:
        </p>
        <pre class="idl def" id="webidl-1896181443"><span class="idlHeader"><a class="self-link" href="#webidl-1896181443">WebIDL</a></span><code><span data-idl="" class="idlEnum" id="idl-def-keyformat" data-title="KeyFormat">enum <dfn data-export="" data-dfn-type="enum" id="dom-keyformat" data-idl="enum" data-title="KeyFormat" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>KeyFormat</code></dfn> { <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-keyformat-raw-public" id="ref-for-dom-keyformat-raw-public-1"><code>raw-public</code></a>"</span>, <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-keyformat-raw-private" id="ref-for-dom-keyformat-raw-private-1"><code>raw-private</code></a>"</span>, <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-keyformat-raw-seed" id="ref-for-dom-keyformat-raw-seed-1"><code>raw-seed</code></a>"</span>, <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-keyformat-raw-secret" id="ref-for-dom-keyformat-raw-secret-1"><code>raw-secret</code></a>"</span>, <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-keyformat-raw" data-idl="enum-value" data-title="raw" data-dfn-for="KeyFormat" tabindex="0" aria-haspopup="dialog"><code>raw</code></dfn>"</span>, <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-keyformat-spki" data-idl="enum-value" data-title="spki" data-dfn-for="KeyFormat" tabindex="0" aria-haspopup="dialog"><code>spki</code></dfn>"</span>, <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-keyformat-pkcs8" data-idl="enum-value" data-title="pkcs8" data-dfn-for="KeyFormat" tabindex="0" aria-haspopup="dialog"><code>pkcs8</code></dfn>"</span>, <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-keyformat-jwk" data-idl="enum-value" data-title="jwk" data-dfn-for="KeyFormat" tabindex="0" aria-haspopup="dialog"><code>jwk</code></dfn>"</span> };</span></code></pre>
        <p>
          This specification specifies a number of new <a href="https://www.w3.org/TR/webcrypto-2/#dfn-RecognizedKeyFormats">recognized key format values</a>:
        </p>
        <dl data-dfn-for="KeyFormat">
          <dt><dfn data-idl="enum-value" data-export="" data-dfn-type="enum-value" id="dom-keyformat-raw-public" data-title="raw-public" data-dfn-for="KeyFormat" tabindex="0" aria-haspopup="dialog"><code>raw-public</code></dfn></dt>
          <dd>An unformatted sequence of public key bytes.</dd>
          <dt><dfn data-idl="enum-value" data-export="" data-dfn-type="enum-value" id="dom-keyformat-raw-private" data-title="raw-private" data-dfn-for="KeyFormat" tabindex="0" aria-haspopup="dialog"><code>raw-private</code></dfn></dt>
          <dd>An unformatted sequence of private key bytes.</dd>
          <dt><dfn data-idl="enum-value" data-export="" data-dfn-type="enum-value" id="dom-keyformat-raw-seed" data-title="raw-seed" data-dfn-for="KeyFormat" tabindex="0" aria-haspopup="dialog"><code>raw-seed</code></dfn></dt>
          <dd>An unformatted sequence of private key seed bytes.</dd>
          <dt><dfn data-idl="enum-value" data-export="" data-dfn-type="enum-value" id="dom-keyformat-raw-secret" data-title="raw-secret" data-dfn-for="KeyFormat" tabindex="0" aria-haspopup="dialog"><code>raw-secret</code></dfn></dt>
          <dd>An unformatted sequence of secret key bytes.</dd>
        </dl>
        <p>
          For all existing symmetric algorithms in [<cite><a class="bibref" data-link-type="biblio" href="#bib-webcrypto" title="Web Cryptography Level 2">webcrypto</a></cite>],
          "<a data-link-type="idl" href="#dom-keyformat-raw-secret" class="internalDFN" id="ref-for-dom-keyformat-raw-secret-2"><code>raw-secret</code></a>" acts as an alias of "<a data-link-type="idl" href="#dom-keyformat-raw" class="internalDFN" id="ref-for-dom-keyformat-raw-1"><code>raw</code></a>".
        </p>
        <p>
          For all existing asymmetric algorithms in [<cite><a class="bibref" data-link-type="biblio" href="#bib-webcrypto" title="Web Cryptography Level 2">webcrypto</a></cite>],
          "<a data-link-type="idl" href="#dom-keyformat-raw-public" class="internalDFN" id="ref-for-dom-keyformat-raw-public-2"><code>raw-public</code></a>" acts as an alias of "<a data-link-type="idl" href="#dom-keyformat-raw" class="internalDFN" id="ref-for-dom-keyformat-raw-2"><code>raw</code></a>".
        </p>
        <p>
          In the <a data-link-type="method" data-lt="deriveKey()" href="https://www.w3.org/TR/webcrypto-2/#dfn-SubtleCrypto-method-deriveKey"><code>deriveKey</code></a><code>()</code> method, in the import key step,
          "<a data-link-type="idl" href="#dom-keyformat-raw-secret" class="internalDFN" id="ref-for-dom-keyformat-raw-secret-3"><code>raw-secret</code></a>" must be used as the format instead of "<a data-link-type="idl" href="#dom-keyformat-raw" class="internalDFN" id="ref-for-dom-keyformat-raw-3"><code>raw</code></a>".
        </p>
      </section>
      <section id="subtlecrypto-interface-keyusage"><div class="header-wrapper"><h4 id="x3-1-2-key-usages"><bdi class="secno">3.1.2 </bdi>Key Usages</h4><a class="self-link" href="#subtlecrypto-interface-keyusage" aria-label="Permalink for Section 3.1.2"></a></div>
        
        <p>
          This specification replaces the definition of <a href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyUsage"><code>KeyUsage</code></a>
          in [<cite><a class="bibref" data-link-type="biblio" href="#bib-webcrypto" title="Web Cryptography Level 2">webcrypto</a></cite>] with the following:
        </p>
        <pre class="idl def" id="webidl-712964944"><span class="idlHeader"><a class="self-link" href="#webidl-712964944">WebIDL</a></span><code><span data-idl="" class="idlEnum" id="idl-def-keyusage" data-title="KeyUsage">enum <dfn data-export="" data-dfn-type="enum" id="dom-keyusage" data-idl="enum" data-title="KeyUsage" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>KeyUsage</code></dfn> { <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-keyusage-encrypt" data-idl="enum-value" data-title="encrypt" data-dfn-for="KeyUsage" tabindex="0" aria-haspopup="dialog"><code>encrypt</code></dfn>"</span>, <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-keyusage-decrypt" data-idl="enum-value" data-title="decrypt" data-dfn-for="KeyUsage" tabindex="0" aria-haspopup="dialog"><code>decrypt</code></dfn>"</span>, <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-keyusage-sign" data-idl="enum-value" data-title="sign" data-dfn-for="KeyUsage" tabindex="0" aria-haspopup="dialog"><code>sign</code></dfn>"</span>, <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-keyusage-verify" data-idl="enum-value" data-title="verify" data-dfn-for="KeyUsage" tabindex="0" aria-haspopup="dialog"><code>verify</code></dfn>"</span>, <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-keyusage-derivekey" data-idl="enum-value" data-title="deriveKey" data-dfn-for="KeyUsage" tabindex="0" aria-haspopup="dialog"><code>deriveKey</code></dfn>"</span>, <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-keyusage-derivebits" data-idl="enum-value" data-title="deriveBits" data-dfn-for="KeyUsage" tabindex="0" aria-haspopup="dialog"><code>deriveBits</code></dfn>"</span>, <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-keyusage-wrapkey" data-idl="enum-value" data-title="wrapKey" data-dfn-for="KeyUsage" tabindex="0" aria-haspopup="dialog"><code>wrapKey</code></dfn>"</span>, <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-keyusage-unwrapkey" data-idl="enum-value" data-title="unwrapKey" data-dfn-for="KeyUsage" tabindex="0" aria-haspopup="dialog"><code>unwrapKey</code></dfn>"</span>, <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-keyusage-encapsulatekey" id="ref-for-dom-keyusage-encapsulatekey-1"><code>encapsulateKey</code></a>"</span>, <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-keyusage-encapsulatebits" id="ref-for-dom-keyusage-encapsulatebits-1"><code>encapsulateBits</code></a>"</span>, <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-keyusage-decapsulatekey" id="ref-for-dom-keyusage-decapsulatekey-1"><code>decapsulateKey</code></a>"</span>, <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-keyusage-decapsulatebits" id="ref-for-dom-keyusage-decapsulatebits-1"><code>decapsulateBits</code></a>"</span> };</span></code></pre>
        <p>
          This specification specifies a number of new <a href="https://www.w3.org/TR/webcrypto-2/#dfn-RecognizedKeyUsages">recognized key usage values</a>:
        </p>
        <dl data-dfn-for="KeyUsage">
          <dt><dfn data-idl="enum-value" data-export="" data-dfn-type="enum-value" id="dom-keyusage-encapsulatekey" data-title="encapsulateKey" data-dfn-for="KeyUsage" tabindex="0" aria-haspopup="dialog"><code>encapsulateKey</code></dfn></dt>
          <dd>Enable using the key with <a data-link-type="interface" data-lt="SubtleCrypto" href="https://www.w3.org/TR/webcrypto-2/#dfn-SubtleCrypto"><code>SubtleCrypto</code></a>.<a data-link-type="idl" href="#dfn-SubtleCrypto-method-encapsulateKey" class="internalDFN" id="ref-for-dfn-SubtleCrypto-method-encapsulateKey-3"><code>encapsulateKey</code></a>.</dd>
          <dt><dfn data-idl="enum-value" data-export="" data-dfn-type="enum-value" id="dom-keyusage-encapsulatebits" data-title="encapsulateBits" data-dfn-for="KeyUsage" tabindex="0" aria-haspopup="dialog"><code>encapsulateBits</code></dfn></dt>
          <dd>Enable using the key with <a data-link-type="interface" data-lt="SubtleCrypto" href="https://www.w3.org/TR/webcrypto-2/#dfn-SubtleCrypto"><code>SubtleCrypto</code></a>.<a data-link-type="idl" href="#dfn-SubtleCrypto-method-encapsulateBits" class="internalDFN" id="ref-for-dfn-SubtleCrypto-method-encapsulateBits-3"><code>encapsulateBits</code></a>.</dd>
          <dt><dfn data-idl="enum-value" data-export="" data-dfn-type="enum-value" id="dom-keyusage-decapsulatekey" data-title="decapsulateKey" data-dfn-for="KeyUsage" tabindex="0" aria-haspopup="dialog"><code>decapsulateKey</code></dfn></dt>
          <dd>Enable using the key with <a data-link-type="interface" data-lt="SubtleCrypto" href="https://www.w3.org/TR/webcrypto-2/#dfn-SubtleCrypto"><code>SubtleCrypto</code></a>.<a data-link-type="idl" href="#dfn-SubtleCrypto-method-decapsulateKey" class="internalDFN" id="ref-for-dfn-SubtleCrypto-method-decapsulateKey-3"><code>decapsulateKey</code></a>.</dd>
          <dt><dfn data-idl="enum-value" data-export="" data-dfn-type="enum-value" id="dom-keyusage-decapsulatebits" data-title="decapsulateBits" data-dfn-for="KeyUsage" tabindex="0" aria-haspopup="dialog"><code>decapsulateBits</code></dfn></dt>
          <dd>Enable using the key with <a data-link-type="interface" data-lt="SubtleCrypto" href="https://www.w3.org/TR/webcrypto-2/#dfn-SubtleCrypto"><code>SubtleCrypto</code></a>.<a data-link-type="idl" href="#dfn-SubtleCrypto-method-decapsulateBits" class="internalDFN" id="ref-for-dfn-SubtleCrypto-method-decapsulateBits-3"><code>decapsulateBits</code></a>.</dd>
        </dl>
      </section>
    </section>

    <section id="partial-subtlecrypto-interface-methods"><div class="header-wrapper"><h3 id="x3-2-methods-and-parameters"><bdi class="secno">3.2 </bdi>Methods and Parameters</h3><a class="self-link" href="#partial-subtlecrypto-interface-methods" aria-label="Permalink for Section 3.2"></a></div>
      
      <section id="SubtleCrypto-method-encapsulateKey"><div class="header-wrapper"><h4 id="x3-2-1-the-encapsulatekey-method"><bdi class="secno">3.2.1 </bdi>The encapsulateKey method</h4><a class="self-link" href="#SubtleCrypto-method-encapsulateKey" aria-label="Permalink for Section 3.2.1"></a></div>
        
        <p>
          The <dfn id="dfn-SubtleCrypto-method-encapsulateKey" data-dfn-for="SubtleCrypto" data-lt="encapsulateKey(encapsulationAlgorithm, encapsulationKey, sharedKeyAlgorithm, extractable, usages)|encapsulateKey()|encapsulateKey(encapsulationAlgorithm, encapsulationKey, sharedKeyAlgorithm, extractable, keyUsages)" data-export="" data-dfn-type="method" data-idl="operation" data-title="encapsulateKey(encapsulationAlgorithm, encapsulationKey, sharedKeyAlgorithm, extractable, usages)" data-type="Promise" data-local-lt="SubtleCrypto.encapsulateKey|SubtleCrypto.encapsulateKey()|encapsulateKey" tabindex="0" aria-haspopup="dialog"><code>encapsulateKey(<var>encapsulationAlgorithm</var>, <var>encapsulationKey</var>, <var>sharedKeyAlgorithm</var>, <var>extractable</var>, <var>usages</var>)</code></dfn>
          method encapsulates a key and returns an <a data-link-type="idl" data-lt="EncapsulatedKey" href="#dfn-EncapsulatedKey" class="internalDFN" id="ref-for-dfn-EncapsulatedKey-2"><code>EncapsulatedKey</code></a> object.
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              Let <var>encapsulationAlgorithm</var>, <var>encapsulationKey</var>, <var>sharedKeyAlgorithm</var>,
              <var>extractable</var> and <var>usages</var> be the <code>encapsulationAlgorithm</code>, <code>encapsulationKey</code>,
              <code>sharedKeyAlgorithm</code>, <code>extractable</code> and <code>keyUsages</code> parameters passed to the
              <a data-link-type="idl" data-lt="encapsulateKey()" href="#dfn-SubtleCrypto-method-encapsulateKey" class="internalDFN" id="ref-for-dfn-SubtleCrypto-method-encapsulateKey-4"><code>encapsulateKey</code></a><code>()</code> method,
              respectively.
            </p>
          </li>
          <li>
            <p>
              Let <var>normalizedEncapsulationAlgorithm</var> be the result of
              <a href="https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
              <code>alg</code> set to <var>encapsulationAlgorithm</var> and <code>op</code> set to
              "<code>encapsulate</code>".
            </p>
          </li>
          <li>
            <p>
              If an error occurred, return a Promise rejected with
              <var>normalizedEncapsulationAlgorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>normalizedSharedKeyAlgorithm</var> be the result of
              <a href="https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
              <code>alg</code> set to <var>sharedKeyAlgorithm</var> and <code>op</code> set to
              "<code>importKey</code>".
            </p>
          </li>
          <li>
            <p>
              If an error occurred, return a Promise rejected with
              <var>normalizedSharedKeyAlgorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>realm</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm">relevant realm</a> of <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this">this</a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>promise</var> be a new Promise.
            </p>
          </li>
          <li>
            <p>
              Return <var>promise</var> and perform the remaining steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>.
            </p>
          </li>
          <li>
            <p>
              If the following steps or referenced procedures say to
              <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an error,
              <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">queue a global task</a> on the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source">crypto task source</a>,
              given <var>realm</var>'s global object,
              to reject <var>promise</var> with the returned error;
              and then <a href="https://www.w3.org/TR/webcrypto-2/#terminate-the-algorithm">terminate the algorithm</a>.
            </p>
          </li>
          <li>
            <p>
              If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
              <var>normalizedEncapsulationAlgorithm</var> is not equal to the
              <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of the
              <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal slot of
              <var>encapsulationKey</var> then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
            </p>
          </li>
          <li>
            <p>
              If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
              <var>encapsulationKey</var> does not contain an entry that is "<code>encapsulateKey</code>",
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>encapsulatedBits</var> be the result of performing the encapsulate operation specified by
              the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal slot of
              <var>encapsulationKey</var> using <var>encapsulationKey</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>sharedKey</var> be the result of performing the import key operation specified by
              <var>normalizedSharedKeyAlgorithm</var> using "<a data-link-type="idl" href="#dom-keyformat-raw-secret" class="internalDFN" id="ref-for-dom-keyformat-raw-secret-4"><code>raw-secret</code></a>" as
              <var>format</var>, the <a data-link-type="idl" href="#dfn-EncapsulatedBits-sharedKey" class="internalDFN" id="ref-for-dfn-EncapsulatedBits-sharedKey-1"><code>sharedKey</code></a> field of
              <var>encapsulatedBits</var> as <var>keyData</var>, <var>sharedKeyAlgorithm</var> as
              <var>algorithm</var> and using
              <var>extractable</var> and <var>usages</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>encapsulatedKey</var> be a new <a data-link-type="idl" data-lt="EncapsulatedKey" href="#dfn-EncapsulatedKey" class="internalDFN" id="ref-for-dfn-EncapsulatedKey-3"><code>EncapsulatedKey</code></a> dictionary
              with <a data-link-type="idl" href="#dfn-EncapsulatedKey-sharedKey" class="internalDFN" id="ref-for-dfn-EncapsulatedKey-sharedKey-1"><code>sharedKey</code></a> set to <var>sharedKey</var>
              and <a data-link-type="idl" href="#dfn-EncapsulatedKey-ciphertext" class="internalDFN" id="ref-for-dfn-EncapsulatedKey-ciphertext-1"><code>ciphertext</code></a> set to the
              <a data-link-type="idl" href="#dfn-EncapsulatedBits-ciphertext" class="internalDFN" id="ref-for-dfn-EncapsulatedBits-ciphertext-1"><code>ciphertext</code></a> field of <var>encapsulatedBits</var>.
            </p>
          </li>
          <li>
            <p>
              <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">Queue a global task</a> on the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source">crypto task source</a>,
              given <var>realm</var>'s global object, to perform the remaining steps.
            </p>
          </li>
          <li>
            <p>
              Let <var>result</var> be the result of converting <var>encapsulatedKey</var> to an ECMAScript Object in <var>realm</var>,
              as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
            </p>
          </li>
          <li>
            <p>
              Resolve <var>promise</var> with
              <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="SubtleCrypto-method-encapsulateBits"><div class="header-wrapper"><h4 id="x3-2-2-the-encapsulatebits-method"><bdi class="secno">3.2.2 </bdi>The encapsulateBits method</h4><a class="self-link" href="#SubtleCrypto-method-encapsulateBits" aria-label="Permalink for Section 3.2.2"></a></div>
        
        <p>
          The <dfn id="dfn-SubtleCrypto-method-encapsulateBits" data-dfn-for="SubtleCrypto" data-lt="encapsulateBits(encapsulationAlgorithm, encapsulationKey)|encapsulateBits()" data-export="" data-dfn-type="method" data-idl="operation" data-title="encapsulateBits(encapsulationAlgorithm, encapsulationKey)" data-type="Promise" data-local-lt="SubtleCrypto.encapsulateBits|SubtleCrypto.encapsulateBits()|encapsulateBits" tabindex="0" aria-haspopup="dialog"><code>encapsulateBits(<var>encapsulationAlgorithm</var>, <var>encapsulationKey</var>)</code></dfn>
          method encapsulates a key and returns an <a data-link-type="idl" data-lt="EncapsulatedBits" href="#dfn-EncapsulatedBits" class="internalDFN" id="ref-for-dfn-EncapsulatedBits-2"><code>EncapsulatedBits</code></a> object.
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              Let <var>encapsulationAlgorithm</var> and <var>encapsulationKey</var> be the <code>encapsulationAlgorithm</code>
              and <code>encapsulationKey</code> parameters passed to the
              <a data-link-type="idl" data-lt="encapsulateBits()" href="#dfn-SubtleCrypto-method-encapsulateBits" class="internalDFN" id="ref-for-dfn-SubtleCrypto-method-encapsulateBits-4"><code>encapsulateBits</code></a><code>()</code> method,
              respectively.
            </p>
          </li>
          <li>
            <p>
              Let <var>normalizedEncapsulationAlgorithm</var> be the result of
              <a href="https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
              <code>alg</code> set to <var>encapsulationAlgorithm</var> and <code>op</code> set to
              "<code>encapsulate</code>".
            </p>
          </li>
          <li>
            <p>
              If an error occurred, return a Promise rejected with
              <var>normalizedEncapsulationAlgorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>realm</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm">relevant realm</a> of <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this">this</a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>promise</var> be a new Promise.
            </p>
          </li>
          <li>
            <p>
              Return <var>promise</var> and perform the remaining steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>.
            </p>
          </li>
          <li>
            <p>
              If the following steps or referenced procedures say to
              <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an error,
              <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">queue a global task</a> on the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source">crypto task source</a>,
              given <var>realm</var>'s global object,
              to reject <var>promise</var> with the returned error;
              and then <a href="https://www.w3.org/TR/webcrypto-2/#terminate-the-algorithm">terminate the algorithm</a>.
            </p>
          </li>
          <li>
            <p>
              If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
              <var>normalizedEncapsulationAlgorithm</var> is not equal to the
              <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of the
              <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal slot of
              <var>encapsulationKey</var> then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
            </p>
          </li>
          <li>
            <p>
              If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
              <var>encapsulationKey</var> does not contain an entry that is "<code>encapsulateBits</code>",
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>encapsulatedBits</var> be the result of performing the encapsulate operation specified by
              the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal slot of
              <var>encapsulationKey</var> using <var>encapsulationKey</var>.
            </p>
          </li>
          <li>
            <p>
              <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">Queue a global task</a> on the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source">crypto task source</a>,
              given <var>realm</var>'s global object, to perform the remaining steps.
            </p>
          </li>
          <li>
            <p>
              Let <var>result</var> be the result of converting <var>encapsulatedBits</var> to an ECMAScript Object in <var>realm</var>,
              as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
            </p>
          </li>
          <li>
            <p>
              Resolve <var>promise</var> with
              <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="SubtleCrypto-method-decapsulateKey"><div class="header-wrapper"><h4 id="x3-2-3-the-decapsulatekey-method"><bdi class="secno">3.2.3 </bdi>The decapsulateKey method</h4><a class="self-link" href="#SubtleCrypto-method-decapsulateKey" aria-label="Permalink for Section 3.2.3"></a></div>
        
        <p>
          The <dfn id="dfn-SubtleCrypto-method-decapsulateKey" data-dfn-for="SubtleCrypto" data-lt="decapsulateKey(decapsulationAlgorithm, decapsulationKey, ciphertext, sharedKeyAlgorithm, extractable, usages)|decapsulateKey()|decapsulateKey(decapsulationAlgorithm, decapsulationKey, ciphertext, sharedKeyAlgorithm, extractable, keyUsages)" data-export="" data-dfn-type="method" data-idl="operation" data-title="decapsulateKey(decapsulationAlgorithm, decapsulationKey, ciphertext, sharedKeyAlgorithm, extractable, usages)" data-type="Promise" data-local-lt="SubtleCrypto.decapsulateKey|SubtleCrypto.decapsulateKey()|decapsulateKey" tabindex="0" aria-haspopup="dialog"><code>decapsulateKey(<var>decapsulationAlgorithm</var>, <var>decapsulationKey</var>, <var>ciphertext</var>, <var>sharedKeyAlgorithm</var>, <var>extractable</var>, <var>usages</var>)</code></dfn>
          method decapsulates a key and returns an <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a> object.
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              Let <var>decapsulationAlgorithm</var>, <var>decapsulationKey</var>, <var>sharedKeyAlgorithm</var>,
              <var>extractable</var> and <var>usages</var> be the <code>decapsulationAlgorithm</code>, <code>decapsulationKey</code>, <code>sharedKeyAlgorithm</code>, <code>extractable</code> and <code>keyUsages</code> parameters passed to the
              <a data-link-type="idl" data-lt="decapsulateKey()" href="#dfn-SubtleCrypto-method-decapsulateKey" class="internalDFN" id="ref-for-dfn-SubtleCrypto-method-decapsulateKey-4"><code>decapsulateKey</code></a><code>()</code> method,
              respectively.
            </p>
          </li>
          <li>
            <p>
              Let <var>ciphertext</var> be the result of
              <a data-link-type="dfn" data-lt="get a copy of the buffer source" href="https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy">getting a copy of the bytes held by</a> the <code>ciphertext</code> parameter passed to the
              <a data-link-type="idl" data-lt="decapsulateKey()" href="#dfn-SubtleCrypto-method-decapsulateKey" class="internalDFN" id="ref-for-dfn-SubtleCrypto-method-decapsulateKey-5"><code>decapsulateKey</code></a><code>()</code> method.
            </p>
          </li>
          <li>
            <p>
              Let <var>normalizedDecapsulationAlgorithm</var> be the result of
              <a href="https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
              <code>alg</code> set to <var>decapsulationAlgorithm</var> and <code>op</code> set to
              "<code>decapsulate</code>".
            </p>
          </li>
          <li>
            <p>
              If an error occurred, return a Promise rejected with
              <var>normalizedDecapsulationAlgorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>normalizedSharedKeyAlgorithm</var> be the result of
              <a href="https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
              <code>alg</code> set to <var>sharedKeyAlgorithm</var> and <code>op</code> set to
              "<code>importKey</code>".
            </p>
          </li>
          <li>
            <p>
              If an error occurred, return a Promise rejected with
              <var>normalizedSharedKeyAlgorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>realm</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm">relevant realm</a> of <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this">this</a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>promise</var> be a new Promise.
            </p>
          </li>
          <li>
            <p>
              Return <var>promise</var> and perform the remaining steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>.
            </p>
          </li>
          <li>
            <p>
              If the following steps or referenced procedures say to
              <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an error,
              <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">queue a global task</a> on the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source">crypto task source</a>,
              given <var>realm</var>'s global object,
              to reject <var>promise</var> with the returned error;
              and then <a href="https://www.w3.org/TR/webcrypto-2/#terminate-the-algorithm">terminate the algorithm</a>.
            </p>
          </li>
          <li>
            <p>
              If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
              <var>normalizedDecapsulationAlgorithm</var> is not equal to the
              <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of the
              <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal slot of
              <var>decapsulationKey</var> then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
            </p>
          </li>
          <li>
            <p>
              If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
              <var>decapsulationKey</var> does not contain an entry that is "<code>decapsulateKey</code>",
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>decapsulatedBits</var> be the result of performing the decapsulate operation specified by
              the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal slot of <var>decapsulationKey</var> using <var>decapsulationKey</var> and <var>ciphertext</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>sharedKey</var> be the result of performing the import key operation specified by
              <var>normalizedSharedKeyAlgorithm</var> using "<a data-link-type="idl" href="#dom-keyformat-raw-secret" class="internalDFN" id="ref-for-dom-keyformat-raw-secret-5"><code>raw-secret</code></a>" as
              <var>format</var>, the <var>decapsulatedBits</var> as <var>keyData</var>, <var>sharedKeyAlgorithm</var> as
              <var>algorithm</var> and using
              <var>extractable</var> and <var>usages</var>.
            </p>
          </li>
          <li>
            <p>
              <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">Queue a global task</a> on the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source">crypto task source</a>,
              given <var>realm</var>'s global object, to perform the remaining steps.
            </p>
          </li>
          <li>
            <p>
              Let <var>result</var> be the result of converting <var>sharedKey</var> to an ECMAScript Object in <var>realm</var>, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
            </p>
          </li>
          <li>
            <p>
              Resolve <var>promise</var> with
              <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="SubtleCrypto-method-decapsulateBits"><div class="header-wrapper"><h4 id="x3-2-4-the-decapsulatebits-method"><bdi class="secno">3.2.4 </bdi>The decapsulateBits method</h4><a class="self-link" href="#SubtleCrypto-method-decapsulateBits" aria-label="Permalink for Section 3.2.4"></a></div>
        
        <p>
          The <dfn id="dfn-SubtleCrypto-method-decapsulateBits" data-dfn-for="SubtleCrypto" data-lt="decapsulateBits(decapsulationAlgorithm, decapsulationKey, ciphertext)|decapsulateBits()" data-export="" data-dfn-type="method" data-idl="operation" data-title="decapsulateBits(decapsulationAlgorithm, decapsulationKey, ciphertext)" data-type="Promise" data-local-lt="SubtleCrypto.decapsulateBits|SubtleCrypto.decapsulateBits()|decapsulateBits" tabindex="0" aria-haspopup="dialog"><code>decapsulateBits(<var>decapsulationAlgorithm</var>, <var>decapsulationKey</var>, <var>ciphertext</var>)</code></dfn>
          method decapsulates a key and returns an <a data-link-type="interface" data-lt="ArrayBuffer" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> object.
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              Let <var>decapsulationAlgorithm</var> and <var>decapsulationKey</var> be the <code>decapsulationAlgorithm</code> and <code>decapsulationKey</code> parameters passed to the
              <a data-link-type="idl" data-lt="decapsulateBits()" href="#dfn-SubtleCrypto-method-decapsulateBits" class="internalDFN" id="ref-for-dfn-SubtleCrypto-method-decapsulateBits-4"><code>decapsulateBits</code></a><code>()</code> method,
              respectively.
            </p>
          </li>
          <li>
            <p>
              Let <var>ciphertext</var> be the result of
              <a data-link-type="dfn" data-lt="get a copy of the buffer source" href="https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy">getting a copy of the bytes held by</a> the <code>ciphertext</code> parameter passed to the
              <a data-link-type="idl" data-lt="decapsulateBits()" href="#dfn-SubtleCrypto-method-decapsulateBits" class="internalDFN" id="ref-for-dfn-SubtleCrypto-method-decapsulateBits-5"><code>decapsulateBits</code></a><code>()</code> method.
            </p>
          </li>
          <li>
            <p>
              Let <var>normalizedDecapsulationAlgorithm</var> be the result of
              <a href="https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
              <code>alg</code> set to <var>decapsulationAlgorithm</var> and <code>op</code> set to
              "<code>decapsulate</code>".
            </p>
          </li>
          <li>
            <p>
              If an error occurred, return a Promise rejected with
              <var>normalizedDecapsulationAlgorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>realm</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm">relevant realm</a> of <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this">this</a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>promise</var> be a new Promise.
            </p>
          </li>
          <li>
            <p>
              Return <var>promise</var> and perform the remaining steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>.
            </p>
          </li>
          <li>
            <p>
              If the following steps or referenced procedures say to
              <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an error,
              <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">queue a global task</a> on the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source">crypto task source</a>,
              given <var>realm</var>'s global object,
              to reject <var>promise</var> with the returned error;
              and then <a href="https://www.w3.org/TR/webcrypto-2/#terminate-the-algorithm">terminate the algorithm</a>.
            </p>
          </li>
          <li>
            <p>
              If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
              <var>normalizedDecapsulationAlgorithm</var> is not equal to the
              <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of the
              <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal slot of
              <var>decapsulationKey</var> then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
            </p>
          </li>
          <li>
            <p>
              If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
              <var>decapsulationKey</var> does not contain an entry that is "<code>decapsulateBits</code>",
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>decapsulatedBits</var> be the result of performing the decapsulate operation specified by
              the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal slot of <var>decapsulationKey</var> using <var>decapsulationKey</var> and <var>ciphertext</var>.
            </p>
          </li>
          <li>
            <p>
              <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">Queue a global task</a> on the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source">crypto task source</a>,
              given <var>realm</var>'s global object, to perform the remaining steps.
            </p>
          </li>
          <li>
            <p>
              Let <var>result</var> be the result of <a data-link-type="dfn" data-lt="create" href="https://webidl.spec.whatwg.org/#arraybuffer-create">creating</a> an <a data-link-type="interface" data-lt="ArrayBuffer" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a>
              in <var>realm</var>, containing <var>decapsulatedBits</var>.
            </p>
          </li>
          <li>
            <p>
              Resolve <var>promise</var> with
              <var>result</var>.
            </p>
          </li>
        </ol>
      </section>

      <section id="SubtleCrypto-method-getPublicKey"><div class="header-wrapper"><h4 id="x3-2-5-the-getpublickey-method"><bdi class="secno">3.2.5 </bdi>The getPublicKey method</h4><a class="self-link" href="#SubtleCrypto-method-getPublicKey" aria-label="Permalink for Section 3.2.5"></a></div>
        
        <p>
          The <dfn id="dfn-SubtleCrypto-method-getPublicKey" data-dfn-for="SubtleCrypto" data-lt="getPublicKey(key, usages)|getPublicKey()|getPublicKey(key, keyUsages)" data-export="" data-dfn-type="method" data-idl="operation" data-title="getPublicKey(key, usages)" data-type="Promise" data-local-lt="SubtleCrypto.getPublicKey|SubtleCrypto.getPublicKey()|getPublicKey" tabindex="0" aria-haspopup="dialog"><code>getPublicKey(<var>key</var>, <var>usages</var>)</code></dfn>
          method returns the public key corresponding to a given private key.
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              Let <var>key</var> and <var>usages</var> be the <code>key</code> and <code>keyUsages</code> parameters passed to the
              <a data-link-type="idl" data-lt="getPublicKey()" href="#dfn-SubtleCrypto-method-getPublicKey" class="internalDFN" id="ref-for-dfn-SubtleCrypto-method-getPublicKey-3"><code>getPublicKey</code></a><code>()</code> method,
              respectively.
            </p>
          </li>
          <li>
            <p>
              Let <var>algorithm</var> be the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal slot of <var>key</var>.
            </p>
          </li>
          <li>
            <p>
              If the cryptographic algorithm identified by <var>algorithm</var>
              does not support deriving a public key from a private key,
              then return a Promise rejected with a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>realm</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm">relevant realm</a> of <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this">this</a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>promise</var> be a new Promise.
            </p>
          </li>
          <li>
            <p>
              Return <var>promise</var> and perform the remaining steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>.
            </p>
          </li>
          <li>
            <p>
              If the following steps or referenced procedures say to
              <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an error,
              <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">queue a global task</a> on the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source">crypto task source</a>,
              given <var>realm</var>'s global object,
              to reject <var>promise</var> with the returned error;
              and then <a href="https://www.w3.org/TR/webcrypto-2/#terminate-the-algorithm">terminate the algorithm</a>.
            </p>
          </li>
          <li>
            <p>
              If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot of
              <var>key</var> is not "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
            </p>
          </li>
          <li>
            <p>
              If <var>usages</var> contains an entry which is not supported for a public key
              by the algorithm identified by <var>algorithm</var>,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>publicKey</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a> representing the public key corresponding to
              the private key represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
              internal slot of <var>key</var>.
            </p>
          </li>
          <li>
            <p>
              If an error occurred, then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot of
              <var>publicKey</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-public"><code>public</code></a>".
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal
              slot of <var>publicKey</var> to <var>algorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
              slot of <var>publicKey</var> to true.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
              <var>publicKey</var> to <var>usages</var>.
            </p>
          </li>
          <li>
            <p>
              <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">Queue a global task</a> on the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source">crypto task source</a>,
              given <var>realm</var>'s global object, to perform the remaining steps.
            </p>
          </li>
          <li>
            <p>
              Let <var>result</var> be the result of converting <var>publicKey</var> to an ECMAScript Object in <var>realm</var>, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
            </p>
          </li>
          <li>
            <p>
              Resolve <var>promise</var> with
              <var>result</var>.
            </p>
          </li>
        </ol>
      </section>

      <section id="SubtleCrypto-method-supports"><div class="header-wrapper"><h4 id="x3-2-6-the-supports-method"><bdi class="secno">3.2.6 </bdi>The supports method</h4><a class="self-link" href="#SubtleCrypto-method-supports" aria-label="Permalink for Section 3.2.6"></a></div>
        
        <p>
          The <dfn id="dfn-SubtleCrypto-method-supports" data-dfn-for="SubtleCrypto" data-lt="supports(operation, algorithm, length)|supports()|supports(operation, algorithm)" data-export="" data-dfn-type="method" data-idl="operation" data-title="supports(operation, algorithm, length)" data-type="boolean" data-local-lt="SubtleCrypto.supports|SubtleCrypto.supports()|supports" tabindex="0" aria-haspopup="dialog"><code>supports(<var>operation</var>, <var>algorithm</var>, <var>length</var>)</code></dfn>
          method returns a boolean indicating whether the implementation
          supports the given operation using the specified <a data-link-type="typedef" data-lt="AlgorithmIdentifier" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithmidentifier"><code>AlgorithmIdentifier</code></a>,
          with an optional <code>length</code> parameter to indicate the number of bits to be derived when <code>operation</code> is "<code>deriveBits</code>".
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              If <var>operation</var> is not one of
              "<code>encrypt</code>", "<code>decrypt</code>", "<code>sign</code>", "<code>verify</code>",
              "<code>digest</code>", "<code>generateKey</code>", "<code>deriveKey</code>", "<code>deriveBits</code>",
              "<code>importKey</code>", "<code>exportKey</code>", "<code>wrapKey</code>", "<code>unwrapKey</code>",
              "<code>encapsulateKey</code>", "<code>encapsulateBits</code>",
              "<code>decapsulateKey</code>", "<code>decapsulateBits</code>" or "<code>getPublicKey</code>",
              return false.
            </p>
          </li>
          <li>
            <p>
              Return the result of <a data-link-type="dfn|abstract-op" data-lt="check support for an algorithm" href="#dfn-check-support-for-algorithm" class="internalDFN" id="ref-for-dfn-check-support-for-algorithm-1">checking support for an algorithm</a>,
              with <code>op</code> set to <var>operation</var>, <code>alg</code> set to <var>algorithm</var>,
              and <code>length</code> set to <var>length</var>.
            </p>
          </li>
        </ol>
        <p>
          The <dfn id="dfn-SubtleCrypto-method-supports-additionalAlgorithm" data-dfn-for="SubtleCrypto" data-lt="supports(operation, algorithm, additionalAlgorithm)|supports!overload-1()|supports!overload-1(operation, algorithm, additionalAlgorithm)" data-export="" data-dfn-type="method" data-idl="operation" data-title="supports(operation, algorithm, additionalAlgorithm)" data-type="boolean" data-local-lt="SubtleCrypto.supports!overload-1|SubtleCrypto.supports!overload-1()|supports!overload-1" tabindex="0" aria-haspopup="dialog"><code>supports(<var>operation</var>, <var>algorithm</var>, <var>additionalAlgorithm</var>)</code></dfn>
          method returns a boolean indicating whether the implementation
          supports the given operation using the specified <a data-link-type="typedef" data-lt="AlgorithmIdentifier" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithmidentifier"><code>AlgorithmIdentifier</code></a>.
          The additional algorithm indicates the type of key to be derived when <code>operation</code> is "<code>deriveKey</code>",
          the type of key to be exported before wrapping when <code>operation</code> is "<code>wrapKey</code>",
          and the type of key to be imported after unwrapping when <code>operation</code> is "<code>unwrapKey</code>".
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              If <var>operation</var> is not one of
              "<code>encrypt</code>", "<code>decrypt</code>", "<code>sign</code>", "<code>verify</code>",
              "<code>digest</code>", "<code>generateKey</code>", "<code>deriveKey</code>", "<code>deriveBits</code>",
              "<code>importKey</code>", "<code>exportKey</code>", "<code>wrapKey</code>", "<code>unwrapKey</code>",
              "<code>encapsulateKey</code>", "<code>encapsulateBits</code>",
              "<code>decapsulateKey</code>", "<code>decapsulateBits</code>" or "<code>getPublicKey</code>",
              return false.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If <var>operation</var> is "<code>deriveKey</code>", "<code>unwrapKey</code>", "<code>encapsulateKey</code>" or "<code>decapsulateKey</code>":</dt>
              <dd>
                <p>
                  If the result of <a data-link-type="dfn|abstract-op" data-lt="check support for an algorithm" href="#dfn-check-support-for-algorithm" class="internalDFN" id="ref-for-dfn-check-support-for-algorithm-2">checking support for an algorithm</a>
                  with <code>op</code> set to "<code>importKey</code>"
                  and <code>alg</code> set to <var>additionalAlgorithm</var>
                  is false,
                  return false.
                </p>
              </dd>
              <dt>If <var>operation</var> is "<code>wrapKey</code>":</dt>
              <dd>
                <p>
                  If the result of <a data-link-type="dfn|abstract-op" data-lt="check support for an algorithm" href="#dfn-check-support-for-algorithm" class="internalDFN" id="ref-for-dfn-check-support-for-algorithm-3">checking support for an algorithm</a>
                  with <code>op</code> set to "<code>exportKey</code>"
                  and <code>alg</code> set to <var>additionalAlgorithm</var>
                  is false,
                  return false.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Let <var>length</var> be null.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If <var>operation</var> is "<code>deriveKey</code>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the result of <a data-link-type="dfn|abstract-op" data-lt="check support for an algorithm" href="#dfn-check-support-for-algorithm" class="internalDFN" id="ref-for-dfn-check-support-for-algorithm-4">checking support for an algorithm</a>
                      with <code>op</code> set to "<code>get key length</code>"
                      and <code>alg</code> set to <var>additionalAlgorithm</var>
                      is false,
                      return false.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>normalizedAdditionalAlgorithm</var> be the result of
                      <a href="https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
                      <code>alg</code> set to <var>additionalAlgorithm</var> and <code>op</code> set to
                      "<code>get key length</code>".
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>length</var> be the result of performing the get key length
                      algorithm specified by <var>additionalAlgorithm</var> using
                      <var>normalizedAdditionalAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set <var>operation</var> to "<code>deriveBits</code>".
                    </p>
                  </li>
                </ol>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return the result of <a data-link-type="dfn|abstract-op" data-lt="check support for an algorithm" href="#dfn-check-support-for-algorithm" class="internalDFN" id="ref-for-dfn-check-support-for-algorithm-5">checking support for an algorithm</a>,
              with <code>op</code> set to <var>operation</var>, <code>alg</code> set to <var>algorithm</var>,
              and <code>length</code> set to <var>length</var>.
            </p>
          </li>
        </ol>
      </section>
    </section>

    <section id="partial-subtlecrypto-interface-checking-support-for-algorithm"><div class="header-wrapper"><h3 id="x3-3-checking-support-for-an-algorithm"><bdi class="secno">3.3 </bdi>Checking support for an algorithm</h3><a class="self-link" href="#partial-subtlecrypto-interface-checking-support-for-algorithm" aria-label="Permalink for Section 3.3"></a></div>
      
      <p>
        The <dfn id="dfn-check-support-for-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">check support for an algorithm</dfn> algorithm
        defines a process for checking whether the given algorithm is supported for the given operation.
        Its input is an operation name <var>op</var>, an <a data-link-type="typedef" data-lt="AlgorithmIdentifier" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithmidentifier"><code>AlgorithmIdentifier</code></a> <var>alg</var>,
        and a <var>length</var> parameter. Its output is a boolean.
        It behaves as follows:
      </p>
      <ol>
        <li>
          <p>
            If <var>op</var> is "<code>encapsulateKey</code>" or "<code>encapsulateBits</code>", set <var>op</var> to "<code>encapsulate</code>".
          </p>
        </li>
        <li>
          <p>
            If <var>op</var> is "<code>decapsulateKey</code>" or "<code>decapsulateBits</code>", set <var>op</var> to "<code>decapsulate</code>".
          </p>
        </li>
        <li>
          <dl class="switch">
            <dt>If <var>op</var> is "<code>getPublicKey</code>":</dt>
            <dd>
              <ol>
                <li>
                  <p>
                    Let <var>normalizedAlgorithm</var> be the result of
                    <a href="https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
                    <code>alg</code> set to <var>alg</var> and <code>op</code> set to "<code>exportKey</code>".
                  </p>
                </li>
                <li>
                  <p>
                    If an error occurred, return false.
                  </p>
                </li>
                <li>
                  <p>
                    If the cryptographic algorithm identified by <var>normalizedAlgorithm</var>
                    does not support deriving a public key from a private key,
                    then return false.
                  </p>
                </li>
                <li>
                  <p>
                    Otherwise, return true.
                  </p>
                </li>
              </ol>
            </dd>
          </dl>
        </li>
        <li>
          <p>
            Let <var>normalizedAlgorithm</var> be the result of
            <a href="https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
            <code>alg</code> set to <var>alg</var> and <code>op</code> set to <var>op</var>.
          </p>
        </li>
        <li>
          <dl class="switch">
            <dt>If an error occurred:</dt>
            <dd>
              <ol>
                <li>
                  <p>
                    If <var>op</var> is "<code>wrapKey</code>",
                    return the result of <a data-link-type="dfn|abstract-op" data-lt="check support for an algorithm" href="#dfn-check-support-for-algorithm" class="internalDFN" id="ref-for-dfn-check-support-for-algorithm-6">checking support for an algorithm</a>
                    with <code>op</code> set to "<code>encrypt</code>"
                    and <code>alg</code> set to <var>alg</var>.
                  </p>
                </li>
                <li>
                  <p>
                    If <var>op</var> is "<code>unwrapKey</code>",
                    return the result of <a data-link-type="dfn|abstract-op" data-lt="check support for an algorithm" href="#dfn-check-support-for-algorithm" class="internalDFN" id="ref-for-dfn-check-support-for-algorithm-7">checking support for an algorithm</a>
                    with <code>op</code> set to "<code>decrypt</code>"
                    and <code>alg</code> set to <var>alg</var>.
                  </p>
                </li>
                <li>
                  <p>
                    Otherwise, return false.
                  </p>
                </li>
              </ol>
            </dd>
          </dl>
        </li>
        <li>
          <p>
            If the specified operation or algorithm (or one of its parameter values)
            is expected to fail (for any key and/or data) for an implementation-specific reason
            (e.g. known nonconformance to the specification), return false.
          </p>
        </li>
        <li>
          <p>
            If <var>op</var> is "<code>generateKey</code>" or "<code>importKey</code>", let <var>usages</var> be the empty list.
          </p>
        </li>
        <li>
          <p>
            For each of the steps of the operation specified by <var>op</var>
            of the algorithm specified by <var>normalizedAlgorithm</var>:
          </p>
          <dl class="switch">
            <dt>
              If the step says to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an error:
            </dt>
            <dd>
              Return false.
            </dd>
            <dt>
              If the step says to generate a key:
            </dt>
            <dd>
              Return true.
            </dd>
            <dt>
              If the step relies on an unavailable parameter, such as <code>key</code>, <code>plaintext</code> or <code>ciphertext</code>:
            </dt>
            <dd>
              Return true.
            </dd>
            <dt>
              If the step says to return a value:
            </dt>
            <dd>
              Return true.
            </dd>
            <dt>
              Otherwise:
            </dt>
            <dd>
              Execute the step.
            </dd>
          </dl>
          <div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="4"><span>Note</span></div><p class="">
            The steps in the referenced algorithm may access the <var>normalizedAlgorithm</var>,
            <var>length</var>, and <var>usages</var> variables from this context.
          </p></div>
        </li>
        <li>
          <p>
            <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert">Assert</a>: this step is never reached,
            because one of the steps of the operation will have said
            to return a value or throw an error, causing us to return
            true or false, respectively.
          </p>
        </li>
      </ol>
    </section>
  </section>

  <section id="encapsulation"><div class="header-wrapper"><h2 id="x4-encapsulation-dictionaries"><bdi class="secno">4. </bdi>Encapsulation dictionaries</h2><a class="self-link" href="#encapsulation" aria-label="Permalink for Section 4."></a></div>
    
    <pre class="idl def" id="webidl-549016948"><span class="idlHeader"><a class="self-link" href="#webidl-549016948">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-encapsulatedkey" data-title="EncapsulatedKey">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-EncapsulatedKey" id="ref-for-dfn-EncapsulatedKey-4"><code>EncapsulatedKey</code></a> {<span data-idl="" class="idlMember" id="idl-def-encapsulatedkey-sharedkey" data-title="sharedKey" data-dfn-for="EncapsulatedKey"><span class="idlType">
  <a data-link-type="interface" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey">CryptoKey</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-EncapsulatedKey-sharedKey" id="ref-for-dfn-EncapsulatedKey-sharedKey-2"><code>sharedKey</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-encapsulatedkey-ciphertext" data-title="ciphertext" data-dfn-for="EncapsulatedKey"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer">ArrayBuffer</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-EncapsulatedKey-ciphertext" id="ref-for-dfn-EncapsulatedKey-ciphertext-2"><code>ciphertext</code></a>;</span>
};</span><span data-idl="" class="idlDictionary" id="idl-def-encapsulatedbits" data-title="EncapsulatedBits">

dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-EncapsulatedBits" id="ref-for-dfn-EncapsulatedBits-3"><code>EncapsulatedBits</code></a> {<span data-idl="" class="idlMember" id="idl-def-encapsulatedbits-sharedkey" data-title="sharedKey" data-dfn-for="EncapsulatedBits"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer">ArrayBuffer</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-EncapsulatedBits-sharedKey" id="ref-for-dfn-EncapsulatedBits-sharedKey-2"><code>sharedKey</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-encapsulatedbits-ciphertext" data-title="ciphertext" data-dfn-for="EncapsulatedBits"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer">ArrayBuffer</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-EncapsulatedBits-ciphertext" id="ref-for-dfn-EncapsulatedBits-ciphertext-2"><code>ciphertext</code></a>;</span>
};</span></code></pre>
    <p>
      The <dfn data-idl="dictionary" id="dfn-EncapsulatedKey" data-export="" data-dfn-type="dictionary" data-title="EncapsulatedKey" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>EncapsulatedKey</code></dfn> dictionary represents an
      encapsulated key comprised of a <dfn data-idl="field" data-dfn-for="EncapsulatedKey" id="dfn-EncapsulatedKey-sharedKey" data-export="" data-dfn-type="dict-member" data-title="sharedKey" data-type="CryptoKey" tabindex="0" aria-haspopup="dialog"><code>sharedKey</code></dfn> and a <dfn data-idl="field" data-dfn-for="EncapsulatedKey" id="dfn-EncapsulatedKey-ciphertext" data-export="" data-dfn-type="dict-member" data-title="ciphertext" data-type="ArrayBuffer" tabindex="0" aria-haspopup="dialog"><code>ciphertext</code></dfn>.
    </p>
    <p>
      The <dfn data-idl="dictionary" id="dfn-EncapsulatedBits" data-export="" data-dfn-type="dictionary" data-title="EncapsulatedBits" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>EncapsulatedBits</code></dfn> dictionary represents
      encapsulated key bits comprised of a <dfn data-idl="field" data-dfn-for="EncapsulatedBits" id="dfn-EncapsulatedBits-sharedKey" data-export="" data-dfn-type="dict-member" data-title="sharedKey" data-type="ArrayBuffer" tabindex="0" aria-haspopup="dialog"><code>sharedKey</code></dfn> and a <dfn data-idl="field" data-dfn-for="EncapsulatedBits" id="dfn-EncapsulatedBits-ciphertext" data-export="" data-dfn-type="dict-member" data-title="ciphertext" data-type="ArrayBuffer" tabindex="0" aria-haspopup="dialog"><code>ciphertext</code></dfn>.
    </p>
  </section>

  <section id="JsonWebKey-dictionary"><div class="header-wrapper"><h2 id="x5-jsonwebkey-dictionary"><bdi class="secno">5. </bdi>JsonWebKey dictionary</h2><a class="self-link" href="#JsonWebKey-dictionary" aria-label="Permalink for Section 5."></a></div>
    
    <pre class="idl def" id="webidl-1604149801"><span class="idlHeader"><a class="self-link" href="#webidl-1604149801">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-jsonwebkey" data-title="JsonWebKey">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-JsonWebKey" id="ref-for-dfn-JsonWebKey-1"><code>JsonWebKey</code></a> {<span data-idl="" class="idlMember" id="idl-def-jsonwebkey-kty" data-title="kty" data-dfn-for="JsonWebKey"><span class="idlType"><span class="idlSectionComment">
  // The following fields are defined in Section 3.1 of JSON Web Key
  </span><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <dfn data-export="" data-dfn-type="dict-member" id="dom-jsonwebkey-kty" data-idl="field" data-title="kty" data-dfn-for="JsonWebKey" data-type="DOMString" class="idlName" tabindex="0" aria-haspopup="dialog"><code>kty</code></dfn>;</span><span data-idl="" class="idlMember" id="idl-def-jsonwebkey-use" data-title="use" data-dfn-for="JsonWebKey"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <dfn data-export="" data-dfn-type="dict-member" id="dom-jsonwebkey-use" data-idl="field" data-title="use" data-dfn-for="JsonWebKey" data-type="DOMString" class="idlName" tabindex="0" aria-haspopup="dialog"><code>use</code></dfn>;</span><span data-idl="" class="idlMember" id="idl-def-jsonwebkey-key_ops" data-title="key_ops" data-dfn-for="JsonWebKey"><span class="idlType">
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a>&gt;</span> <dfn data-export="" data-dfn-type="dict-member" id="dom-jsonwebkey-key_ops" data-idl="field" data-title="key_ops" data-dfn-for="JsonWebKey" data-type="sequence" class="idlName" tabindex="0" aria-haspopup="dialog"><code>key_ops</code></dfn>;</span><span data-idl="" class="idlMember" id="idl-def-jsonwebkey-alg" data-title="alg" data-dfn-for="JsonWebKey"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <dfn data-export="" data-dfn-type="dict-member" id="dom-jsonwebkey-alg" data-idl="field" data-title="alg" data-dfn-for="JsonWebKey" data-type="DOMString" class="idlName" tabindex="0" aria-haspopup="dialog"><code>alg</code></dfn>;</span><span data-idl="" class="idlMember" id="idl-def-jsonwebkey-ext" data-title="ext" data-dfn-for="JsonWebKey"><span class="idlType"><span class="idlSectionComment">

  // The following fields are defined in JSON Web Key Parameters Registration
  </span><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a></span> <dfn data-export="" data-dfn-type="dict-member" id="dom-jsonwebkey-ext" data-idl="field" data-title="ext" data-dfn-for="JsonWebKey" data-type="boolean" class="idlName" tabindex="0" aria-haspopup="dialog"><code>ext</code></dfn>;</span><span data-idl="" class="idlMember" id="idl-def-jsonwebkey-pub" data-title="pub" data-dfn-for="JsonWebKey"><span class="idlType"><span class="idlSectionComment">

  // The following fields are defined in draft-ietf-cose-dilithium-07
  </span><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <dfn data-export="" data-dfn-type="dict-member" id="dom-jsonwebkey-pub" data-idl="field" data-title="pub" data-dfn-for="JsonWebKey" data-type="DOMString" class="idlName" tabindex="0" aria-haspopup="dialog"><code>pub</code></dfn>;</span><span data-idl="" class="idlMember" id="idl-def-jsonwebkey-priv" data-title="priv" data-dfn-for="JsonWebKey"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <dfn data-export="" data-dfn-type="dict-member" id="dom-jsonwebkey-priv" data-idl="field" data-title="priv" data-dfn-for="JsonWebKey" data-type="DOMString" class="idlName" tabindex="0" aria-haspopup="dialog"><code>priv</code></dfn>;</span>
};</span></code></pre>
    <p>
      This version of the <dfn data-idl="dictionary" id="dfn-JsonWebKey" data-export="" data-dfn-type="dictionary" data-title="JsonWebKey" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>JsonWebKey</code></dfn> dictionary
      provides a way to represent keys with the "AKP" key type defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-draft-ietf-cose-dilithium-07" title="ML-DSA for JOSE and COSE">draft-ietf-cose-dilithium-07</a></cite>].
      It may be merged into the definition of <a href="https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey"><code>JsonWebKey</code></a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-webcrypto" title="Web Cryptography Level 2">webcrypto</a></cite>]
      by adding the <a data-link-type="idl" href="#dom-jsonwebkey-pub" class="internalDFN" id="ref-for-dom-jsonwebkey-pub-1"><code>pub</code></a> and <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-1"><code>priv</code></a> fields there.
    </p>
  </section>

  <section id="ml-kem"><div class="header-wrapper"><h2 id="x6-ml-kem"><bdi class="secno">6. </bdi>ML-KEM</h2><a class="self-link" href="#ml-kem" aria-label="Permalink for Section 6."></a></div>
    
    <section id="ml-kem-description" class="informative"><div class="header-wrapper"><h3 id="x6-1-description"><bdi class="secno">6.1 </bdi>Description</h3><a class="self-link" href="#ml-kem-description" aria-label="Permalink for Section 6.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        This describes using ML-KEM for key encapsulation and decapsulation,
        as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-203" title="Module-Lattice-Based Key-Encapsulation Mechanism Standard">FIPS-203</a></cite>].
      </p>
    </section>
    <section id="ml-kem-registration"><div class="header-wrapper"><h3 id="x6-2-registration"><bdi class="secno">6.2 </bdi>Registration</h3><a class="self-link" href="#ml-kem-registration" aria-label="Permalink for Section 6.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/webcrypto-2/#recognized-algorithm-name">recognized algorithm names</a> for
        this algorithm are "<code>ML-KEM-512</code>", "<code>ML-KEM-768</code>" and "<code>ML-KEM-1024</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>encapsulate</td>
            <td>None</td>
            <td><a data-link-type="idl" data-lt="EncapsulatedBits" href="#dfn-EncapsulatedBits" class="internalDFN" id="ref-for-dfn-EncapsulatedBits-4"><code>EncapsulatedBits</code></a></td>
          </tr>
          <tr>
            <td>decapsulate</td>
            <td>None</td>
            <td><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a></td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td><a data-link-type="dictionary" data-lt="CryptoKeyPair" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair"><code>CryptoKeyPair</code></a></td>
          </tr>
         <tr>
           <td>importKey</td>
           <td>None</td>
           <td><a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
         </tr>
         <tr>
           <td>exportKey</td>
           <td>None</td>
           <td>object</td>
         </tr>
        </tbody>
      </table>
    </section>
    <section id="ml-kem-operations"><div class="header-wrapper"><h3 id="x6-3-operations"><bdi class="secno">6.3 </bdi>Operations</h3><a class="self-link" href="#ml-kem-operations" aria-label="Permalink for Section 6.3"></a></div>
      
      <section id="ml-kem-operations-encapsulate"><div class="header-wrapper"><h4 id="x6-3-1-encapsulate"><bdi class="secno">6.3.1 </bdi>Encapsulate</h4><a class="self-link" href="#ml-kem-operations-encapsulate" aria-label="Permalink for Section 6.3.1"></a></div>
        
        <ol>
          <li>
            <p>
              If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot of
              <var>key</var> is not "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-public"><code>public</code></a>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Perform the encapsulation key check described in
              Section 7.2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-203" title="Module-Lattice-Based Key-Encapsulation Mechanism Standard">FIPS-203</a></cite>] with the parameter set
              indicated by the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>algorithm</var>,
              using the key represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
              internal slot of <var>key</var> as the <var class="overline">ek</var> input parameter.
            </p>
            <div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="5"><span>Note</span></div><div class="">
              <p>
                The result of this check may be cached or precomputed
                for the <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a> object if desirable for performance.
              </p>
            </div></div>
          </li>
          <li>
            <p>
              If the encapsulation key check failed, return an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>sharedKey</var> and <var>ciphertext</var> be the outputs that result
              from performing the ML-KEM.Encaps function described in
              Section 7.2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-203" title="Module-Lattice-Based Key-Encapsulation Mechanism Standard">FIPS-203</a></cite>] with the parameter set
              indicated by the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>algorithm</var>,
              using the key represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
              internal slot of <var>key</var> as the <var>ek</var> input parameter.
            </p>
          </li>
          <li>
            <p>
              If the ML-KEM.Encaps function returned an error, return an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>result</var> be a new <a data-link-type="idl" data-lt="EncapsulatedBits" href="#dfn-EncapsulatedBits" class="internalDFN" id="ref-for-dfn-EncapsulatedBits-5"><code>EncapsulatedBits</code></a>
              dictionary.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="idl" href="#dfn-EncapsulatedBits-sharedKey" class="internalDFN" id="ref-for-dfn-EncapsulatedBits-sharedKey-3"><code>sharedKey</code></a> attribute
              of <var>result</var> to the result of <a data-link-type="dfn" data-lt="create" href="https://webidl.spec.whatwg.org/#arraybuffer-create">creating</a>
              an <a data-link-type="interface" data-lt="ArrayBuffer" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> containing <var>sharedKey</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="idl" href="#dfn-EncapsulatedBits-ciphertext" class="internalDFN" id="ref-for-dfn-EncapsulatedBits-ciphertext-3"><code>ciphertext</code></a> attribute
              of <var>result</var> to the result of <a data-link-type="dfn" data-lt="create" href="https://webidl.spec.whatwg.org/#arraybuffer-create">creating</a>
              an <a data-link-type="interface" data-lt="ArrayBuffer" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> containing <var>ciphertext</var>.
            </p>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-kem-operations-decapsulate"><div class="header-wrapper"><h4 id="x6-3-2-decapsulate"><bdi class="secno">6.3.2 </bdi>Decapsulate</h4><a class="self-link" href="#ml-kem-operations-decapsulate" aria-label="Permalink for Section 6.3.2"></a></div>
        
        <ol>
          <li>
            <p>
              If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot of
              <var>key</var> is not "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Perform the decapsulation input check described in
              Section 7.3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-203" title="Module-Lattice-Based Key-Encapsulation Mechanism Standard">FIPS-203</a></cite>] with the parameter set
              indicated by the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>algorithm</var>,
              using the key represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
              internal slot of <var>key</var> as the <var class="overline">dk</var> input parameter, and
              <var>ciphertext</var> as the <var class="overline">c</var> input parameter.
            </p>
            <div class="note" role="note" id="issue-container-generatedID-1"><div role="heading" class="note-title marker" id="h-note-1" aria-level="5"><span>Note</span></div><div class="">
              <p>
                The result of the decapsulation key type check and the hash check
                may be cached or precomputed for the <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a> object
                if desirable for performance.
              </p>
            </div></div>
          </li>
          <li>
            <p>
              If the decapsulation key check failed, return an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>sharedKey</var> be the output that results
              from performing the ML-KEM.Decaps function described in
              Section 7.3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-203" title="Module-Lattice-Based Key-Encapsulation Mechanism Standard">FIPS-203</a></cite>] with the parameter set
              indicated by the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>algorithm</var>,
              using the key represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
              internal slot of <var>key</var> as the <var>dk</var> input parameter, and
              <var>ciphertext</var> as the <var>c</var> input parameter.
            </p>
          </li>
          <li>
            <p>
              Return <var>sharedKey</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-kem-operations-generate-key"><div class="header-wrapper"><h4 id="x6-3-3-generate-key"><bdi class="secno">6.3.3 </bdi>Generate Key</h4><a class="self-link" href="#ml-kem-operations-generate-key" aria-label="Permalink for Section 6.3.3"></a></div>
        
        <ol>
          <li>
            <p>
              If <var>usages</var> contains any entry which is not
              one of "<code>encapsulateKey</code>", "<code>encapsulateBits</code>",
              "<code>decapsulateKey</code>" or "<code>decapsulateBits</code>",
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
              <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
            </p>
          </li>

          <li>
            <p>
              Generate an ML-KEM key pair, as described in
              Section 7.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-203" title="Module-Lattice-Based Key-Encapsulation Mechanism Standard">FIPS-203</a></cite>], with the parameter set
              indicated by the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>.
            </p>
            <div class="note" role="note" id="issue-container-generatedID-2"><div role="heading" class="note-title marker" id="h-note-2" aria-level="5"><span>Note</span></div><div class="">
              <p>
                In order to be able to export the seed <code>(d, z)</code>,
                <code>d</code> and <code>z</code> need to be stored as part of the generated
                key material.
              </p>
            </div></div>
          </li>
          <li>
            <p>
              If the key generation step fails,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
              <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> attribute of
              <var>normalizedAlgorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>publicKey</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
              representing the encapsulation key of the generated key pair.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot of
              <var>publicKey</var> to "<code>public</code>".
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal
              slot of <var>publicKey</var> to <var>algorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
              slot of <var>publicKey</var> to true.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
              <var>publicKey</var> to be the
              <a href="https://www.w3.org/TR/webcrypto-2/#concept-usage-intersection">usage intersection</a> of
              <var>usages</var> and <code>[ "encapsulateKey", "encapsulateBits" ]</code>.
            </p>
          </li>
          <li>
            <p>
              Let <var>privateKey</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
              representing the decapsulation key of the generated key pair.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot of
              <var>privateKey</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>".
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal
              slot of <var>privateKey</var> to <var>algorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
              slot of <var>privateKey</var> to <var>extractable</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
              <var>privateKey</var> to be the
              <a href="https://www.w3.org/TR/webcrypto-2/#concept-usage-intersection">usage intersection</a> of
              <var>usages</var> and <code>[ "decapsulateKey", "decapsulateBits" ]</code>.
            </p>
          </li>
          <li>
            <p>
              Let <var>result</var> be a new <a data-link-type="dictionary" data-lt="CryptoKeyPair" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair"><code>CryptoKeyPair</code></a>
              dictionary.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-publicKey"><code>publicKey</code></a> attribute
              of <var>result</var> to be <var>publicKey</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-privateKey"><code>privateKey</code></a> attribute
              of <var>result</var> to be <var>privateKey</var>.
            </p>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-kem-operations-import-key"><div class="header-wrapper"><h4 id="x6-3-4-import-key"><bdi class="secno">6.3.4 </bdi>Import Key</h4><a class="self-link" href="#ml-kem-operations-import-key" aria-label="Permalink for Section 6.3.4"></a></div>
        
        <ol>
          <li>
            <p>Let <var>keyData</var> be the key data to be imported.</p>
          </li>
          <li>
            <dl class="switch">
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-spki" class="internalDFN" id="ref-for-dom-keyformat-spki-1"><code>spki</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    </li><li>
                      <p>
                        If <var>usages</var> contains an entry which is not
                        "<code>encapsulateKey</code>" or "<code>encapsulateBits</code>"
                        then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                  <li>
                    <p>
                      Let <var>spki</var> be the result of running the
                      <a href="https://www.w3.org/TR/webcrypto-2/#concept-parse-a-spki">parse a subjectPublicKeyInfo</a>
                      algorithm over <var>keyData</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If an error occurred while parsing,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-KEM-512</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-512</code> (2.16.840.1.101.3.4.4.1).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-KEM-768</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-768</code> (2.16.840.1.101.3.4.4.2).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-KEM-1024</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-1024</code> (2.16.840.1.101.3.4.4.3).
                        </p>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <p>
                          <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                        </p>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the <code>algorithm</code> object identifier field of the
                      <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is
                      not equal to <var>expectedOid</var>,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <code>parameters</code> field of the <code>algorithm</code>
                      AlgorithmIdentifier field of <var>spki</var> is present,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>publicKey</var> be the ML-KEM public key identified by
                      the <code>subjectPublicKey</code> field of <var>spki</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
                      that represents <var>publicKey</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> to "<code>public</code>"
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                      <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> attribute of
                      <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a>
                      internal slot of <var>key</var> to <var>algorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
                      slot of <var>key</var> to <var>extractable</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
                      <var>key</var> to <var>usages</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-pkcs8" class="internalDFN" id="ref-for-dom-keyformat-pkcs8-1"><code>pkcs8</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    </li><li>
                      <p>
                        If <var>usages</var> contains an entry which is not
                        "<code>encapsulateKey</code>" or "<code>encapsulateBits</code>"
                        then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                      </p>
                    </li>
                  <li>
                    <p>
                      Let <var>privateKeyInfo</var> be the result of running the
                      <a href="https://www.w3.org/TR/webcrypto-2/#concept-parse-a-privateKeyInfo">parse a privateKeyInfo</a>
                      algorithm over <var>keyData</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If an error occurs while parsing,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-KEM-512</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-512</code> (2.16.840.1.101.3.4.4.1).
                        </p>
                        <p>
                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-KEM-512-PrivateKey</code> structure.
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-KEM-768</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-768</code> (2.16.840.1.101.3.4.4.2).
                        </p>
                        <p>
                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-KEM-768-PrivateKey</code> structure.
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-KEM-1024</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-1024</code> (2.16.840.1.101.3.4.4.3).
                        </p>
                        <p>
                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-KEM-1024-PrivateKey</code> structure.
                        </p>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <p>
                          <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                        </p>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the <code>algorithm</code> object identifier field of the
                      <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of
                      <var>privateKeyInfo</var> is not equal to <var>expectedOid</var>,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <code>parameters</code> field of the
                      <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field
                      of <var>privateKeyInfo</var> is present,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>mlKemPrivateKey</var> be the result of performing the
                      <a href="https://www.w3.org/TR/webcrypto-2/#concept-parse-an-asn1-structure">parse an ASN.1 structure</a>
                      algorithm, with <var>data</var> as the <code>privateKey</code> field
                      of <var>privateKeyInfo</var>, <var>structure</var> as <var>asn1Structure</var>, and <var>exactData</var> set to true.
                    </p>
                  </li>
                  <li>
                    <p>
                      If an error occurred while parsing,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
                      that represents the ML-KEM private key identified by <var>mlKemPrivateKey</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>"
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                      <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> attribute of
                      <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a>
                      internal slot of <var>key</var> to <var>algorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
                      slot of <var>key</var> to <var>extractable</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
                      <var>key</var> to <var>usages</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-public" class="internalDFN" id="ref-for-dom-keyformat-raw-public-3"><code>raw-public</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If <var>usages</var> contains an entry which is not
                      "<code>encapsulateKey</code>" or "<code>encapsulateBits</code>"
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be <var>keyData</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
                      that represents the ML-KEM public key data in <var>data</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-public"><code>public</code></a>"
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                      <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> attribute of
                      <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a>
                      internal slot of <var>key</var> to <var>algorithm</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-seed" class="internalDFN" id="ref-for-dom-keyformat-raw-seed-2"><code>raw-seed</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If <var>usages</var> contains an entry which is not
                      "<code>decapsulateKey</code>" or "<code>decapsulateBits</code>"
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be <var>keyData</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the length in bits of <var>data</var> is not 512
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>privateKey</var> be the result of performing the
                      ML-KEM.KeyGen_internal function described in
                      Section 6.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-203" title="Module-Lattice-Based Key-Encapsulation Mechanism Standard">FIPS-203</a></cite>] with the parameter set
                      indicated by the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>,
                      using the first 256 bits of <var>data</var> as <var>d</var> and
                      the last 256 bits of <var>data</var> as <var>z</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
                      that represents the ML-KEM private key identified by <var>privateKey</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>"
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                      <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> attribute of
                      <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a>
                      internal slot of <var>key</var> to <var>algorithm</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-jwk" class="internalDFN" id="ref-for-dom-keyformat-jwk-1"><code>jwk</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <dl class="switch">
                      <dt>If <var>keyData</var> is a <a data-link-type="idl" data-lt="JsonWebKey" href="#dfn-JsonWebKey" class="internalDFN" id="ref-for-dfn-JsonWebKey-2"><code>JsonWebKey</code></a> dictionary:</dt>
                      <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>
                      <dt>Otherwise:</dt>
                      <dd><p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">Throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</p></dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-2"><code>priv</code></a> field of <var>jwk</var> is present
                      and if <var>usages</var> contains an entry which is not
                      "<code>decapsulateKey</code>" or "<code>decapsulateBits</code>"
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-3"><code>priv</code></a> field of <var>jwk</var> is not present
                      and if <var>usages</var> contains an entry which is not
                      "<code>encapsulateKey</code>" or "<code>encapsulateBits</code>"
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-kty" class="internalDFN" id="ref-for-dom-jsonwebkey-kty-1"><code>kty</code></a> field of <var>jwk</var> is not
                      "<code>AKP</code>",
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-alg" class="internalDFN" id="ref-for-dom-jsonwebkey-alg-1"><code>alg</code></a> field of <var>jwk</var> is not
                      one of the <code>alg</code> values corresponding to the
                      <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>
                      indicated in Section 8 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-draft-ietf-jose-pqc-kem-01" title="Post-Quantum Key Encapsulation Mechanisms (PQ KEMs) for JOSE and COSE">draft-ietf-jose-pqc-kem-01</a></cite>]
                      (Figure 1 or 2), then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                    <p class="example">
                      For example, <code>MLKEM512</code> and <code>MLKEM512+A128KW</code>
                      are valid "alg" values for ML-KEM-512.
                    </p>
                  </li>
                  <li>
                    <p>
                      If <var>usages</var> is non-empty and the <a data-link-type="idl" href="#dom-jsonwebkey-use" class="internalDFN" id="ref-for-dom-jsonwebkey-use-1"><code>use</code></a> field of <var>jwk</var> is present
                      and is not equal to "<code>enc</code>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-key_ops" class="internalDFN" id="ref-for-dom-jsonwebkey-key_ops-1"><code>key_ops</code></a> field of <var>jwk</var> is present, and
                      is invalid according to the requirements of JSON Web
                      Key [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwk" title="JSON Web Key (JWK)">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>
                      values,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-ext" class="internalDFN" id="ref-for-dom-jsonwebkey-ext-1"><code>ext</code></a> field of <var>jwk</var> is present and
                      has the value false and <var>extractable</var> is true,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-4"><code>priv</code></a> field of <var>jwk</var> is present:</dt>
                      <dd>
                        <ol>
                          <li>
                            <p>
                              If the <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-5"><code>priv</code></a> attribute of <var>jwk</var>
                              does not contain a valid base64url encoded seed
                              representing an ML-KEM private key,
                              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                            </p>
                          </li>
                          <li>
                            <p>
                              Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a> object that represents the
                              ML-KEM private key identified by interpreting the
                              <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-6"><code>priv</code></a> attribute of <var>jwk</var>
                              as a base64url encoded seed.
                            </p>
                          </li>
                          <li>
                            <p>
                              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a>
                              internal slot of <var>Key</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>".
                            </p>
                          </li>
                          <li>
                            <p>
                              If the <a data-link-type="idl" href="#dom-jsonwebkey-pub" class="internalDFN" id="ref-for-dom-jsonwebkey-pub-2"><code>pub</code></a> attribute of <var>jwk</var>
                              does not contain the base64url encoded public key
                              representing the ML-KEM public key
                              corresponding to <var>key</var>,
                              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                            </p>
                          </li>
                        </ol>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <ol>
                          <li>
                            <p>
                              If the <a data-link-type="idl" href="#dom-jsonwebkey-pub" class="internalDFN" id="ref-for-dom-jsonwebkey-pub-3"><code>pub</code></a> attribute of <var>jwk</var>
                              does not contain a valid base64url encoded public key
                              representing an ML-KEM public key,
                              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                            </p>
                          </li>
                          <li>
                            <p>
                              Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a> object that represents the
                              ML-KEM public key identified by interpreting the
                              <a data-link-type="idl" href="#dom-jsonwebkey-pub" class="internalDFN" id="ref-for-dom-jsonwebkey-pub-4"><code>pub</code></a> attribute of <var>jwk</var>
                              as a base64url encoded public key.
                            </p>
                          </li>
                          <li>
                            <p>
                              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a>
                              internal slot of <var>Key</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-public"><code>public</code></a>".
                            </p>
                          </li>
                        </ol>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be a new instance of a <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                      <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a>
                      internal slot of <var>key</var> to <var>algorithm</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return <var>key</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-kem-operations-export-key"><div class="header-wrapper"><h4 id="x6-3-5-export-key"><bdi class="secno">6.3.5 </bdi>Export Key</h4><a class="self-link" href="#ml-kem-operations-export-key" aria-label="Permalink for Section 6.3.5"></a></div>
        
        <ol>
          <li>
            <p>
              If the underlying cryptographic key material represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of <var>key</var>
              cannot be accessed, then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-spki" class="internalDFN" id="ref-for-dom-keyformat-spki-2"><code>spki</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> is not "<code>public</code>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be an instance of the <code>SubjectPublicKeyInfo</code>
                      ASN.1 structure defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5280" title="Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile">RFC5280</a></cite>]
                      with the following properties:
                    </p>
                    <ul>
                      <li>
                        <p>
                          Set the <var>algorithm</var> field to an
                          <code>AlgorithmIdentifier</code> ASN.1 type with the following
                          properties:
                        </p>
                        <ul>
                          <li>
                            <dl class="switch">
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-KEM-512</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-512</code> (2.16.840.1.101.3.4.4.1) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-KEM-768</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-768</code> (2.16.840.1.101.3.4.4.2) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-KEM-1024</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-1024</code> (2.16.840.1.101.3.4.4.3) OID.
                                </p>
                              </dd>
                              <dt>Otherwise:</dt>
                              <dd>
                                <p>
                                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                                </p>
                              </dd>
                            </dl>
                          </li>
                        </ul>
                      </li>
                      <li>
                        <p>
                          Set the <var>subjectPublicKey</var> field to <var>keyData</var>.
                        </p>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be the result of DER-encoding <var>data</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-pkcs8" class="internalDFN" id="ref-for-dom-keyformat-pkcs8-2"><code>pkcs8</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> is not "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be an instance of the <code>PrivateKeyInfo</code>
                      ASN.1 structure defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5208" title="Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2">RFC5208</a></cite>]
                      with the following properties:
                    </p>
                    <ul>
                      <li>
                        <p>
                          Set the <var>version</var> field to <code>0</code>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Set the <var>privateKeyAlgorithm</var> field to a
                          <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the
                          following properties:
                        </p>
                        <ul>
                          <li>
                            <dl class="switch">
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-KEM-512</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-512</code> (2.16.840.1.101.3.4.4.1) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-KEM-768</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-768</code> (2.16.840.1.101.3.4.4.2) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-KEM-1024</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-1024</code> (2.16.840.1.101.3.4.4.3) OID.
                                </p>
                              </dd>
                              <dt>Otherwise:</dt>
                              <dd>
                                <p>
                                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                                </p>
                              </dd>
                            </dl>
                          </li>
                        </ul>
                      </li>
                      <li>
                        <p>
                          Set the <var>privateKey</var> field as follows:
                        </p>
                        <ul>
                          <li>
                            <dl class="switch">
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-KEM-512</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>privateKey</var> field to the result of DER-encoding
                                  a <code>ML-KEM-512-PrivateKey</code> ASN.1 type that represents the ML-KEM
                                  private key seed represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag
                                  with an implicit encoding of OCTET STRING).
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-KEM-768</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>privateKey</var> field to the result of DER-encoding
                                  a <code>ML-KEM-768-PrivateKey</code> ASN.1 type that represents the ML-KEM
                                  private key seed represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag
                                  with an implicit encoding of OCTET STRING).
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-KEM-1024</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>privateKey</var> field to the result of DER-encoding
                                  a <code>ML-KEM-1024-PrivateKey</code> ASN.1 type that represents the ML-KEM
                                  private key seed represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag
                                  with an implicit encoding of OCTET STRING).
                                </p>
                              </dd>
                              <dt>Otherwise:</dt>
                              <dd>
                                <p>
                                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                                </p>
                              </dd>
                            </dl>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be the result of DER-encoding <var>data</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-public" class="internalDFN" id="ref-for-dom-keyformat-raw-public-4"><code>raw-public</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> is not "<code>public</code>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a> containing
                      the raw octets of the key represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of
                      <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be <var>data</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-seed" class="internalDFN" id="ref-for-dom-keyformat-raw-seed-3"><code>raw-seed</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> is not "<code>private</code>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a> containing the concatenation of the <var>d</var> and <var>z</var>
                      seed variables of the key represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                      internal slot of <var>key</var>.
                    </p>
                    <div class="note" role="note" id="issue-container-generatedID-3"><div role="heading" class="note-title marker" id="h-note-3" aria-level="5"><span>Note</span></div><div class="">
                      <p>
                        The <var>d</var> and <var>z</var> seed variables were sampled in the ML-KEM.KeyGen function
                        as described in Section 7.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-203" title="Module-Lattice-Based Key-Encapsulation Mechanism Standard">FIPS-203</a></cite>].
                      </p>
                    </div></div>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be <var>data</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-jwk" class="internalDFN" id="ref-for-dom-keyformat-jwk-2"><code>jwk</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let <var>jwk</var> be a new <a data-link-type="idl" data-lt="JsonWebKey" href="#dfn-JsonWebKey" class="internalDFN" id="ref-for-dfn-JsonWebKey-3"><code>JsonWebKey</code></a>
                      dictionary.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>kty</code> attribute of <var>jwk</var> to
                      "<code>AKP</code>".
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>alg</code> attribute of <var>jwk</var> to
                      the <code>alg</code> value corresponding to the
                      <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>
                      indicated in Section 8 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-draft-ietf-jose-pqc-kem-01" title="Post-Quantum Key Encapsulation Mechanisms (PQ KEMs) for JOSE and COSE">draft-ietf-jose-pqc-kem-01</a></cite>]
                      (Figure 1).
                    </p>
                    <p class="example">
                      For example, <code>MLKEM512</code> is the "alg" value
                      used for ML-KEM-512.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="idl" href="#dom-jsonwebkey-pub" class="internalDFN" id="ref-for-dom-jsonwebkey-pub-5"><code>pub</code></a> attribute of <var>jwk</var>
                      to the base64url encoded public key corresponding
                      to the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                      internal slot of <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>
                        If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                        of <var>key</var> is "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>":
                      </dt>
                      <dd>
                        Set the <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-7"><code>priv</code></a> attribute of <var>jwk</var>
                        to the base64url encoded seed represented by
                        the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                        internal slot of <var>key</var>.
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type="attribute" href="https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages"><code>usages</code></a> attribute of <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>ext</code> attribute of <var>jwk</var> to the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal slot
                      of <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be <var>jwk</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                  <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>

  <section id="ml-dsa"><div class="header-wrapper"><h2 id="x7-ml-dsa"><bdi class="secno">7. </bdi>ML-DSA</h2><a class="self-link" href="#ml-dsa" aria-label="Permalink for Section 7."></a></div>
    
    <section id="ml-dsa-description" class="informative"><div class="header-wrapper"><h3 id="x7-1-description"><bdi class="secno">7.1 </bdi>Description</h3><a class="self-link" href="#ml-dsa-description" aria-label="Permalink for Section 7.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        This describes using ML-DSA for signing and verification,
        as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-204" title="Module-Lattice-Based Digital Signature Standard">FIPS-204</a></cite>].
      </p>
    </section>
    <section id="ml-dsa-registration"><div class="header-wrapper"><h3 id="x7-2-registration"><bdi class="secno">7.2 </bdi>Registration</h3><a class="self-link" href="#ml-dsa-registration" aria-label="Permalink for Section 7.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/webcrypto-2/#recognized-algorithm-name">recognized algorithm names</a> for
        this algorithm are "<code>ML-DSA-44</code>", "<code>ML-DSA-65</code>" and "<code>ML-DSA-87</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>sign</td>
            <td><a data-link-type="idl" data-lt="ContextParams" href="#dfn-ContextParams" class="internalDFN" id="ref-for-dfn-ContextParams-1"><code>ContextParams</code></a></td>
            <td><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a></td>
          </tr>
          <tr>
            <td>verify</td>
            <td><a data-link-type="idl" data-lt="ContextParams" href="#dfn-ContextParams" class="internalDFN" id="ref-for-dfn-ContextParams-2"><code>ContextParams</code></a></td>
            <td>boolean</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td><a data-link-type="dictionary" data-lt="CryptoKeyPair" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair"><code>CryptoKeyPair</code></a></td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td><a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="context-params"><div class="header-wrapper"><h3 id="x7-3-contextparams-dictionary"><bdi class="secno">7.3 </bdi><dfn data-idl="dictionary" id="dfn-ContextParams" data-export="" data-dfn-type="dictionary" data-title="ContextParams" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>ContextParams</code></dfn> dictionary</h3><a class="self-link" href="#context-params" aria-label="Permalink for Section 7.3"></a></div>
      
      <pre class="idl def" id="webidl-1839088126"><span class="idlHeader"><a class="self-link" href="#webidl-1839088126">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-contextparams" data-title="ContextParams">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-ContextParams" id="ref-for-dfn-ContextParams-3"><code>ContextParams</code></a> : <span class="idlSuperclass"><a data-link-type="dictionary" href="https://www.w3.org/TR/webcrypto-2/#dfn-Algorithm">Algorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-contextparams-context" data-title="context" data-dfn-for="ContextParams"><span class="idlType">
  <a data-link-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-ContextParams-context" id="ref-for-dfn-ContextParams-context-1"><code>context</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-idl="field" data-dfn-for="ContextParams" id="dfn-ContextParams-context" data-export="" data-dfn-type="dict-member" data-title="context" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>context</code></dfn> member represents the optional context data to associate with the message.</p>
    </section>
    <section id="ml-dsa-operations"><div class="header-wrapper"><h3 id="x7-4-operations"><bdi class="secno">7.4 </bdi>Operations</h3><a class="self-link" href="#ml-dsa-operations" aria-label="Permalink for Section 7.4"></a></div>
      
      <section id="ml-dsa-operations-sign"><div class="header-wrapper"><h4 id="x7-4-1-sign"><bdi class="secno">7.4.1 </bdi>Sign</h4><a class="self-link" href="#ml-dsa-operations-sign" aria-label="Permalink for Section 7.4.1"></a></div>
        
        <ol>
          <li>
            <p>
              If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot of
              <var>key</var> is not "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>context</var> be the <a data-link-type="idl" href="#dfn-ContextParams-context" class="internalDFN" id="ref-for-dfn-ContextParams-context-2"><code>context</code></a> member of <var>normalizedAlgorithm</var>
              or the empty octet string if the <a data-link-type="idl" href="#dfn-ContextParams-context" class="internalDFN" id="ref-for-dfn-ContextParams-context-3"><code>context</code></a> member of
              <var>normalizedAlgorithm</var> is not present.
            </p>
          </li>
          <li>
            <p>
              Let <var>result</var> be the result of performing the ML-DSA.Sign
              signing algorithm, as specified in Section 5.2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-204" title="Module-Lattice-Based Digital Signature Standard">FIPS-204</a></cite>],
              with the parameter set indicated by the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>,
              using the ML-DSA private key associated with <var>key</var> as <var>sk</var>,
              <var>message</var> as <var>M</var> and <var>context</var> as <var>ctx</var>.
            </p>
          </li>
          <li>
            <p>
              If the ML-DSA.Sign algorithm returned an error, return an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-dsa-operations-verify"><div class="header-wrapper"><h4 id="x7-4-2-verify"><bdi class="secno">7.4.2 </bdi>Verify</h4><a class="self-link" href="#ml-dsa-operations-verify" aria-label="Permalink for Section 7.4.2"></a></div>
        
        <ol>
          <li>
            <p>
              If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot of
              <var>key</var> is not "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-public"><code>public</code></a>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>context</var> be the <a data-link-type="idl" href="#dfn-ContextParams-context" class="internalDFN" id="ref-for-dfn-ContextParams-context-4"><code>context</code></a> member of <var>normalizedAlgorithm</var>
              or the empty octet string if the <a data-link-type="idl" href="#dfn-ContextParams-context" class="internalDFN" id="ref-for-dfn-ContextParams-context-5"><code>context</code></a> member of
              <var>normalizedAlgorithm</var> is not present.
            </p>
          </li>
          <li>
            <p>
              Let <var>result</var> be the result of performing the ML-DSA.Verify
              verification algorithm, as specified in Section 5.3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-204" title="Module-Lattice-Based Digital Signature Standard">FIPS-204</a></cite>],
              with the parameter set indicated by the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>,
              using the ML-DSA public key associated with <var>key</var> as <var>pk</var>,
              <var>message</var> as <var>M</var>, <var>signature</var> as <var>σ</var> and <var>context</var> as <var>ctx</var>.
            </p>
          </li>
          <li>
            <p>
              If the ML-DSA.Verify algorithm returned an error, return an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-dsa-operations-generate-key"><div class="header-wrapper"><h4 id="x7-4-3-generate-key"><bdi class="secno">7.4.3 </bdi>Generate Key</h4><a class="self-link" href="#ml-dsa-operations-generate-key" aria-label="Permalink for Section 7.4.3"></a></div>
        
        <ol>
          <li>
            <p>
              If <var>usages</var> contains a value which is not
              one of "<code>sign</code>" or "<code>verify</code>",
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
              <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Generate an ML-DSA key pair, as described in
              Section 5.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-204" title="Module-Lattice-Based Digital Signature Standard">FIPS-204</a></cite>], with the parameter set
              indicated by the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>.
            </p>
            <div class="note" role="note" id="issue-container-generatedID-4"><div role="heading" class="note-title marker" id="h-note-4" aria-level="5"><span>Note</span></div><div class="">
              <p>
                In order to be able to export the seed <code>ξ</code>,
                it needs to be stored as part of the generated
                key material.
              </p>
            </div></div>
          </li>
          <li>
            <p>
              If the key generation step fails,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
              <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> attribute of
              <var>normalizedAlgorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>publicKey</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
              representing the public key of the generated key pair.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot of
              <var>publicKey</var> to "<code>public</code>".
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal
              slot of <var>publicKey</var> to <var>algorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
              slot of <var>publicKey</var> to true.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
              <var>publicKey</var> to be the <a href="https://www.w3.org/TR/webcrypto-2/#concept-usage-intersection">usage intersection</a>
              of <var>usages</var> and <code>[ "verify" ]</code>.
            </p>
          </li>
          <li>
            <p>
              Let <var>privateKey</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
              representing the private key of the generated key pair.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot of
              <var>privateKey</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>".
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal
              slot of <var>privateKey</var> to <var>algorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
              slot of <var>privateKey</var> to <var>extractable</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
              <var>privateKey</var> to be the <a href="https://www.w3.org/TR/webcrypto-2/#concept-usage-intersection">usage intersection</a>
              of <var>usages</var> and <code>[ "sign" ]</code>.
            </p>
          </li>
          <li>
            <p>
              Let <var>result</var> be a new <a data-link-type="dictionary" data-lt="CryptoKeyPair" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair"><code>CryptoKeyPair</code></a>
              dictionary.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-publicKey"><code>publicKey</code></a> attribute
              of <var>result</var> to be <var>publicKey</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-privateKey"><code>privateKey</code></a> attribute
              of <var>result</var> to be <var>privateKey</var>.
            </p>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-dsa-operations-import-key"><div class="header-wrapper"><h4 id="x7-4-4-import-key"><bdi class="secno">7.4.4 </bdi>Import Key</h4><a class="self-link" href="#ml-dsa-operations-import-key" aria-label="Permalink for Section 7.4.4"></a></div>
        
        <ol>
          <li>
            <p>Let <var>keyData</var> be the key data to be imported.</p>
          </li>
          <li>
            <dl class="switch">
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-spki" class="internalDFN" id="ref-for-dom-keyformat-spki-3"><code>spki</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If <var>usages</var> contains a value which is not
                      "<code>verify</code>"
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>spki</var> be the result of running the
                      <a href="https://www.w3.org/TR/webcrypto-2/#concept-parse-a-spki">parse a subjectPublicKeyInfo</a>
                      algorithm over <var>keyData</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If an error occurred while parsing,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-DSA-44</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-ml-dsa-44</code> (2.16.840.1.101.3.4.3.17).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-DSA-65</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-ml-dsa-65</code> (2.16.840.1.101.3.4.3.18).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-DSA-87</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-ml-dsa-87</code> (2.16.840.1.101.3.4.3.19).
                        </p>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <p>
                          <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                        </p>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the <code>algorithm</code> object identifier field of the
                      <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is
                      not equal to <var>expectedOid</var>,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <code>parameters</code> field of the <code>algorithm</code>
                      AlgorithmIdentifier field of <var>spki</var> is present,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>publicKey</var> be the ML-DSA public key identified by
                      the <code>subjectPublicKey</code> field of <var>spki</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
                      that represents <var>publicKey</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> to "<code>public</code>"
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                      <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> attribute of
                      <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a>
                      internal slot of <var>key</var> to <var>algorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
                      slot of <var>key</var> to <var>extractable</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
                      <var>key</var> to <var>usages</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-pkcs8" class="internalDFN" id="ref-for-dom-keyformat-pkcs8-3"><code>pkcs8</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If <var>usages</var> contains a value which is not
                      "<code>sign</code>"
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>privateKeyInfo</var> be the result of running the
                      <a href="https://www.w3.org/TR/webcrypto-2/#concept-parse-a-privateKeyInfo">parse a privateKeyInfo</a>
                      algorithm over <var>keyData</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If an error occurs while parsing,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-DSA-44</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-ml-dsa-44</code> (2.16.840.1.101.3.4.3.17).
                        </p>
                        <p>
                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-DSA-44-PrivateKey</code> structure.
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-DSA-65</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-ml-dsa-65</code> (2.16.840.1.101.3.4.3.18).
                        </p>
                        <p>
                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-DSA-65-PrivateKey</code> structure.
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-DSA-87</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-ml-dsa-87</code> (2.16.840.1.101.3.4.3.19).
                        </p>
                        <p>
                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-DSA-87-PrivateKey</code> structure.
                        </p>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <p>
                          <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                        </p>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the <code>algorithm</code> object identifier field of the
                      <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of
                      <var>privateKeyInfo</var> is not equal to <var>expectedOid</var>,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <code>parameters</code> field of the
                      <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field
                      of <var>privateKeyInfo</var> is present,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>mlDsaPrivateKey</var> be the result of performing the
                      <a href="https://www.w3.org/TR/webcrypto-2/#concept-parse-an-asn1-structure">parse an ASN.1 structure</a>
                      algorithm, with <var>data</var> as the <code>privateKey</code> field
                      of <var>privateKeyInfo</var>, <var>structure</var> as <var>asn1Structure</var>, and <var>exactData</var> set to true.
                    </p>
                  </li>
                  <li>
                    <p>
                      If an error occurred while parsing,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
                      that represents the ML-DSA private key identified by <var>mlDsaPrivateKey</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>"
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                      <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> attribute of
                      <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a>
                      internal slot of <var>key</var> to <var>algorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
                      slot of <var>key</var> to <var>extractable</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
                      <var>key</var> to <var>usages</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-public" class="internalDFN" id="ref-for-dom-keyformat-raw-public-5"><code>raw-public</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If <var>usages</var> contains a value which is not
                      "<code>verify</code>"
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                      <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> attribute of
                      <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
                      representing the key data provided in <var>keyData</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> to "<code>public</code>"
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a>
                      internal slot of <var>key</var> to <var>algorithm</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-seed" class="internalDFN" id="ref-for-dom-keyformat-raw-seed-4"><code>raw-seed</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If <var>usages</var> contains an entry which is not
                      "<code>sign</code>"
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be <var>keyData</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the length in bits of <var>data</var> is not 256
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>privateKey</var> be the result of performing the
                      ML-DSA.KeyGen_internal function described in
                      Section 6.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-204" title="Module-Lattice-Based Digital Signature Standard">FIPS-204</a></cite>] with the parameter set
                      indicated by the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>,
                      using <var>data</var> as <var>ξ</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
                      that represents the ML-DSA private key identified by <var>privateKey</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>"
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                      <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> attribute of
                      <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a>
                      internal slot of <var>key</var> to <var>algorithm</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-jwk" class="internalDFN" id="ref-for-dom-keyformat-jwk-3"><code>jwk</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <dl class="switch">
                      <dt>If <var>keyData</var> is a <a data-link-type="idl" data-lt="JsonWebKey" href="#dfn-JsonWebKey" class="internalDFN" id="ref-for-dfn-JsonWebKey-4"><code>JsonWebKey</code></a> dictionary:</dt>
                      <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>
                      <dt>Otherwise:</dt>
                      <dd><p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">Throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</p></dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-8"><code>priv</code></a> field is present
                      and <var>usages</var> contains a value which is not
                      "<code>sign</code>", or,
                      if the <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-9"><code>priv</code></a> field is not present
                      and <var>usages</var> contains a value which is not
                      "<code>verify</code>"
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-kty" class="internalDFN" id="ref-for-dom-jsonwebkey-kty-2"><code>kty</code></a> field of <var>jwk</var> is not
                      "<code>AKP</code>",
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-alg" class="internalDFN" id="ref-for-dom-jsonwebkey-alg-2"><code>alg</code></a> field of <var>jwk</var> is not equal to
                      the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If <var>usages</var> is non-empty and the <a data-link-type="idl" href="#dom-jsonwebkey-use" class="internalDFN" id="ref-for-dom-jsonwebkey-use-2"><code>use</code></a> field of <var>jwk</var> is present
                      and is not equal to "<code>sig</code>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-key_ops" class="internalDFN" id="ref-for-dom-jsonwebkey-key_ops-2"><code>key_ops</code></a> field of <var>jwk</var> is present, and
                      is invalid according to the requirements of JSON Web
                      Key [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwk" title="JSON Web Key (JWK)">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>
                      values,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-ext" class="internalDFN" id="ref-for-dom-jsonwebkey-ext-2"><code>ext</code></a> field of <var>jwk</var> is present and
                      has the value false and <var>extractable</var> is true,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-10"><code>priv</code></a> field of <var>jwk</var> is present:</dt>
                      <dd>
                        <ol>
                          <li>
                            <p>
                              If the <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-11"><code>priv</code></a> attribute of <var>jwk</var>
                              does not contain a valid base64url encoded seed
                              representing an ML-DSA private key,
                              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                            </p>
                          </li>
                          <li>
                            <p>
                              Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a> object that represents the
                              ML-DSA private key identified by interpreting the
                              <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-12"><code>priv</code></a> attribute of <var>jwk</var>
                              as a base64url encoded seed.
                            </p>
                          </li>
                          <li>
                            <p>
                              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a>
                              internal slot of <var>Key</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>".
                            </p>
                          </li>
                          <li>
                            <p>
                              If the <a data-link-type="idl" href="#dom-jsonwebkey-pub" class="internalDFN" id="ref-for-dom-jsonwebkey-pub-6"><code>pub</code></a> attribute of <var>jwk</var>
                              does not contain the base64url encoded public key
                              representing the ML-DSA public key
                              corresponding to <var>key</var>,
                              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                            </p>
                          </li>
                        </ol>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <ol>
                          <li>
                            <p>
                              If the <a data-link-type="idl" href="#dom-jsonwebkey-pub" class="internalDFN" id="ref-for-dom-jsonwebkey-pub-7"><code>pub</code></a> attribute of <var>jwk</var>
                              does not contain a valid base64url encoded public key
                              representing an ML-DSA public key,
                              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                            </p>
                          </li>
                          <li>
                            <p>
                              Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a> object that represents the
                              ML-DSA public key identified by interpreting the
                              <a data-link-type="idl" href="#dom-jsonwebkey-pub" class="internalDFN" id="ref-for-dom-jsonwebkey-pub-8"><code>pub</code></a> attribute of <var>jwk</var>
                              as a base64url encoded public key.
                            </p>
                          </li>
                          <li>
                            <p>
                              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a>
                              internal slot of <var>Key</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-public"><code>public</code></a>".
                            </p>
                          </li>
                        </ol>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be a new instance of a <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                      <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a>
                      internal slot of <var>key</var> to <var>algorithm</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                  <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return <var>key</var>
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-dsa-operations-export-key"><div class="header-wrapper"><h4 id="x7-4-5-export-key"><bdi class="secno">7.4.5 </bdi>Export Key</h4><a class="self-link" href="#ml-dsa-operations-export-key" aria-label="Permalink for Section 7.4.5"></a></div>
        
        <ol>
          <li>
            <p>
              Let <var>key</var> be the <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a> to be
              exported.
            </p>
          </li>
          <li>
            <p>
              If the underlying cryptographic key material represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of <var>key</var>
              cannot be accessed, then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-spki" class="internalDFN" id="ref-for-dom-keyformat-spki-4"><code>spki</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> is not "<code>public</code>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be an instance of the <code>SubjectPublicKeyInfo</code>
                      ASN.1 structure defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5280" title="Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile">RFC5280</a></cite>]
                      with the following properties:
                    </p>
                    <ul>
                      <li>
                        <p>
                          Set the <var>algorithm</var> field to an
                          <code>AlgorithmIdentifier</code> ASN.1 type with the following
                          properties:
                        </p>
                        <ul>
                          <li>
                            <dl class="switch">
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-DSA-44</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-44</code> (2.16.840.1.101.3.4.3.17) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-DSA-65</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-65</code> (2.16.840.1.101.3.4.3.18) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-DSA-87</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-87</code> (2.16.840.1.101.3.4.3.19) OID.
                                </p>
                              </dd>
                              <dt>Otherwise:</dt>
                              <dd>
                                <p>
                                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                                </p>
                              </dd>
                            </dl>
                          </li>
                        </ul>
                      </li>
                      <li>
                        <p>
                          Set the <var>subjectPublicKey</var> field to <var>keyData</var>.
                        </p>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be the result of DER-encoding <var>data</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-pkcs8" class="internalDFN" id="ref-for-dom-keyformat-pkcs8-4"><code>pkcs8</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> is not "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be an instance of the <code>PrivateKeyInfo</code>
                      ASN.1 structure defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5208" title="Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2">RFC5208</a></cite>]
                      with the following properties:
                    </p>
                    <ul>
                      <li>
                        <p>
                          Set the <var>version</var> field to <code>0</code>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Set the <var>privateKeyAlgorithm</var> field to a
                          <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the
                          following properties:
                        </p>
                        <ul>
                          <li>
                            <dl class="switch">
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-DSA-44</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-44</code> (2.16.840.1.101.3.4.3.17) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-DSA-65</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-65</code> (2.16.840.1.101.3.4.3.18) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-DSA-87</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-87</code> (2.16.840.1.101.3.4.3.19) OID.
                                </p>
                              </dd>
                              <dt>Otherwise:</dt>
                              <dd>
                                <p>
                                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                                </p>
                              </dd>
                            </dl>
                          </li>
                        </ul>
                      </li>
                      <li>
                        <p>
                          Set the <var>privateKey</var> field as follows:
                        </p>
                        <ul>
                          <li>
                            <dl class="switch">
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-DSA-44</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>privateKey</var> field to the result of DER-encoding
                                  a <code>ML-DSA-44-PrivateKey</code> ASN.1 type that represents the ML-DSA
                                  private key seed represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag
                                  with an implicit encoding of OCTET STRING).
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-DSA-65</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>privateKey</var> field to the result of DER-encoding
                                  a <code>ML-DSA-65-PrivateKey</code> ASN.1 type that represents the ML-DSA
                                  private key seed represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag
                                  with an implicit encoding of OCTET STRING).
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>ML-DSA-87</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>privateKey</var> field to the result of DER-encoding
                                  a <code>ML-DSA-87-PrivateKey</code> ASN.1 type that represents the ML-DSA
                                  private key seed represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag
                                  with an implicit encoding of OCTET STRING).
                                </p>
                              </dd>
                              <dt>Otherwise:</dt>
                              <dd>
                                <p>
                                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                                </p>
                              </dd>
                            </dl>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be the result of DER-encoding <var>data</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>
                If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-public" class="internalDFN" id="ref-for-dom-keyformat-raw-public-6"><code>raw-public</code></a>":
              </dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> is not "<code>public</code>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a> containing the ML-DSA
                      public key represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of
                      <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be <var>data</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-seed" class="internalDFN" id="ref-for-dom-keyformat-raw-seed-5"><code>raw-seed</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> is not "<code>private</code>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a> containing the <var>ξ</var> seed variable
                      of the key represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                      internal slot of <var>key</var>.
                    </p>
                    <div class="note" role="note" id="issue-container-generatedID-5"><div role="heading" class="note-title marker" id="h-note-5" aria-level="5"><span>Note</span></div><div class="">
                      <p>
                        The <var>ξ</var> seed variable was sampled in the ML-DSA.KeyGen function
                        as described in Section 5.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-204" title="Module-Lattice-Based Digital Signature Standard">FIPS-204</a></cite>].
                      </p>
                    </div></div>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be <var>data</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-jwk" class="internalDFN" id="ref-for-dom-keyformat-jwk-4"><code>jwk</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let <var>jwk</var> be a new <a data-link-type="idl" data-lt="JsonWebKey" href="#dfn-JsonWebKey" class="internalDFN" id="ref-for-dfn-JsonWebKey-5"><code>JsonWebKey</code></a>
                      dictionary.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>kty</code> attribute of <var>jwk</var> to
                      "<code>AKP</code>".
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>alg</code> attribute of <var>jwk</var> to
                      the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="idl" href="#dom-jsonwebkey-pub" class="internalDFN" id="ref-for-dom-jsonwebkey-pub-9"><code>pub</code></a> attribute of <var>jwk</var>
                      to the base64url encoded public key corresponding
                      to the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                      internal slot of <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>
                        If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                        of <var>key</var> is "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>":
                      </dt>
                      <dd>
                        Set the <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-13"><code>priv</code></a> attribute of <var>jwk</var>
                        to the base64url encoded seed represented by
                        the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                        internal slot of <var>key</var>.
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type="attribute" href="https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages"><code>usages</code></a> attribute of <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>ext</code> attribute of <var>jwk</var> to the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal slot
                      of <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be <var>jwk</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                  <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>

  <section id="slh-dsa"><div class="header-wrapper"><h2 id="x8-slh-dsa"><bdi class="secno">8. </bdi>SLH-DSA</h2><a class="self-link" href="#slh-dsa" aria-label="Permalink for Section 8."></a></div>
    
    <section id="slh-dsa-description" class="informative"><div class="header-wrapper"><h3 id="x8-1-description"><bdi class="secno">8.1 </bdi>Description</h3><a class="self-link" href="#slh-dsa-description" aria-label="Permalink for Section 8.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        This describes using SLH-DSA for signing and verification,
        as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-205" title="Stateless Hash-Based Digital Signature Standard">FIPS-205</a></cite>].
      </p>
    </section>
    <section id="slh-dsa-registration"><div class="header-wrapper"><h3 id="x8-2-registration"><bdi class="secno">8.2 </bdi>Registration</h3><a class="self-link" href="#slh-dsa-registration" aria-label="Permalink for Section 8.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/webcrypto-2/#recognized-algorithm-name">recognized algorithm names</a> for
        this algorithm are "<code>SLH-DSA-SHA2-128s</code>", "<code>SLH-DSA-SHAKE-128s</code>",
        "<code>SLH-DSA-SHA2-128f</code>", "<code>SLH-DSA-SHAKE-128f</code>",
        "<code>SLH-DSA-SHA2-192s</code>", "<code>SLH-DSA-SHAKE-192s</code>",
        "<code>SLH-DSA-SHA2-192f</code>", "<code>SLH-DSA-SHAKE-192f</code>",
        "<code>SLH-DSA-SHA2-256s</code>", "<code>SLH-DSA-SHAKE-256s</code>",
        "<code>SLH-DSA-SHA2-256f</code>" and "<code>SLH-DSA-SHAKE-256f</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>sign</td>
            <td><a data-link-type="idl" data-lt="ContextParams" href="#dfn-ContextParams" class="internalDFN" id="ref-for-dfn-ContextParams-4"><code>ContextParams</code></a></td>
            <td><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a></td>
          </tr>
          <tr>
            <td>verify</td>
            <td><a data-link-type="idl" data-lt="ContextParams" href="#dfn-ContextParams" class="internalDFN" id="ref-for-dfn-ContextParams-5"><code>ContextParams</code></a></td>
            <td>boolean</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td><a data-link-type="dictionary" data-lt="CryptoKeyPair" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair"><code>CryptoKeyPair</code></a></td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td><a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="slh-dsa-operations"><div class="header-wrapper"><h3 id="x8-3-operations"><bdi class="secno">8.3 </bdi>Operations</h3><a class="self-link" href="#slh-dsa-operations" aria-label="Permalink for Section 8.3"></a></div>
      
      <section id="slh-dsa-operations-sign"><div class="header-wrapper"><h4 id="x8-3-1-sign"><bdi class="secno">8.3.1 </bdi>Sign</h4><a class="self-link" href="#slh-dsa-operations-sign" aria-label="Permalink for Section 8.3.1"></a></div>
        
        <ol>
          <li>
            <p>
              If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot of
              <var>key</var> is not "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>context</var> be the <a data-link-type="idl" href="#dfn-ContextParams-context" class="internalDFN" id="ref-for-dfn-ContextParams-context-6"><code>context</code></a> member of <var>normalizedAlgorithm</var>
              or the empty octet string if the <a data-link-type="idl" href="#dfn-ContextParams-context" class="internalDFN" id="ref-for-dfn-ContextParams-context-7"><code>context</code></a> member of
              <var>normalizedAlgorithm</var> is not present.
            </p>
          </li>
          <li>
            <p>
              Let <var>result</var> be the result of performing the <code>slh_sign</code>
              signing algorithm, as specified in Section 10.2.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-205" title="Stateless Hash-Based Digital Signature Standard">FIPS-205</a></cite>],
              with the parameter set indicated by the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>,
              using the SLH-DSA private key associated with <var>key</var> as <var>SK</var>,
              <var>message</var> as <var>M</var> and <var>context</var> as <var>ctx</var>.
            </p>
          </li>
          <li>
            <p>
              If the <code>slh_sign</code> algorithm returned an error, return an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="slh-dsa-operations-verify"><div class="header-wrapper"><h4 id="x8-3-2-verify"><bdi class="secno">8.3.2 </bdi>Verify</h4><a class="self-link" href="#slh-dsa-operations-verify" aria-label="Permalink for Section 8.3.2"></a></div>
        
        <ol>
          <li>
            <p>
              If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot of
              <var>key</var> is not "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-public"><code>public</code></a>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>context</var> be the <a data-link-type="idl" href="#dfn-ContextParams-context" class="internalDFN" id="ref-for-dfn-ContextParams-context-8"><code>context</code></a> member of <var>normalizedAlgorithm</var>
              or the empty octet string if the <a data-link-type="idl" href="#dfn-ContextParams-context" class="internalDFN" id="ref-for-dfn-ContextParams-context-9"><code>context</code></a> member of
              <var>normalizedAlgorithm</var> is not present.
            </p>
          </li>
          <li>
            <p>
              Let <var>result</var> be the result of performing the <code>slh_verify</code>
              verification algorithm, as specified in Section 10.3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-205" title="Stateless Hash-Based Digital Signature Standard">FIPS-205</a></cite>],
              with the parameter set indicated by the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>,
              using the SLH-DSA public key associated with <var>key</var> as <var>PK</var>,
              <var>message</var> as <var>M</var>, <var>signature</var> as <var>SIG</var> and <var>context</var> as <var>ctx</var>.
            </p>
          </li>
          <li>
            <p>
              If the <code>slh_verify</code> algorithm returned an error, return an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="slh-dsa-operations-generate-key"><div class="header-wrapper"><h4 id="x8-3-3-generate-key"><bdi class="secno">8.3.3 </bdi>Generate Key</h4><a class="self-link" href="#slh-dsa-operations-generate-key" aria-label="Permalink for Section 8.3.3"></a></div>
        
        <ol>
          <li>
            <p>
              If <var>usages</var> contains a value which is not
              one of "<code>sign</code>" or "<code>verify</code>",
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
              <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Generate an SLH-DSA key pair, as described in
              Section 10.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-205" title="Stateless Hash-Based Digital Signature Standard">FIPS-205</a></cite>], with the parameter set
              indicated by the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>.
            </p>
          </li>
          <li>
            <p>
              If the key generation step fails,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
              <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> attribute of
              <var>normalizedAlgorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>publicKey</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
              representing the public key of the generated key pair.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot of
              <var>publicKey</var> to "<code>public</code>".
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal
              slot of <var>publicKey</var> to <var>algorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
              slot of <var>publicKey</var> to true.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
              <var>publicKey</var> to be the <a href="https://www.w3.org/TR/webcrypto-2/#concept-usage-intersection">usage intersection</a>
              of <var>usages</var> and <code>[ "verify" ]</code>.
            </p>
          </li>
          <li>
            <p>
              Let <var>privateKey</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
              representing the private key of the generated key pair.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot of
              <var>privateKey</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>".
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal
              slot of <var>privateKey</var> to <var>algorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
              slot of <var>privateKey</var> to <var>extractable</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
              <var>privateKey</var> to be the <a href="https://www.w3.org/TR/webcrypto-2/#concept-usage-intersection">usage intersection</a>
              of <var>usages</var> and <code>[ "sign" ]</code>.
            </p>
          </li>
          <li>
            <p>
              Let <var>result</var> be a new <a data-link-type="dictionary" data-lt="CryptoKeyPair" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair"><code>CryptoKeyPair</code></a>
              dictionary.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-publicKey"><code>publicKey</code></a> attribute
              of <var>result</var> to be <var>publicKey</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-privateKey"><code>privateKey</code></a> attribute
              of <var>result</var> to be <var>privateKey</var>.
            </p>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="slh-dsa-operations-import-key"><div class="header-wrapper"><h4 id="x8-3-4-import-key"><bdi class="secno">8.3.4 </bdi>Import Key</h4><a class="self-link" href="#slh-dsa-operations-import-key" aria-label="Permalink for Section 8.3.4"></a></div>
        
        <ol>
          <li>
            <p>Let <var>keyData</var> be the key data to be imported.</p>
          </li>
          <li>
            <dl class="switch">
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-spki" class="internalDFN" id="ref-for-dom-keyformat-spki-5"><code>spki</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If <var>usages</var> contains a value which is not
                      "<code>verify</code>"
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>spki</var> be the result of running the
                      <a href="https://www.w3.org/TR/webcrypto-2/#concept-parse-a-spki">parse a subjectPublicKeyInfo</a>
                      algorithm over <var>keyData</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If an error occurred while parsing,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-128s</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-128s</code> (2.16.840.1.101.3.4.3.20).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-128f</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-128f</code> (2.16.840.1.101.3.4.3.21).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-192s</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-192s</code> (2.16.840.1.101.3.4.3.22).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-192f</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-192f</code> (2.16.840.1.101.3.4.3.23).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-256s</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-256s</code> (2.16.840.1.101.3.4.3.24).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-256f</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-256f</code> (2.16.840.1.101.3.4.3.25).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-128s</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-128s</code> (2.16.840.1.101.3.4.3.26).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-128f</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-128f</code> (2.16.840.1.101.3.4.3.27).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-192s</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-192s</code> (2.16.840.1.101.3.4.3.28).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-192f</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-192f</code> (2.16.840.1.101.3.4.3.29).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-256s</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-256s</code> (2.16.840.1.101.3.4.3.30).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-256f</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-256f</code> (2.16.840.1.101.3.4.3.31).
                        </p>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <p>
                          <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                        </p>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the <code>algorithm</code> object identifier field of the
                      <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is
                      not equal to <var>expectedOid</var>,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <code>parameters</code> field of the <code>algorithm</code>
                      AlgorithmIdentifier field of <var>spki</var> is present,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>publicKey</var> be the SLH-DSA public key identified by
                      the <code>subjectPublicKey</code> field of <var>spki</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
                      that represents <var>publicKey</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> to "<code>public</code>"
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                      <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> attribute of
                      <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a>
                      internal slot of <var>key</var> to <var>algorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
                      slot of <var>key</var> to <var>extractable</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
                      <var>key</var> to <var>usages</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-pkcs8" class="internalDFN" id="ref-for-dom-keyformat-pkcs8-5"><code>pkcs8</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If <var>usages</var> contains a value which is not
                      "<code>sign</code>"
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>privateKeyInfo</var> be the result of running the
                      <a href="https://www.w3.org/TR/webcrypto-2/#concept-parse-a-privateKeyInfo">parse a privateKeyInfo</a>
                      algorithm over <var>keyData</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If an error occurs while parsing,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-128s</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-128s</code> (2.16.840.1.101.3.4.3.20).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-128f</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-128f</code> (2.16.840.1.101.3.4.3.21).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-192s</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-192s</code> (2.16.840.1.101.3.4.3.22).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-192f</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-192f</code> (2.16.840.1.101.3.4.3.23).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-256s</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-256s</code> (2.16.840.1.101.3.4.3.24).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-256f</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-256f</code> (2.16.840.1.101.3.4.3.25).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-128s</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-128s</code> (2.16.840.1.101.3.4.3.26).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-128f</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-128f</code> (2.16.840.1.101.3.4.3.27).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-192s</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-192s</code> (2.16.840.1.101.3.4.3.28).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-192f</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-192f</code> (2.16.840.1.101.3.4.3.29).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-256s</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-256s</code> (2.16.840.1.101.3.4.3.30).
                        </p>
                      </dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-256f</code>":</dt>
                      <dd>
                        <p>
                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-256f</code> (2.16.840.1.101.3.4.3.31).
                        </p>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <p>
                          <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                        </p>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the <code>algorithm</code> object identifier field of the
                      <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of
                      <var>privateKeyInfo</var> is not equal to <var>expectedOid</var>,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <code>parameters</code> field of the
                      <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field
                      of <var>privateKeyInfo</var> is present,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>slhDsaPrivateKey</var> be the result of performing the
                      <a href="https://www.w3.org/TR/webcrypto-2/#concept-parse-an-asn1-structure">parse an ASN.1 structure</a>
                      algorithm, with <var>data</var> as the <code>privateKey</code> field
                      of <var>privateKeyInfo</var>, <var>structure</var> as OCTET STRING, and <var>exactData</var> set to true.
                    </p>
                  </li>
                  <li>
                    <p>
                      If an error occurred while parsing,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
                      that represents the SLH-DSA private key identified by <var>slhDsaPrivateKey</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>"
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                      <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> attribute of
                      <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a>
                      internal slot of <var>key</var> to <var>algorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
                      slot of <var>key</var> to <var>extractable</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
                      <var>key</var> to <var>usages</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-public" class="internalDFN" id="ref-for-dom-keyformat-raw-public-7"><code>raw-public</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If <var>usages</var> contains a value which is not
                      "<code>verify</code>"
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                      <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> attribute of
                      <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence-length">length</a> of <var>keyData</var> is not the <code>pk length</code>
                      specified by Table 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-205" title="Stateless Hash-Based Digital Signature Standard">FIPS-205</a></cite>]
                      for the parameter set indicated by the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
                      representing the key data provided in <var>keyData</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> to "<code>public</code>"
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a>
                      internal slot of <var>key</var> to <var>algorithm</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-private" class="internalDFN" id="ref-for-dom-keyformat-raw-private-2"><code>raw-private</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If <var>usages</var> contains an entry which is not
                      "<code>sign</code>"
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence-length">length</a> of <var>keyData</var> is not 2 * the <code>pk length</code>
                      specified by Table 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-205" title="Stateless Hash-Based Digital Signature Standard">FIPS-205</a></cite>]
                      for the parameter set indicated by the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
                      representing the key data provided in <var>keyData</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>".
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                      <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> attribute of
                      <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a>
                      internal slot of <var>key</var> to <var>algorithm</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-jwk" class="internalDFN" id="ref-for-dom-keyformat-jwk-5"><code>jwk</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <dl class="switch">
                      <dt>If <var>keyData</var> is a <a data-link-type="idl" data-lt="JsonWebKey" href="#dfn-JsonWebKey" class="internalDFN" id="ref-for-dfn-JsonWebKey-6"><code>JsonWebKey</code></a> dictionary:</dt>
                      <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>
                      <dt>Otherwise:</dt>
                      <dd><p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">Throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</p></dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-14"><code>priv</code></a> field is present
                      and <var>usages</var> contains a value which is not
                      "<code>sign</code>", or,
                      if the <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-15"><code>priv</code></a> field is not present
                      and <var>usages</var> contains a value which is not
                      "<code>verify</code>"
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-kty" class="internalDFN" id="ref-for-dom-jsonwebkey-kty-3"><code>kty</code></a> field of <var>jwk</var> is not
                      "<code>AKP</code>",
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-alg" class="internalDFN" id="ref-for-dom-jsonwebkey-alg-3"><code>alg</code></a> field of <var>jwk</var> is not equal to
                      the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If <var>usages</var> is non-empty and the <a data-link-type="idl" href="#dom-jsonwebkey-use" class="internalDFN" id="ref-for-dom-jsonwebkey-use-3"><code>use</code></a> field of <var>jwk</var> is present
                      and is not equal to "<code>sig</code>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-key_ops" class="internalDFN" id="ref-for-dom-jsonwebkey-key_ops-3"><code>key_ops</code></a> field of <var>jwk</var> is present, and
                      is invalid according to the requirements of JSON Web
                      Key [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwk" title="JSON Web Key (JWK)">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>
                      values,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-ext" class="internalDFN" id="ref-for-dom-jsonwebkey-ext-3"><code>ext</code></a> field of <var>jwk</var> is present and
                      has the value false and <var>extractable</var> is true,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-16"><code>priv</code></a> field of <var>jwk</var> is present:</dt>
                      <dd>
                        <ol>
                          <li>
                            <p>
                              If the <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-17"><code>priv</code></a> attribute of <var>jwk</var>
                              does not contain a valid base64url encoded value
                              representing an SLH-DSA private key,
                              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                            </p>
                          </li>
                          <li>
                            <p>
                              Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a> object that represents the
                              SLH-DSA private key identified by interpreting the
                              <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-18"><code>priv</code></a> attribute of <var>jwk</var>
                              as a base64url encoded private key.
                            </p>
                          </li>
                          <li>
                            <p>
                              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a>
                              internal slot of <var>Key</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>".
                            </p>
                          </li>
                          <li>
                            <p>
                              If the <a data-link-type="idl" href="#dom-jsonwebkey-pub" class="internalDFN" id="ref-for-dom-jsonwebkey-pub-10"><code>pub</code></a> attribute of <var>jwk</var>
                              does not contain the base64url encoded public key
                              representing the SLH-DSA public key
                              corresponding to <var>key</var>,
                              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                            </p>
                          </li>
                        </ol>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <ol>
                          <li>
                            <p>
                              If the <a data-link-type="idl" href="#dom-jsonwebkey-pub" class="internalDFN" id="ref-for-dom-jsonwebkey-pub-11"><code>pub</code></a> attribute of <var>jwk</var>
                              does not contain a valid base64url encoded public key
                              representing an SLH-DSA public key,
                              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                            </p>
                          </li>
                          <li>
                            <p>
                              Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a> object that represents the
                              SLH-DSA public key identified by interpreting the
                              <a data-link-type="idl" href="#dom-jsonwebkey-pub" class="internalDFN" id="ref-for-dom-jsonwebkey-pub-12"><code>pub</code></a> attribute of <var>jwk</var>
                              as a base64url encoded public key.
                            </p>
                          </li>
                          <li>
                            <p>
                              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a>
                              internal slot of <var>Key</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-public"><code>public</code></a>".
                            </p>
                          </li>
                        </ol>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be a new instance of a <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a> object.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                      <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a>
                      internal slot of <var>key</var> to <var>algorithm</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                  <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return <var>key</var>
            </p>
          </li>
        </ol>
      </section>
      <section id="slh-dsa-operations-export-key"><div class="header-wrapper"><h4 id="x8-3-5-export-key"><bdi class="secno">8.3.5 </bdi>Export Key</h4><a class="self-link" href="#slh-dsa-operations-export-key" aria-label="Permalink for Section 8.3.5"></a></div>
        
        <ol>
          <li>
            <p>
              Let <var>key</var> be the <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a> to be
              exported.
            </p>
          </li>
          <li>
            <p>
              If the underlying cryptographic key material represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of <var>key</var>
              cannot be accessed, then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-spki" class="internalDFN" id="ref-for-dom-keyformat-spki-6"><code>spki</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> is not "<code>public</code>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be an instance of the <code>SubjectPublicKeyInfo</code>
                      ASN.1 structure defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5280" title="Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile">RFC5280</a></cite>]
                      with the following properties:
                    </p>
                    <ul>
                      <li>
                        <p>
                          Set the <var>algorithm</var> field to an
                          <code>AlgorithmIdentifier</code> ASN.1 type with the following
                          properties:
                        </p>
                        <ul>
                          <li>
                            <dl class="switch">
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-128s</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-128s</code> (2.16.840.1.101.3.4.3.20) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-128f</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-128f</code> (2.16.840.1.101.3.4.3.21) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-192s</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-192s</code> (2.16.840.1.101.3.4.3.22) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-192f</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-192f</code> (2.16.840.1.101.3.4.3.23) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-256s</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-256s</code> (2.16.840.1.101.3.4.3.24) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-256f</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-256f</code> (2.16.840.1.101.3.4.3.25) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-128s</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-128s</code> (2.16.840.1.101.3.4.3.26) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-128f</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-128f</code> (2.16.840.1.101.3.4.3.27) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-192s</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-192s</code> (2.16.840.1.101.3.4.3.28) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-192f</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-192f</code> (2.16.840.1.101.3.4.3.29) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-256s</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-256s</code> (2.16.840.1.101.3.4.3.30) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-256f</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-256f</code> (2.16.840.1.101.3.4.3.31) OID.
                                </p>
                              </dd>
                              <dt>Otherwise:</dt>
                              <dd>
                                <p>
                                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                                </p>
                              </dd>
                            </dl>
                          </li>
                        </ul>
                      </li>
                      <li>
                        <p>
                          Set the <var>subjectPublicKey</var> field to <var>keyData</var>.
                        </p>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be the result of DER-encoding <var>data</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-pkcs8" class="internalDFN" id="ref-for-dom-keyformat-pkcs8-6"><code>pkcs8</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> is not "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be an instance of the <code>PrivateKeyInfo</code>
                      ASN.1 structure defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5208" title="Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2">RFC5208</a></cite>]
                      with the following properties:
                    </p>
                    <ul>
                      <li>
                        <p>
                          Set the <var>version</var> field to <code>0</code>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Set the <var>privateKeyAlgorithm</var> field to a
                          <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the
                          following properties:
                        </p>
                        <ul>
                          <li>
                            <dl class="switch">

                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-128s</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-128s</code> (2.16.840.1.101.3.4.3.20) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-128f</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-128f</code> (2.16.840.1.101.3.4.3.21) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-192s</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-192s</code> (2.16.840.1.101.3.4.3.22) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-192f</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-192f</code> (2.16.840.1.101.3.4.3.23) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-256s</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-256s</code> (2.16.840.1.101.3.4.3.24) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHA2-256f</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-256f</code> (2.16.840.1.101.3.4.3.25) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-128s</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-128s</code> (2.16.840.1.101.3.4.3.26) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-128f</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-128f</code> (2.16.840.1.101.3.4.3.27) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-192s</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-192s</code> (2.16.840.1.101.3.4.3.28) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-192f</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-192f</code> (2.16.840.1.101.3.4.3.29) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-256s</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-256s</code> (2.16.840.1.101.3.4.3.30) OID.
                                </p>
                              </dd>
                              <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var> is "<code>SLH-DSA-SHAKE-256f</code>":</dt>
                              <dd>
                                <p>
                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-256f</code> (2.16.840.1.101.3.4.3.31) OID.
                                </p>
                              </dd>
                              <dt>Otherwise:</dt>
                              <dd>
                                <p>
                                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                                </p>
                              </dd>
                            </dl>
                          </li>
                        </ul>
                      </li>
                      <li>
                        <p>
                          Set the <var>privateKey</var> field to the result of DER-encoding
                          a <code>OCTET STRING</code> ASN.1 type that represents the SLH-DSA private key represented
                          by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                          internal slot of <var>key</var>
                        </p>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be the result of DER-encoding <var>data</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>
                If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-public" class="internalDFN" id="ref-for-dom-keyformat-raw-public-8"><code>raw-public</code></a>":
              </dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> is not "<code>public</code>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a> containing the SLH-DSA
                      public key represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of
                      <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be <var>data</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-private" class="internalDFN" id="ref-for-dom-keyformat-raw-private-3"><code>raw-private</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                      of <var>key</var> is not "<code>private</code>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="InvalidAccessError" href="https://webidl.spec.whatwg.org/#invalidaccesserror"><code>InvalidAccessError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a> containing the SLH-DSA
                      private key represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of
                      <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be <var>data</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-jwk" class="internalDFN" id="ref-for-dom-keyformat-jwk-6"><code>jwk</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let <var>jwk</var> be a new <a data-link-type="idl" data-lt="JsonWebKey" href="#dfn-JsonWebKey" class="internalDFN" id="ref-for-dfn-JsonWebKey-7"><code>JsonWebKey</code></a>
                      dictionary.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>kty</code> attribute of <var>jwk</var> to
                      "<code>AKP</code>".
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>alg</code> attribute of <var>jwk</var> to
                      the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of <var>normalizedAlgorithm</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="idl" href="#dom-jsonwebkey-pub" class="internalDFN" id="ref-for-dom-jsonwebkey-pub-13"><code>pub</code></a> attribute of <var>jwk</var>
                      to the base64url encoded public key corresponding
                      to the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                      internal slot of <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>
                        If the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot
                        of <var>key</var> is "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-private"><code>private</code></a>":
                      </dt>
                      <dd>
                        Set the <a data-link-type="idl" href="#dom-jsonwebkey-priv" class="internalDFN" id="ref-for-dom-jsonwebkey-priv-19"><code>priv</code></a> attribute of <var>jwk</var>
                        to the base64url encoded private key represented by
                        the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                        internal slot of <var>key</var>.
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type="attribute" href="https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages"><code>usages</code></a> attribute of <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>ext</code> attribute of <var>jwk</var> to the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal slot
                      of <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be <var>jwk</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                  <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>

  <section id="aes-ocb"><div class="header-wrapper"><h2 id="x9-aes-ocb"><bdi class="secno">9. </bdi>AES-OCB</h2><a class="self-link" href="#aes-ocb" aria-label="Permalink for Section 9."></a></div>
    
    <section id="aes-ocb-description" class="informative"><div class="header-wrapper"><h3 id="x9-1-description"><bdi class="secno">9.1 </bdi>Description</h3><a class="self-link" href="#aes-ocb-description" aria-label="Permalink for Section 9.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        The "<code>AES-OCB</code>" algorithm identifier is used to perform
        authenticated encryption and decryption using AES in OCB mode,
        as described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7253" title="The OCB Authenticated-Encryption Algorithm">RFC7253</a></cite>].
      </p>
    </section>
    <section id="aes-ocb-registration"><div class="header-wrapper"><h3 id="x9-2-registration"><bdi class="secno">9.2 </bdi>Registration</h3><a class="self-link" href="#aes-ocb-registration" aria-label="Permalink for Section 9.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/webcrypto-2/#recognized-algorithm-name">recognized algorithm name</a> for
        this algorithm is "<code>AES-OCB</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>encrypt</td>
            <td><a data-link-type="idl" data-lt="AeadParams" href="#dfn-AeadParams" class="internalDFN" id="ref-for-dfn-AeadParams-1"><code>AeadParams</code></a></td>
            <td><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a></td>
          </tr>
          <tr>
            <td>decrypt</td>
            <td><a data-link-type="idl" data-lt="AeadParams" href="#dfn-AeadParams" class="internalDFN" id="ref-for-dfn-AeadParams-2"><code>AeadParams</code></a></td>
            <td><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a></td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td><a data-link-type="dictionary" data-lt="AesKeyGenParams" href="https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyGenParams"><code>AesKeyGenParams</code></a></td>
            <td><a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
         <tr>
           <td>importKey</td>
           <td>None</td>
           <td><a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
         </tr>
         <tr>
           <td>exportKey</td>
           <td>None</td>
           <td>object</td>
         </tr>
         <tr>
           <td>get key length</td>
           <td><a data-link-type="dictionary" data-lt="AesDerivedKeyParams" href="https://www.w3.org/TR/webcrypto-2/#dfn-AesDerivedKeyParams"><code>AesDerivedKeyParams</code></a></td>
           <td>Integer</td>
         </tr>
        </tbody>
      </table>
    </section>
    <section id="aead-params"><div class="header-wrapper"><h3 id="x9-3-aeadparams-dictionary"><bdi class="secno">9.3 </bdi><dfn data-idl="dictionary" id="dfn-AeadParams" data-export="" data-dfn-type="dictionary" data-title="AeadParams" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>AeadParams</code></dfn> dictionary</h3><a class="self-link" href="#aead-params" aria-label="Permalink for Section 9.3"></a></div>
      
      <pre class="idl def" id="webidl-1353594407"><span class="idlHeader"><a class="self-link" href="#webidl-1353594407">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-aeadparams" data-title="AeadParams">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-AeadParams" id="ref-for-dfn-AeadParams-3"><code>AeadParams</code></a> : <span class="idlSuperclass"><a data-link-type="dictionary" href="https://www.w3.org/TR/webcrypto-2/#dfn-Algorithm">Algorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-aeadparams-iv" data-title="iv" data-dfn-for="AeadParams">
  required<span class="idlType"> <a data-link-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-AeadParams-iv" id="ref-for-dfn-AeadParams-iv-1"><code>iv</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-aeadparams-additionaldata" data-title="additionalData" data-dfn-for="AeadParams"><span class="idlType">
  <a data-link-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-AeadParams-additionalData" id="ref-for-dfn-AeadParams-additionalData-1"><code>additionalData</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-aeadparams-taglength" data-title="tagLength" data-dfn-for="AeadParams">
  [<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>]<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-octet">octet</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-AeadParams-tagLength" id="ref-for-dfn-AeadParams-tagLength-1"><code>tagLength</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-dfn-for="AeadParams" id="dfn-AeadParams-iv" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="iv" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>iv</code></dfn> member represents the initialization vector to use.</p>
      <p>The <dfn data-dfn-for="AeadParams" id="dfn-AeadParams-additionalData" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="additionalData" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>additionalData</code></dfn> member represents the additional authentication data to include.</p>
      <p>The <dfn data-dfn-for="AeadParams" id="dfn-AeadParams-tagLength" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="tagLength" data-type="octet" tabindex="0" aria-haspopup="dialog"><code>tagLength</code></dfn> member represents the desired length of the authentication tag.</p>
      <div class="note" role="note" id="issue-container-generatedID-6"><div role="heading" class="note-title marker" id="h-note-6" aria-level="4"><span>Note</span></div><div class="">
        <p>
          The <a data-link-type="idl" data-lt="AeadParams" href="#dfn-AeadParams" class="internalDFN" id="ref-for-dfn-AeadParams-4"><code>AeadParams</code></a> dictionary is identical to the <a data-link-type="dictionary" data-lt="AesGcmParams" href="https://www.w3.org/TR/webcrypto-2/#dfn-AesGcmParams"><code>AesGcmParams</code></a> dictionary of [<cite><a class="bibref" data-link-type="biblio" href="#bib-webcrypto" title="Web Cryptography Level 2">webcrypto</a></cite>],
          and the latter may be replaced by the former when merging this proposal.
        </p>
      </div></div>
    </section>
    <section id="aes-ocb-operations"><div class="header-wrapper"><h3 id="x9-4-operations"><bdi class="secno">9.4 </bdi>Operations</h3><a class="self-link" href="#aes-ocb-operations" aria-label="Permalink for Section 9.4"></a></div>
      
      <section id="aes-ocb-operations-encrypt"><div class="header-wrapper"><h4 id="x9-4-1-encrypt"><bdi class="secno">9.4.1 </bdi>Encrypt</h4><a class="self-link" href="#aes-ocb-operations-encrypt" aria-label="Permalink for Section 9.4.1"></a></div>
        
        <ol>
          <li>
            <p>
              If the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-2"><code>iv</code></a> member of
              <var>normalizedAlgorithm</var> has a length greater than 15
              bytes,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If the <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-2"><code>tagLength</code></a> member of
              <var>normalizedAlgorithm</var> is not present:</dt>
              <dd>Let <var>tagLength</var> be 128.</dd>
              <dt>If the <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-3"><code>tagLength</code></a> member of
              <var>normalizedAlgorithm</var> is one of 64, 96 or 128:</dt>
              <dd>Let <var>tagLength</var> be equal to the
              <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-4"><code>tagLength</code></a> member of
               <var>normalizedAlgorithm</var></dd>
              <dt>Otherwise:</dt>
              <dd>
                <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Let <var>additionalData</var> be the <a data-link-type="idl" href="#dfn-AeadParams-additionalData" class="internalDFN" id="ref-for-dfn-AeadParams-additionalData-2"><code>additionalData</code></a> member of
              <var>normalizedAlgorithm</var> if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <p>
              Let <var>C</var> be the output that results from performing
              the OCB-ENCRYPT function described in Section 4.2 of
              [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7253" title="The OCB Authenticated-Encryption Algorithm">RFC7253</a></cite>] using AES as the block cipher, using
              the key represented by <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
              internal slot of <var>key</var> as the <var>K</var> input parameter,
              the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-3"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as
              the <var>N</var> input parameter,
              <var>additionalData</var> as the <var>A</var> input parameter,
              <var>plaintext</var> as the <var>P</var> input parameter, and
              <var>tagLength</var> as the <var>TAGLEN</var> global parameter.
            </p>
          </li>
          <li>
            <p>
              Return <var>C</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="aes-ocb-operations-decrypt"><div class="header-wrapper"><h4 id="x9-4-2-decrypt"><bdi class="secno">9.4.2 </bdi>Decrypt</h4><a class="self-link" href="#aes-ocb-operations-decrypt" aria-label="Permalink for Section 9.4.2"></a></div>
        
        <ol>
          <li>
            <p>
              If the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-4"><code>iv</code></a> member of
              <var>normalizedAlgorithm</var> has a length greater than 15
              bytes,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If the <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-5"><code>tagLength</code></a> member of
              <var>normalizedAlgorithm</var> is not present:</dt>
              <dd>Let <var>tagLength</var> be 128.</dd>
              <dt>If the <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-6"><code>tagLength</code></a> member of
              <var>normalizedAlgorithm</var> is one of 64, 96 or 128:</dt>
              <dd>Let <var>tagLength</var> be equal to the
              <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-7"><code>tagLength</code></a> member of
               <var>normalizedAlgorithm</var></dd>
              <dt>Otherwise:</dt>
              <dd>
                <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              If <var>ciphertext</var> has a length less than <var>tagLength</var> bits,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>additionalData</var> be the <a data-link-type="idl" href="#dfn-AeadParams-additionalData" class="internalDFN" id="ref-for-dfn-AeadParams-additionalData-3"><code>additionalData</code></a> member of
              <var>normalizedAlgorithm</var> if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <p>
              Perform the OCB-DECRYPT function described in Section 4.3 of
              [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7253" title="The OCB Authenticated-Encryption Algorithm">RFC7253</a></cite>] using AES as the block cipher, using
              the key represented by <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
              internal slot of <var>key</var> as the <var>K</var> input parameter,
              the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-5"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as
              the <var>N</var> input parameter,
              <var>additionalData</var> as the <var>A</var> input parameter,
              <var>ciphertext</var> as the <var>C</var> input parameter, and
              <var>tagLength</var> as the <var>TAGLEN</var> global parameter.
            </p>
            <dl class="switch">
              <dt>If the result of the algorithm is the indication of authentication failure,
              "INVALID":</dt>
              <dd>
                <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>
              </dd>
              <dt>Otherwise:</dt>
              <dd>Let <var>plaintext</var> be the output <var>P</var> of OCB-DECRYPT.</dd>
            </dl>
          </li>
          <li>
            <p>
              Return <var>plaintext</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="aes-ocb-operations-generate-key"><div class="header-wrapper"><h4 id="x9-4-3-generate-key"><bdi class="secno">9.4.3 </bdi>Generate Key</h4><a class="self-link" href="#aes-ocb-operations-generate-key" aria-label="Permalink for Section 9.4.3"></a></div>
        
        <ol>
          <li>
            <p>
              If <var>usages</var> contains any entry which is not
              one of "<code>encrypt</code>", "<code>decrypt</code>",
              "<code>wrapKey</code>" or "<code>unwrapKey</code>",
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
              <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
            </p>
          </li>
          <li>
            <p>
              If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyGenParams-length"><code>length</code></a> member of
              <var>normalizedAlgorithm</var> is not equal to one of
              128, 192 or 256,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>

          <li>
            <p>
              Generate an AES key of length
              equal to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyGenParams-length"><code>length</code></a> member of
              <var>normalizedAlgorithm</var>.
            </p>
          </li>
          <li>
            <p>
              If the key generation step fails,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>key</var> be a new
              <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a> object representing the
              generated AES key.
            </p>
          </li>
          <li>
            <p>
              Let <var>algorithm</var> be a new
              <a data-link-type="dictionary" data-lt="AesKeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyAlgorithm"><code>AesKeyAlgorithm</code></a>.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
              <var>algorithm</var> to "<code>AES-OCB</code>".
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyAlgorithm-length"><code>length</code></a> attribute of
              <var>algorithm</var> to equal the
              <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyGenParams-length"><code>length</code></a> member of
              <var>normalizedAlgorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal
              slot of <var>key</var> to <var>algorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
              slot of <var>key</var> to be <var>extractable</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
              <var>key</var> to be <var>usages</var>.
            </p>
          </li>
          <li>
            <p>
              Return <var>key</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="aes-ocb-operations-import-key"><div class="header-wrapper"><h4 id="x9-4-4-import-key"><bdi class="secno">9.4.4 </bdi>Import Key</h4><a class="self-link" href="#aes-ocb-operations-import-key" aria-label="Permalink for Section 9.4.4"></a></div>
        
        <ol>
          <li>
            <p>Let <var>keyData</var> be the key data to be imported.</p>
          </li>
          <li>
            <p>
              If <var>usages</var> contains an entry which is not
              one of "<code>encrypt</code>", "<code>decrypt</code>",
              "<code>wrapKey</code>" or "<code>unwrapKey</code>",
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
              <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-secret" class="internalDFN" id="ref-for-dom-keyformat-raw-secret-6"><code>raw-secret</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let <var>data</var> be <var>keyData</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the length in bits of <var>data</var> is not 128, 192 or 256
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-jwk" class="internalDFN" id="ref-for-dom-keyformat-jwk-7"><code>jwk</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <dl class="switch">
                      <dt>If <var>keyData</var> is a <a data-link-type="idl" data-lt="JsonWebKey" href="#dfn-JsonWebKey" class="internalDFN" id="ref-for-dfn-JsonWebKey-8"><code>JsonWebKey</code></a> dictionary:</dt>
                      <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>
                      <dt>Otherwise:</dt>
                      <dd><p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">Throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</p></dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-kty" class="internalDFN" id="ref-for-dom-jsonwebkey-kty-4"><code>kty</code></a> field of <var>jwk</var> is not
                      "<code>oct</code>",
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If <var>jwk</var> does not meet the requirements of
                      Section 6.4 of JSON Web Algorithms [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwa" title="JSON Web Algorithms (JWA)">JWA</a></cite>],
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a> obtained by decoding the
                      <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-k"><code>k</code></a> field of <var>jwk</var>.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If <var>data</var> has length 128 bits:</dt>
                      <dd>If the <a data-link-type="idl" href="#dom-jsonwebkey-alg" class="internalDFN" id="ref-for-dom-jsonwebkey-alg-4"><code>alg</code></a> field of <var>jwk</var> is present, and is
                      not "<code>A128OCB</code>",
                        then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</dd>
                      <dt>If <var>data</var> has length 192 bits:</dt>
                      <dd>If the <a data-link-type="idl" href="#dom-jsonwebkey-alg" class="internalDFN" id="ref-for-dom-jsonwebkey-alg-5"><code>alg</code></a> field of <var>jwk</var> is present, and is
                      not "<code>A192OCB</code>",
                        then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</dd>
                      <dt>If <var>data</var> has length 256 bits:</dt>
                      <dd>If the <a data-link-type="idl" href="#dom-jsonwebkey-alg" class="internalDFN" id="ref-for-dom-jsonwebkey-alg-6"><code>alg</code></a> field of <var>jwk</var> is present, and is
                      not "<code>A256OCB</code>",
                        then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If <var>usages</var> is non-empty and the <a data-link-type="idl" href="#dom-jsonwebkey-use" class="internalDFN" id="ref-for-dom-jsonwebkey-use-4"><code>use</code></a> field of <var>jwk</var> is present and is
                      not "<code>enc</code>",
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-key_ops" class="internalDFN" id="ref-for-dom-jsonwebkey-key_ops-4"><code>key_ops</code></a> field of <var>jwk</var> is present, and
                      is invalid according to the requirements of
                      JSON Web Key [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwk" title="JSON Web Key (JWK)">JWK</a></cite>] or
                      does not contain all of the specified <var>usages</var> values,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-ext" class="internalDFN" id="ref-for-dom-jsonwebkey-ext-4"><code>ext</code></a> field of <var>jwk</var> is present and
                      has the value false and <var>extractable</var> is true,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
              object representing an AES key with value <var>data</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>algorithm</var> be a new
              <a data-link-type="dictionary" data-lt="AesKeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyAlgorithm"><code>AesKeyAlgorithm</code></a>.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
              <var>algorithm</var> to "<code>AES-OCB</code>".
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyAlgorithm-length"><code>length</code></a> attribute of
              <var>algorithm</var> to the length, in bits, of <var>data</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal
              slot of <var>key</var> to <var>algorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Return <var>key</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="aes-ocb-operations-export-key"><div class="header-wrapper"><h4 id="x9-4-5-export-key"><bdi class="secno">9.4.5 </bdi>Export Key</h4><a class="self-link" href="#aes-ocb-operations-export-key" aria-label="Permalink for Section 9.4.5"></a></div>
        
        <ol>
          <li>
            <p>
              If the underlying cryptographic key material represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of <var>key</var>
              cannot be accessed, then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-secret" class="internalDFN" id="ref-for-dom-keyformat-raw-secret-7"><code>raw-secret</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let <var>data</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a> containing
                      the raw octets of the key represented by <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of
                      <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be <var>data</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-jwk" class="internalDFN" id="ref-for-dom-keyformat-jwk-8"><code>jwk</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let <var>jwk</var> be a new <a data-link-type="idl" data-lt="JsonWebKey" href="#dfn-JsonWebKey" class="internalDFN" id="ref-for-dfn-JsonWebKey-9"><code>JsonWebKey</code></a>
                      dictionary.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>kty</code> attribute of <var>jwk</var> to the
                      string "<code>oct</code>".
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-k"><code>k</code></a> attribute of <var>jwk</var> to be a string
                      containing the raw octets of the key represented by <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of
                      <var>key</var>, encoded according to Section 6.4 of JSON Web Algorithms [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwa" title="JSON Web Algorithms (JWA)">JWA</a></cite>].
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyAlgorithm-length"><code>length</code></a> attribute of
                      <var>key</var> is 128:</dt>
                      <dd>Set the <code>alg</code> attribute of <var>jwk</var> to
                      the string "<code>A128OCB</code>".</dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyAlgorithm-length"><code>length</code></a> attribute of
                      <var>key</var> is 192:</dt>
                      <dd>Set the <code>alg</code> attribute of <var>jwk</var> to
                      the string "<code>A192OCB</code>".</dd>
                      <dt>If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyAlgorithm-length"><code>length</code></a> attribute of
                      <var>key</var> is 256:</dt>
                      <dd>Set the <code>alg</code> attribute of <var>jwk</var> to
                      the string "<code>A256OCB</code>".</dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the
                      <a data-link-type="attribute" href="https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages"><code>usages</code></a> attribute of
                      <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>ext</code> attribute of <var>jwk</var> to equal the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal slot
                      of <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be the result of converting <var>jwk</var>
                      to an ECMAScript Object, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                  <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="aes-ocb-operations-get-key-length"><div class="header-wrapper"><h4 id="x9-4-6-get-key-length"><bdi class="secno">9.4.6 </bdi>Get key length</h4><a class="self-link" href="#aes-ocb-operations-get-key-length" aria-label="Permalink for Section 9.4.6"></a></div>
        
        <ol>
          <li>
            <p>
              If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-AesDerivedKeyParams-length"><code>length</code></a> member of
              <var>normalizedDerivedKeyAlgorithm</var> is not 128, 192 or 256, then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Return the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dfn-AesDerivedKeyParams-length"><code>length</code></a> member of
              <var>normalizedDerivedKeyAlgorithm</var>.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>

  <section id="chacha20-poly1305"><div class="header-wrapper"><h2 id="x10-chacha20-poly1305"><bdi class="secno">10. </bdi>ChaCha20-Poly1305</h2><a class="self-link" href="#chacha20-poly1305" aria-label="Permalink for Section 10."></a></div>
    
    <section id="chacha20-poly1305-description" class="informative"><div class="header-wrapper"><h3 id="x10-1-description"><bdi class="secno">10.1 </bdi>Description</h3><a class="self-link" href="#chacha20-poly1305-description" aria-label="Permalink for Section 10.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        The "<code>ChaCha20-Poly1305</code>" algorithm identifier is used to perform
        authenticated encryption and decryption using AEAD_CHACHA20_POLY1305,
        as described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8439" title="ChaCha20 and Poly1305 for IETF Protocols">RFC8439</a></cite>].
      </p>
    </section>
    <section id="chacha20-poly1305-registration"><div class="header-wrapper"><h3 id="x10-2-registration"><bdi class="secno">10.2 </bdi>Registration</h3><a class="self-link" href="#chacha20-poly1305-registration" aria-label="Permalink for Section 10.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/webcrypto-2/#recognized-algorithm-name">recognized algorithm name</a> for
        this algorithm is "<code>ChaCha20-Poly1305</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>encrypt</td>
            <td><a data-link-type="idl" data-lt="AeadParams" href="#dfn-AeadParams" class="internalDFN" id="ref-for-dfn-AeadParams-5"><code>AeadParams</code></a></td>
            <td><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a></td>
          </tr>
          <tr>
            <td>decrypt</td>
            <td><a data-link-type="idl" data-lt="AeadParams" href="#dfn-AeadParams" class="internalDFN" id="ref-for-dfn-AeadParams-6"><code>AeadParams</code></a></td>
            <td><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a></td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td><a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
         <tr>
           <td>importKey</td>
           <td>None</td>
           <td><a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
         </tr>
         <tr>
           <td>exportKey</td>
           <td>None</td>
           <td>object</td>
         </tr>
         <tr>
           <td>get key length</td>
           <td>None</td>
           <td>Integer</td>
         </tr>
        </tbody>
      </table>
    </section>
    <section id="chacha20-poly1305-operations"><div class="header-wrapper"><h3 id="x10-3-operations"><bdi class="secno">10.3 </bdi>Operations</h3><a class="self-link" href="#chacha20-poly1305-operations" aria-label="Permalink for Section 10.3"></a></div>
      
      <section id="chacha20-poly1305-operations-encrypt"><div class="header-wrapper"><h4 id="x10-3-1-encrypt"><bdi class="secno">10.3.1 </bdi>Encrypt</h4><a class="self-link" href="#chacha20-poly1305-operations-encrypt" aria-label="Permalink for Section 10.3.1"></a></div>
        
        <ol>
          <li>
            <p>
              If the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-6"><code>iv</code></a> member of
              <var>normalizedAlgorithm</var> does not have a length of 12 bytes,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              If the <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-8"><code>tagLength</code></a> member
              of <var>normalizedAlgorithm</var> is present and is not 128,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>additionalData</var> be the <a data-link-type="idl" href="#dfn-AeadParams-additionalData" class="internalDFN" id="ref-for-dfn-AeadParams-additionalData-4"><code>additionalData</code></a> member of
              <var>normalizedAlgorithm</var> if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <p>
              Let <var>ciphertext</var> be the output that results from
              performing the AEAD_CHACHA20_POLY1305 encryption algorithm
              described in Section 2.8 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8439" title="ChaCha20 and Poly1305 for IETF Protocols">RFC8439</a></cite>], using
              the key represented by <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
              internal slot of <var>key</var> as the key input parameter,
              the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-7"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as
              the nonce input parameter,
              <var>plaintext</var> as the plaintext input parameter, and
              <var>additionalData</var> as the additional authenticated data (AAD) input parameter.
            </p>
          </li>
          <li>
            <p>
              Return <var>ciphertext</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="chacha20-poly1305-operations-decrypt"><div class="header-wrapper"><h4 id="x10-3-2-decrypt"><bdi class="secno">10.3.2 </bdi>Decrypt</h4><a class="self-link" href="#chacha20-poly1305-operations-decrypt" aria-label="Permalink for Section 10.3.2"></a></div>
        
        <ol>
          <li>
            <p>
              If the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-8"><code>iv</code></a> member of
              <var>normalizedAlgorithm</var> does not have a length of 12 bytes,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              If the <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-9"><code>tagLength</code></a> member
              of <var>normalizedAlgorithm</var> is present and is not 128,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              If <var>ciphertext</var> has a length less than 128 bits,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>additionalData</var> be the <a data-link-type="idl" href="#dfn-AeadParams-additionalData" class="internalDFN" id="ref-for-dfn-AeadParams-additionalData-5"><code>additionalData</code></a> member of
              <var>normalizedAlgorithm</var> if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <p>
              Perform the AEAD_CHACHA20_POLY1305 decryption algorithm
              described in Section 2.8 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8439" title="ChaCha20 and Poly1305 for IETF Protocols">RFC8439</a></cite>], using
              the key represented by <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
              internal slot of <var>key</var> as the key input parameter,
              the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-9"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as
              the nonce input parameter,
              <var>ciphertext</var> as the ciphertext input parameter, and
              <var>additionalData</var> as the additional authenticated data (AAD) input parameter.
            </p>
            <dl class="switch">
              <dt>If the result of the algorithm is the indication of authentication failure:</dt>
              <dd>
                <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>
              </dd>
              <dt>Otherwise:</dt>
              <dd>Let <var>plaintext</var> be the resulting plaintext.</dd>
            </dl>
          </li>
          <li>
            <p>
              Return <var>plaintext</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="chacha20-poly1305-operations-generate-key"><div class="header-wrapper"><h4 id="x10-3-3-generate-key"><bdi class="secno">10.3.3 </bdi>Generate Key</h4><a class="self-link" href="#chacha20-poly1305-operations-generate-key" aria-label="Permalink for Section 10.3.3"></a></div>
        
        <ol>
          <li>
            <p>
              If <var>usages</var> contains any entry which is not
              one of "<code>encrypt</code>", "<code>decrypt</code>",
              "<code>wrapKey</code>" or "<code>unwrapKey</code>",
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
              <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
            </p>
          </li>

          <li>
            <p>
              Generate a 256-bit key.
            </p>
          </li>
          <li>
            <p>
              If the key generation step fails,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>key</var> be a new
              <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a> object representing the
              generated key.
            </p>
          </li>
          <li>
            <p>
              Let <var>algorithm</var> be a new
              <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
              <var>algorithm</var> to "<code>ChaCha20-Poly1305</code>".
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal
              slot of <var>key</var> to <var>algorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
              slot of <var>key</var> to be <var>extractable</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
              <var>key</var> to be <var>usages</var>.
            </p>
          </li>
          <li>
            <p>
              Return <var>key</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="chacha20-poly1305-operations-import-key"><div class="header-wrapper"><h4 id="x10-3-4-import-key"><bdi class="secno">10.3.4 </bdi>Import Key</h4><a class="self-link" href="#chacha20-poly1305-operations-import-key" aria-label="Permalink for Section 10.3.4"></a></div>
        
        <ol>
          <li>
            <p>Let <var>keyData</var> be the key data to be imported.</p>
          </li>
          <li>
            <p>
              If <var>usages</var> contains an entry which is not
              one of "<code>encrypt</code>", "<code>decrypt</code>",
              "<code>wrapKey</code>" or "<code>unwrapKey</code>",
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
              <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-secret" class="internalDFN" id="ref-for-dom-keyformat-raw-secret-8"><code>raw-secret</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let <var>data</var> be <var>keyData</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the length in bits of <var>data</var> is not 256
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-jwk" class="internalDFN" id="ref-for-dom-keyformat-jwk-9"><code>jwk</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <dl class="switch">
                      <dt>If <var>keyData</var> is a <a data-link-type="idl" data-lt="JsonWebKey" href="#dfn-JsonWebKey" class="internalDFN" id="ref-for-dfn-JsonWebKey-10"><code>JsonWebKey</code></a> dictionary:</dt>
                      <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>
                      <dt>Otherwise:</dt>
                      <dd><p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">Throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</p></dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-kty" class="internalDFN" id="ref-for-dom-jsonwebkey-kty-5"><code>kty</code></a> field of <var>jwk</var> is not
                      "<code>oct</code>",
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If <var>jwk</var> does not meet the requirements of
                      Section 6.4 of JSON Web Algorithms [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwa" title="JSON Web Algorithms (JWA)">JWA</a></cite>],
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a> obtained by decoding the
                      <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-k"><code>k</code></a> field of <var>jwk</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-alg" class="internalDFN" id="ref-for-dom-jsonwebkey-alg-7"><code>alg</code></a> field of <var>jwk</var> is present, and is
                      not "<code>C20P</code>",
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If <var>usages</var> is non-empty and the <a data-link-type="idl" href="#dom-jsonwebkey-use" class="internalDFN" id="ref-for-dom-jsonwebkey-use-5"><code>use</code></a> field of <var>jwk</var> is present and is
                      not "<code>enc</code>",
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-key_ops" class="internalDFN" id="ref-for-dom-jsonwebkey-key_ops-5"><code>key_ops</code></a> field of <var>jwk</var> is present, and
                      is invalid according to the requirements of
                      JSON Web Key [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwk" title="JSON Web Key (JWK)">JWK</a></cite>] or
                      does not contain all of the specified <var>usages</var> values,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-ext" class="internalDFN" id="ref-for-dom-jsonwebkey-ext-5"><code>ext</code></a> field of <var>jwk</var> is present and
                      has the value false and <var>extractable</var> is true,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
              object representing a key with value <var>data</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>algorithm</var> be a new
              <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
              <var>algorithm</var> to "<code>ChaCha20-Poly1305</code>".
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal
              slot of <var>key</var> to <var>algorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Return <var>key</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="chacha20-poly1305-operations-export-key"><div class="header-wrapper"><h4 id="x10-3-5-export-key"><bdi class="secno">10.3.5 </bdi>Export Key</h4><a class="self-link" href="#chacha20-poly1305-operations-export-key" aria-label="Permalink for Section 10.3.5"></a></div>
        
        <ol>
          <li>
            <p>
              If the underlying cryptographic key material represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of <var>key</var>
              cannot be accessed, then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-secret" class="internalDFN" id="ref-for-dom-keyformat-raw-secret-9"><code>raw-secret</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let <var>data</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a> containing
                      the raw octets of the key represented by <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of
                      <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be <var>data</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-jwk" class="internalDFN" id="ref-for-dom-keyformat-jwk-10"><code>jwk</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let <var>jwk</var> be a new <a data-link-type="idl" data-lt="JsonWebKey" href="#dfn-JsonWebKey" class="internalDFN" id="ref-for-dfn-JsonWebKey-11"><code>JsonWebKey</code></a>
                      dictionary.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>kty</code> attribute of <var>jwk</var> to the
                      string "<code>oct</code>".
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-k"><code>k</code></a> attribute of <var>jwk</var> to be a string
                      containing the raw octets of the key represented by <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of
                      <var>key</var>, encoded according to Section 6.4 of JSON Web Algorithms [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwa" title="JSON Web Algorithms (JWA)">JWA</a></cite>].
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>alg</code> attribute of <var>jwk</var> to
                      the string "<code>C20P</code>".
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the
                      <a data-link-type="attribute" href="https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages"><code>usages</code></a> attribute of
                      <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>ext</code> attribute of <var>jwk</var> to equal the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal slot
                      of <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be the result of converting <var>jwk</var>
                      to an ECMAScript Object, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                  <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="chacha20-poly1305-operations-get-key-length"><div class="header-wrapper"><h4 id="x10-3-6-get-key-length"><bdi class="secno">10.3.6 </bdi>Get key length</h4><a class="self-link" href="#chacha20-poly1305-operations-get-key-length" aria-label="Permalink for Section 10.3.6"></a></div>
        
        <ol>
          <li>
            <p>
              Return 256.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>
  <section id="sha3"><div class="header-wrapper"><h2 id="x11-sha-3"><bdi class="secno">11. </bdi>SHA-3</h2><a class="self-link" href="#sha3" aria-label="Permalink for Section 11."></a></div>
    
    <section id="sha3-description" class="informative"><div class="header-wrapper"><h3 id="x11-1-description"><bdi class="secno">11.1 </bdi>Description</h3><a class="self-link" href="#sha3-description" aria-label="Permalink for Section 11.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        This describes the SHA-3 family of hash functions, as specified by
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-202" title="SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions">FIPS-202</a></cite>].
      </p>
    </section>
    <section id="sha3-registration"><div class="header-wrapper"><h3 id="x11-2-registration"><bdi class="secno">11.2 </bdi>Registration</h3><a class="self-link" href="#sha3-registration" aria-label="Permalink for Section 11.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/webcrypto-2/#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-sha3-256">SHA3-256</code>",
        "<code id="alg-sha3-384">SHA3-384</code>", and
        "<code id="alg-sha3-512">SHA3-512</code>" for the respective SHA-3 algorithms.
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>digest</td>
            <td>None</td>
            <td><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a></td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="sha3-operations"><div class="header-wrapper"><h3 id="x11-3-operations"><bdi class="secno">11.3 </bdi>Operations</h3><a class="self-link" href="#sha3-operations" aria-label="Permalink for Section 11.3"></a></div>
      
      <section id="sha3-operations-digest"><div class="header-wrapper"><h4 id="x11-3-1-digest"><bdi class="secno">11.3.1 </bdi>Digest</h4><a class="self-link" href="#sha3-operations-digest" aria-label="Permalink for Section 11.3.1"></a></div>
        
        <ol>
          <li>
            <dl class="switch">
              <dt>
                If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>SHA3-256</code>":
              </dt>
              <dd>
                Let <var>result</var> be the result of performing the SHA3-256 hash function
                defined in Section 6.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-202" title="SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions">FIPS-202</a></cite>] using
                <var>message</var> as the input message, <var>M</var>.
              </dd>
              <dt>
                If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>SHA3-384</code>":
              </dt>
              <dd>
                Let <var>result</var> be the result of performing the SHA3-384 hash function
                defined in Section 6.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-202" title="SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions">FIPS-202</a></cite>] using
                <var>message</var> as the input message, <var>M</var>.
              </dd>
              <dt>
                If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>SHA3-512</code>":
              </dt>
              <dd>
                Let <var>result</var> be the result of performing the SHA3-512 hash function
                defined in Section 6.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-202" title="SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions">FIPS-202</a></cite>] using
                <var>message</var> as the input message, <var>M</var>.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              If performing the operation results in an error, then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>
  <section id="cshake"><div class="header-wrapper"><h2 id="x12-cshake"><bdi class="secno">12. </bdi>cSHAKE</h2><a class="self-link" href="#cshake" aria-label="Permalink for Section 12."></a></div>
    
    <section id="cshake-description" class="informative"><div class="header-wrapper"><h3 id="x12-1-description"><bdi class="secno">12.1 </bdi>Description</h3><a class="self-link" href="#cshake-description" aria-label="Permalink for Section 12.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        This describes cSHAKE128 and cSHAKE256, as specified by
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>].
      </p>
    </section>
    <section id="cshake-registration"><div class="header-wrapper"><h3 id="x12-2-registration"><bdi class="secno">12.2 </bdi>Registration</h3><a class="self-link" href="#cshake-registration" aria-label="Permalink for Section 12.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/webcrypto-2/#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-cshake128">cSHAKE128</code>" and
        "<code id="alg-cshake256">cSHAKE256</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>digest</td>
            <td><a data-link-type="idl" data-lt="CShakeParams" href="#dfn-CShakeParams" class="internalDFN" id="ref-for-dfn-CShakeParams-1"><code>CShakeParams</code></a></td>
            <td><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a></td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="cshake-params"><div class="header-wrapper"><h3 id="x12-3-cshakeparams-dictionary"><bdi class="secno">12.3 </bdi><dfn data-idl="dictionary" id="dfn-CShakeParams" data-export="" data-dfn-type="dictionary" data-title="CShakeParams" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>CShakeParams</code></dfn> dictionary</h3><a class="self-link" href="#cshake-params" aria-label="Permalink for Section 12.3"></a></div>
      
      <pre class="idl def" id="webidl-1097481639"><span class="idlHeader"><a class="self-link" href="#webidl-1097481639">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-cshakeparams" data-title="CShakeParams">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-CShakeParams" id="ref-for-dfn-CShakeParams-2"><code>CShakeParams</code></a> : <span class="idlSuperclass"><a data-link-type="dictionary" href="https://www.w3.org/TR/webcrypto-2/#dfn-Algorithm">Algorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-cshakeparams-length" data-title="length" data-dfn-for="CShakeParams">
  required<span class="idlType"> [<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>] <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-CShakeParams-length" id="ref-for-dfn-CShakeParams-length-1"><code>length</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-cshakeparams-functionname" data-title="functionName" data-dfn-for="CShakeParams"><span class="idlType">
  <a data-link-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-CShakeParams-functionName" id="ref-for-dfn-CShakeParams-functionName-1"><code>functionName</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-cshakeparams-customization" data-title="customization" data-dfn-for="CShakeParams"><span class="idlType">
  <a data-link-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-CShakeParams-customization" id="ref-for-dfn-CShakeParams-customization-1"><code>customization</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-dfn-for="CShakeParams" id="dfn-CShakeParams-length" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="length" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>length</code></dfn> member represents the requested output length in bits.</p>
      <p>The <dfn data-dfn-for="CShakeParams" id="dfn-CShakeParams-functionName" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="functionName" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>functionName</code></dfn> member represents the function name, used by NIST to define functions based on cSHAKE. When used, it should only be set to values defined by NIST.</p>
      <p>The <dfn data-dfn-for="CShakeParams" id="dfn-CShakeParams-customization" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="customization" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>customization</code></dfn> member represents the customization string. The application selects this string to define a variant of the function.</p>
    </section>
    <section id="cshake-operations"><div class="header-wrapper"><h3 id="x12-4-operations"><bdi class="secno">12.4 </bdi>Operations</h3><a class="self-link" href="#cshake-operations" aria-label="Permalink for Section 12.4"></a></div>
      
      <section id="cshake-operations-digest"><div class="header-wrapper"><h4 id="x12-4-1-digest"><bdi class="secno">12.4.1 </bdi>Digest</h4><a class="self-link" href="#cshake-operations-digest" aria-label="Permalink for Section 12.4.1"></a></div>
        
        <ol>
          <li>
            <p>
              Let <var>length</var> be the <a data-link-type="idl" href="#dfn-CShakeParams-length" class="internalDFN" id="ref-for-dfn-CShakeParams-length-2"><code>length</code></a> member of
              <var>normalizedAlgorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>functionName</var> be the <a data-link-type="idl" href="#dfn-CShakeParams-functionName" class="internalDFN" id="ref-for-dfn-CShakeParams-functionName-2"><code>functionName</code></a> member of
              <var>normalizedAlgorithm</var> if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <p>
              Let <var>customization</var> be the <a data-link-type="idl" href="#dfn-CShakeParams-customization" class="internalDFN" id="ref-for-dfn-CShakeParams-customization-2"><code>customization</code></a> member of
              <var>normalizedAlgorithm</var> if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>
                If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>cSHAKE128</code>":
              </dt>
              <dd>
                Let <var>result</var> be the result of performing the cSHAKE128 function
                defined in Section 3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>] using
                <var>message</var> as the <var>X</var> input parameter,
                <var>length</var> as the <var>L</var> input parameter,
                <var>functionName</var> as the <var>N</var> input parameter, and
                <var>customization</var> as the <var>S</var> input parameter.
              </dd>
              <dt>
                If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>cSHAKE256</code>":
              </dt>
              <dd>
                Let <var>result</var> be the result of performing the cSHAKE256 function
                defined in Section 3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>] using
                <var>message</var> as the <var>X</var> input parameter,
                <var>length</var> as the <var>L</var> input parameter,
                <var>functionName</var> as the <var>N</var> input parameter, and
                <var>customization</var> as the <var>S</var> input parameter.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              If performing the operation results in an error, then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>
  <section id="kmac"><div class="header-wrapper"><h2 id="x13-kmac"><bdi class="secno">13. </bdi>KMAC</h2><a class="self-link" href="#kmac" aria-label="Permalink for Section 13."></a></div>
    
    <section id="kmac-description" class="informative"><div class="header-wrapper"><h3 id="x13-1-description"><bdi class="secno">13.1 </bdi>Description</h3><a class="self-link" href="#kmac-description" aria-label="Permalink for Section 13.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        This describes KMAC128 and KMAC256, as specified by
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>].
      </p>
    </section>
    <section id="kmac-registration"><div class="header-wrapper"><h3 id="x13-2-registration"><bdi class="secno">13.2 </bdi>Registration</h3><a class="self-link" href="#kmac-registration" aria-label="Permalink for Section 13.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/webcrypto-2/#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-kmac128">KMAC128</code>" and
        "<code id="alg-kmac256">KMAC256</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>sign</td>
            <td><a data-link-type="idl" data-lt="KmacParams" href="#dfn-KmacParams" class="internalDFN" id="ref-for-dfn-KmacParams-1"><code>KmacParams</code></a></td>
            <td><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a></td>
          </tr>
          <tr>
            <td>verify</td>
            <td><a data-link-type="idl" data-lt="KmacParams" href="#dfn-KmacParams" class="internalDFN" id="ref-for-dfn-KmacParams-2"><code>KmacParams</code></a></td>
            <td>boolean</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td><a data-link-type="idl" data-lt="KmacKeyGenParams" href="#dfn-KmacKeyGenParams" class="internalDFN" id="ref-for-dfn-KmacKeyGenParams-1"><code>KmacKeyGenParams</code></a></td>
            <td><a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
          <tr>
            <td>importKey</td>
            <td><a data-link-type="idl" data-lt="KmacImportParams" href="#dfn-KmacImportParams" class="internalDFN" id="ref-for-dfn-KmacImportParams-1"><code>KmacImportParams</code></a></td>
            <td><a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
          <tr>
            <td>get key length</td>
            <td><a data-link-type="idl" data-lt="KmacImportParams" href="#dfn-KmacImportParams" class="internalDFN" id="ref-for-dfn-KmacImportParams-2"><code>KmacImportParams</code></a></td>
            <td>Integer</td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="kmac-keygen-params"><div class="header-wrapper"><h3 id="x13-3-kmackeygenparams-dictionary"><bdi class="secno">13.3 </bdi><dfn data-idl="dictionary" id="dfn-KmacKeyGenParams" data-export="" data-dfn-type="dictionary" data-title="KmacKeyGenParams" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>KmacKeyGenParams</code></dfn> dictionary</h3><a class="self-link" href="#kmac-keygen-params" aria-label="Permalink for Section 13.3"></a></div>
      
      <pre class="idl def" id="webidl-1224700284"><span class="idlHeader"><a class="self-link" href="#webidl-1224700284">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-kmackeygenparams" data-title="KmacKeyGenParams">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-KmacKeyGenParams" id="ref-for-dfn-KmacKeyGenParams-2"><code>KmacKeyGenParams</code></a> : <span class="idlSuperclass"><a data-link-type="dictionary" href="https://www.w3.org/TR/webcrypto-2/#dfn-Algorithm">Algorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-kmackeygenparams-length" data-title="length" data-dfn-for="KmacKeyGenParams">
  [<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>]<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-KmacKeyGenParams-length" id="ref-for-dfn-KmacKeyGenParams-length-1"><code>length</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-dfn-for="KmacKeyGenParams" id="dfn-KmacKeyGenParams-length" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="length" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>length</code></dfn> member represents the length (in bits) of the key to generate. If unspecified, the recommended length will be used, which is 128 for KMAC128 and 256 for KMAC256.</p>
    </section>
    <section id="kmac-importparams"><div class="header-wrapper"><h3 id="x13-4-kmacimportparams-dictionary"><bdi class="secno">13.4 </bdi><dfn data-idl="dictionary" id="dfn-KmacImportParams" data-export="" data-dfn-type="dictionary" data-title="KmacImportParams" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>KmacImportParams</code></dfn> dictionary</h3><a class="self-link" href="#kmac-importparams" aria-label="Permalink for Section 13.4"></a></div>
      
      <pre class="idl def" id="webidl-745655368"><span class="idlHeader"><a class="self-link" href="#webidl-745655368">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-kmacimportparams" data-title="KmacImportParams">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-KmacImportParams" id="ref-for-dfn-KmacImportParams-3"><code>KmacImportParams</code></a> : <span class="idlSuperclass"><a data-link-type="dictionary" href="https://www.w3.org/TR/webcrypto-2/#dfn-Algorithm">Algorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-kmacimportparams-length" data-title="length" data-dfn-for="KmacImportParams">
  [<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>]<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-KmacImportParams-length" id="ref-for-dfn-KmacImportParams-length-1"><code>length</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-dfn-for="KmacImportParams" id="dfn-KmacImportParams-length" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="length" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>length</code></dfn> member represents the length (in bits) of the key.</p>
    </section>
    <section id="KmacKeyAlgorithm-dictionary"><div class="header-wrapper"><h3 id="x13-5-kmackeyalgorithm-dictionary"><bdi class="secno">13.5 </bdi><dfn data-idl="dictionary" id="dfn-KmacKeyAlgorithm" data-export="" data-dfn-type="dictionary" data-title="KmacKeyAlgorithm" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>KmacKeyAlgorithm</code></dfn> dictionary</h3><a class="self-link" href="#KmacKeyAlgorithm-dictionary" aria-label="Permalink for Section 13.5"></a></div>
      
      <pre class="idl def" id="webidl-28722634"><span class="idlHeader"><a class="self-link" href="#webidl-28722634">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-kmackeyalgorithm" data-title="KmacKeyAlgorithm">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-KmacKeyAlgorithm" id="ref-for-dfn-KmacKeyAlgorithm-1"><code>KmacKeyAlgorithm</code></a> : <span class="idlSuperclass"><a data-link-type="dictionary" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm">KeyAlgorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-kmackeyalgorithm-length" data-title="length" data-dfn-for="KmacKeyAlgorithm">
  required<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-KmacKeyAlgorithm-length" id="ref-for-dfn-KmacKeyAlgorithm-length-1"><code>length</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-dfn-for="KmacKeyAlgorithm" id="dfn-KmacKeyAlgorithm-length" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="length" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>length</code></dfn> member represents the length (in bits) of the key.</p>
    </section>
    <section id="kmac-params"><div class="header-wrapper"><h3 id="x13-6-kmacparams-dictionary"><bdi class="secno">13.6 </bdi><dfn data-idl="dictionary" id="dfn-KmacParams" data-export="" data-dfn-type="dictionary" data-title="KmacParams" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>KmacParams</code></dfn> dictionary</h3><a class="self-link" href="#kmac-params" aria-label="Permalink for Section 13.6"></a></div>
      
      <pre class="idl def" id="webidl-1848208597"><span class="idlHeader"><a class="self-link" href="#webidl-1848208597">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-kmacparams" data-title="KmacParams">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-KmacParams" id="ref-for-dfn-KmacParams-3"><code>KmacParams</code></a> : <span class="idlSuperclass"><a data-link-type="dictionary" href="https://www.w3.org/TR/webcrypto-2/#dfn-Algorithm">Algorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-kmacparams-length" data-title="length" data-dfn-for="KmacParams">
  required<span class="idlType"> [<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>] <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-KmacParams-length" id="ref-for-dfn-KmacParams-length-1"><code>length</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-kmacparams-customization" data-title="customization" data-dfn-for="KmacParams"><span class="idlType">
  <a data-link-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-KmacParams-customization" id="ref-for-dfn-KmacParams-customization-1"><code>customization</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-dfn-for="KmacParams" id="dfn-KmacParams-length" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="length" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>length</code></dfn> member represents the requested output length in bits.</p>
      <p>The <dfn data-dfn-for="KmacParams" id="dfn-KmacParams-customization" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="customization" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>customization</code></dfn> member represents the customization string. The application selects this string to define a variant of the function.</p>
    </section>

    <section id="kmac-operations"><div class="header-wrapper"><h3 id="x13-7-operations"><bdi class="secno">13.7 </bdi>Operations</h3><a class="self-link" href="#kmac-operations" aria-label="Permalink for Section 13.7"></a></div>
      
      <section id="kmac-operations-sign"><div class="header-wrapper"><h4 id="x13-7-1-sign"><bdi class="secno">13.7.1 </bdi>Sign</h4><a class="self-link" href="#kmac-operations-sign" aria-label="Permalink for Section 13.7.1"></a></div>
        
        <ol>
          <li>
            <p>
              Let <var>customization</var> be the <a data-link-type="idl" href="#dfn-KmacParams-customization" class="internalDFN" id="ref-for-dfn-KmacParams-customization-2"><code>customization</code></a> member of
              <var>normalizedAlgorithm</var> if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>
                If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>KMAC128</code>":
              </dt>
              <dd>
                Let <var>mac</var> be the result of performing the KMAC128 function
                defined in Section 4 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>] using
                the key represented by <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                internal slot of <var>key</var> as the <var>K</var> input parameter,
                <var>message</var> as the <var>X</var> input parameter,
                the <a data-link-type="idl" href="#dfn-KmacParams-length" class="internalDFN" id="ref-for-dfn-KmacParams-length-2"><code>length</code></a> member of <var>normalizedAlgorithm</var> as
                the <var>L</var> input parameter, and
                <var>customization</var> as
                the <var>S</var> input parameter.
              </dd>
              <dt>
                If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>KMAC256</code>":
              </dt>
              <dd>
                Let <var>mac</var> be the result of performing the KMAC256 function
                defined in Section 4 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>] using
                the key represented by <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                internal slot of <var>key</var> as the <var>K</var> input parameter,
                <var>message</var> as the <var>X</var> input parameter,
                the <a data-link-type="idl" href="#dfn-KmacParams-length" class="internalDFN" id="ref-for-dfn-KmacParams-length-3"><code>length</code></a> member of <var>normalizedAlgorithm</var> as
                the <var>L</var> input parameter, and
                <var>customization</var> as
                the <var>S</var> input parameter.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return <var>mac</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="kmac-operations-verify"><div class="header-wrapper"><h4 id="x13-7-2-verify"><bdi class="secno">13.7.2 </bdi>Verify</h4><a class="self-link" href="#kmac-operations-verify" aria-label="Permalink for Section 13.7.2"></a></div>
        
        <ol>
          <li>
            <p>
              Let <var>customization</var> be the <a data-link-type="idl" href="#dfn-KmacParams-customization" class="internalDFN" id="ref-for-dfn-KmacParams-customization-3"><code>customization</code></a> member of
              <var>normalizedAlgorithm</var> if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>
                If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>KMAC128</code>":
              </dt>
              <dd>
                Let <var>mac</var> be the result of performing the KMAC128 function
                defined in Section 4 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>] using
                the key represented by <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                internal slot of <var>key</var> as the <var>K</var> input parameter,
                <var>message</var> as the <var>X</var> input parameter,
                the <a data-link-type="idl" href="#dfn-KmacParams-length" class="internalDFN" id="ref-for-dfn-KmacParams-length-4"><code>length</code></a> member of <var>normalizedAlgorithm</var> as
                the <var>L</var> input parameter, and
                <var>customization</var> as
                the <var>S</var> input parameter.
              </dd>
              <dt>
                If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>KMAC256</code>":
              </dt>
              <dd>
                Let <var>mac</var> be the result of performing the KMAC256 function
                defined in Section 4 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>] using
                the key represented by <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a>
                internal slot of <var>key</var> as the <var>K</var> input parameter,
                <var>message</var> as the <var>X</var> input parameter,
                the <a data-link-type="idl" href="#dfn-KmacParams-length" class="internalDFN" id="ref-for-dfn-KmacParams-length-5"><code>length</code></a> member of <var>normalizedAlgorithm</var> as
                the <var>L</var> input parameter, and
                <var>customization</var> as
                the <var>S</var> input parameter.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return true if <var>mac</var> is equal to <var>signature</var> and false
              otherwise.
            </p>
          </li>
        </ol>
      </section>
      <section id="kmac-operations-generate-key"><div class="header-wrapper"><h4 id="x13-7-3-generate-key"><bdi class="secno">13.7.3 </bdi>Generate Key</h4><a class="self-link" href="#kmac-operations-generate-key" aria-label="Permalink for Section 13.7.3"></a></div>
        
        <ol>
          <li>
            <p>
              If <var>usages</var> contains any entry which is not "<code>sign</code>" or
              "<code>verify</code>", then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>
                If the <a data-link-type="idl" href="#dfn-KmacKeyGenParams-length" class="internalDFN" id="ref-for-dfn-KmacKeyGenParams-length-2"><code>length</code></a> member of
                <var>normalizedAlgorithm</var> is present:
              </dt>
              <dd>
                Let <var>length</var> be equal to the
                <a data-link-type="idl" href="#dfn-KmacKeyGenParams-length" class="internalDFN" id="ref-for-dfn-KmacKeyGenParams-length-3"><code>length</code></a>
                member of <var>normalizedAlgorithm</var>.
              </dd>
              <dt>
                Otherwise, if the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>KMAC128</code>":
              </dt>
              <dd>
                Let <var>length</var> be 128.
              </dd>
              <dt>
                Otherwise, if the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>KMAC256</code>":
              </dt>
              <dd>
                Let <var>length</var> be 256.
              </dd>
            </dl>
          </li>

          <li>
            <p>
              Generate a key of length <var>length</var> bits.
            </p>
          </li>
          <li>
            <p>
              If the key generation step fails,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>key</var> be a new
              <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a> object representing the
              generated key.
            </p>
          </li>
          <li>
            <p>
              Let <var>algorithm</var> be a new
              <a data-link-type="idl" data-lt="KmacKeyAlgorithm" href="#dfn-KmacKeyAlgorithm" class="internalDFN" id="ref-for-dfn-KmacKeyAlgorithm-2"><code>KmacKeyAlgorithm</code></a>.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
              <var>algorithm</var> to "<code>KMAC</code>".
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal
              slot of <var>key</var> to <var>algorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal
              slot of <var>key</var> to be <var>extractable</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages"><code>[[usages]]</code></a> internal slot of
              <var>key</var> to be <var>usages</var>.
            </p>
          </li>
          <li>
            <p>
              Return <var>key</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="kmac-operations-import-key"><div class="header-wrapper"><h4 id="x13-7-4-import-key"><bdi class="secno">13.7.4 </bdi>Import Key</h4><a class="self-link" href="#kmac-operations-import-key" aria-label="Permalink for Section 13.7.4"></a></div>
        
        <ol>
          <li>
            <p>Let <var>keyData</var> be the key data to be imported.</p>
          </li>
          <li>
            <p>
              If <var>usages</var> contains an entry which is not
              "<code>sign</code>" or "<code>verify</code>",
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
              <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-secret" class="internalDFN" id="ref-for-dom-keyformat-raw-secret-10"><code>raw-secret</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let <var>data</var> be <var>keyData</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-jwk" class="internalDFN" id="ref-for-dom-keyformat-jwk-11"><code>jwk</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <dl class="switch">
                      <dt>If <var>keyData</var> is a <a data-link-type="idl" data-lt="JsonWebKey" href="#dfn-JsonWebKey" class="internalDFN" id="ref-for-dfn-JsonWebKey-12"><code>JsonWebKey</code></a> dictionary:</dt>
                      <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>
                      <dt>Otherwise:</dt>
                      <dd><p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">Throw</a> a <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</p></dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-kty" class="internalDFN" id="ref-for-dom-jsonwebkey-kty-6"><code>kty</code></a> field of <var>jwk</var> is not
                      "<code>oct</code>",
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If <var>jwk</var> does not meet the requirements of
                      Section 6.4 of JSON Web Algorithms [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwa" title="JSON Web Algorithms (JWA)">JWA</a></cite>],
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>data</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a> obtained by decoding the
                      <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-k"><code>k</code></a> field of <var>jwk</var>.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>
                        If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                        <var>normalizedAlgorithm</var> is a case-sensitive string match for
                        "<code>KMAC128</code>":
                      </dt>
                      <dd>
                        If the <a data-link-type="idl" href="#dom-jsonwebkey-alg" class="internalDFN" id="ref-for-dom-jsonwebkey-alg-8"><code>alg</code></a> field of <var>jwk</var> is present
                        and is not "<code>K128</code>",
                        then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </dd>
                      <dt>
                        If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                        <var>normalizedAlgorithm</var> is a case-sensitive string match for
                        "<code>KMAC256</code>":
                      </dt>
                      <dd>
                        If the <a data-link-type="idl" href="#dom-jsonwebkey-alg" class="internalDFN" id="ref-for-dom-jsonwebkey-alg-9"><code>alg</code></a> field of <var>jwk</var> is present
                        and is not "<code>K256</code>",
                        then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If <var>usages</var> is non-empty and the <a data-link-type="idl" href="#dom-jsonwebkey-use" class="internalDFN" id="ref-for-dom-jsonwebkey-use-6"><code>use</code></a> field of <var>jwk</var> is present and is
                      not "<code>sign</code>",
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-key_ops" class="internalDFN" id="ref-for-dom-jsonwebkey-key_ops-6"><code>key_ops</code></a> field of <var>jwk</var> is present, and
                      is invalid according to the requirements of
                      JSON Web Key [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwk" title="JSON Web Key (JWK)">JWK</a></cite>] or
                      does not contain all of the specified <var>usages</var> values,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-jsonwebkey-ext" class="internalDFN" id="ref-for-dom-jsonwebkey-ext-6"><code>ext</code></a> field of <var>jwk</var> is present and
                      has the value false and <var>extractable</var> is true,
                      then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Let <var>length</var> be the length in bits of <var>data</var>.
            </p>
          </li>
          <li>
            <p>
              If <var>length</var> is zero
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
              <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>
                If the <a data-link-type="idl" href="#dfn-KmacImportParams-length" class="internalDFN" id="ref-for-dfn-KmacImportParams-length-2"><code>length</code></a> member of
                <var>normalizedAlgorithm</var> is present:
              </dt>
              <dd>
                <dl class="switch">
                  <dt>
                    If the <a data-link-type="idl" href="#dfn-KmacImportParams-length" class="internalDFN" id="ref-for-dfn-KmacImportParams-length-3"><code>length</code></a> member of
                    <var>normalizedAlgorithm</var> is greater than <var>length</var>:
                  </dt>
                  <dd>
                    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                    <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                  </dd>
                  <dt>
                    If the <a data-link-type="idl" href="#dfn-KmacImportParams-length" class="internalDFN" id="ref-for-dfn-KmacImportParams-length-4"><code>length</code></a> member of
                    <var>normalizedAlgorithm</var>, is less than or equal to
                    <var>length</var> minus eight:
                  </dt>
                  <dd>
                    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                    <a data-link-type="exception" data-lt="DataError" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                  </dd>
                  <dt>
                    Otherwise:
                  </dt>
                  <dd>
                    Set <var>length</var> equal to the <a data-link-type="idl" href="#dfn-KmacImportParams-length" class="internalDFN" id="ref-for-dfn-KmacImportParams-length-5"><code>length</code></a>
                    member of <var>normalizedAlgorithm</var>.
                  </dd>
                </dl>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
              object representing an KMAC key with the first <var>length</var>
              bits of <var>data</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>algorithm</var> be a new
              <a data-link-type="idl" data-lt="KmacKeyAlgorithm" href="#dfn-KmacKeyAlgorithm" class="internalDFN" id="ref-for-dfn-KmacKeyAlgorithm-3"><code>KmacKeyAlgorithm</code></a>.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
              <var>algorithm</var> to "<code>KMAC</code>".
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="idl" href="#dfn-KmacKeyAlgorithm-length" class="internalDFN" id="ref-for-dfn-KmacKeyAlgorithm-length-2"><code>length</code></a> attribute of
              <var>algorithm</var> to <var>length</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal
              slot of <var>key</var> to <var>algorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Return <var>key</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="kmac-operations-export-key"><div class="header-wrapper"><h4 id="x13-7-5-export-key"><bdi class="secno">13.7.5 </bdi>Export Key</h4><a class="self-link" href="#kmac-operations-export-key" aria-label="Permalink for Section 13.7.5"></a></div>
        
        <ol>
          <li>
            <p>
              If the underlying cryptographic key material represented by the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of <var>key</var>
              cannot be accessed, then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>bits</var> be the raw bits of the key represented by <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of
              <var>key</var>.
            </p>
          </li>
          <li>
            <p>
              Let <var>data</var> be an <a href="https://www.w3.org/TR/webcrypto-2/#byte-sequence-containing">byte sequence containing</a> <var>bits</var>.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-raw-secret" class="internalDFN" id="ref-for-dom-keyformat-raw-secret-11"><code>raw-secret</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let <var>result</var> be <var>data</var>.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If <var>format</var> is "<a data-link-type="idl" href="#dom-keyformat-jwk" class="internalDFN" id="ref-for-dom-keyformat-jwk-12"><code>jwk</code></a>":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let <var>jwk</var> be a new <a data-link-type="idl" data-lt="JsonWebKey" href="#dfn-JsonWebKey" class="internalDFN" id="ref-for-dfn-JsonWebKey-13"><code>JsonWebKey</code></a>
                      dictionary.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>kty</code> attribute of <var>jwk</var> to the
                      string "<code>oct</code>".
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-k"><code>k</code></a> attribute of <var>jwk</var> to be a string
                      containing <var>data</var>, encoded according to Section 6.4 of JSON Web Algorithms [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwa" title="JSON Web Algorithms (JWA)">JWA</a></cite>].
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>algorithm</var> be the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal slot of
                      <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>
                        If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                        <var>normalizedAlgorithm</var> is a case-sensitive string match for
                        "<code>KMAC128</code>":
                      </dt>
                      <dd>Set the <code>alg</code> attribute of <var>jwk</var> to
                        the string "<code>K128</code>".</dd>
                      <dt>
                        If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                        <var>normalizedAlgorithm</var> is a case-sensitive string match for
                        "<code>KMAC256</code>":
                      </dt>
                      <dd>Set the <code>alg</code> attribute of <var>jwk</var> to
                        the string "<code>K256</code>".</dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the
                      <a data-link-type="attribute" href="https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages"><code>usages</code></a> attribute of <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <code>ext</code> attribute of <var>jwk</var> to equal the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal slot
                      of <var>key</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>result</var> be the result of converting <var>jwk</var>
                      to an ECMAScript Object, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                  <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="kmac-operations-get-key-length"><div class="header-wrapper"><h4 id="x13-7-6-get-key-length"><bdi class="secno">13.7.6 </bdi>Get key length</h4><a class="self-link" href="#kmac-operations-get-key-length" aria-label="Permalink for Section 13.7.6"></a></div>
        
        <ol>
          <li>
            <dl class="switch">
              <dt>
                If the <a data-link-type="idl" href="#dfn-KmacImportParams-length" class="internalDFN" id="ref-for-dfn-KmacImportParams-length-6"><code>length</code></a> member of
                <var>normalizedAlgorithm</var> is present:
              </dt>
              <dd>
                Let <var>length</var> be equal to the
                <a data-link-type="idl" href="#dfn-KmacImportParams-length" class="internalDFN" id="ref-for-dfn-KmacImportParams-length-7"><code>length</code></a>
                member of <var>normalizedAlgorithm</var>.
              </dd>
              <dt>
                Otherwise, if the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>KMAC128</code>":
              </dt>
              <dd>
                Let <var>length</var> be 128.
              </dd>
              <dt>
                Otherwise, if the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>KMAC256</code>":
              </dt>
              <dd>
                Let <var>length</var> be 256.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return <var>length</var>.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>
  <section id="argon2"><div class="header-wrapper"><h2 id="x14-argon2"><bdi class="secno">14. </bdi>Argon2</h2><a class="self-link" href="#argon2" aria-label="Permalink for Section 14."></a></div>
    
    <section id="argon2-description" class="informative"><div class="header-wrapper"><h3 id="x14-1-description"><bdi class="secno">14.1 </bdi>Description</h3><a class="self-link" href="#argon2-description" aria-label="Permalink for Section 14.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        This describes the Argon2 function for password hashing and key derivation,
        as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9106" title="Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications">RFC9106</a></cite>].
      </p>
    </section>
    <section id="argon2-registration"><div class="header-wrapper"><h3 id="x14-2-registration"><bdi class="secno">14.2 </bdi>Registration</h3><a class="self-link" href="#argon2-registration" aria-label="Permalink for Section 14.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/webcrypto-2/#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-argon2d">Argon2d</code>",
        "<code id="alg-argon2i">Argon2i</code>", and
        "<code id="alg-argon2id">Argon2id</code>" for the respective Argon2 types.
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/webcrypto-2/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>deriveBits</td>
            <td><a data-link-type="idl" data-lt="Argon2Params" href="#dfn-Argon2Params" class="internalDFN" id="ref-for-dfn-Argon2Params-1"><code>Argon2Params</code></a></td>
            <td><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a></td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td><a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
          <tr>
            <td>Get key length</td>
            <td>None</td>
            <td>null</td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="argon2-params"><div class="header-wrapper"><h3 id="x14-3-argon2params-dictionary"><bdi class="secno">14.3 </bdi><dfn data-idl="dictionary" id="dfn-Argon2Params" data-export="" data-dfn-type="dictionary" data-title="Argon2Params" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>Argon2Params</code></dfn> dictionary</h3><a class="self-link" href="#argon2-params" aria-label="Permalink for Section 14.3"></a></div>
      
      <pre class="idl def" id="webidl-1006558199"><span class="idlHeader"><a class="self-link" href="#webidl-1006558199">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-argon2params" data-title="Argon2Params">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-Argon2Params" id="ref-for-dfn-Argon2Params-2"><code>Argon2Params</code></a> : <span class="idlSuperclass"><a data-link-type="dictionary" href="https://www.w3.org/TR/webcrypto-2/#dfn-Algorithm">Algorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-argon2params-nonce" data-title="nonce" data-dfn-for="Argon2Params">
  required<span class="idlType"> <a data-link-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-Argon2Params-nonce" id="ref-for-dfn-Argon2Params-nonce-1"><code>nonce</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-argon2params-parallelism" data-title="parallelism" data-dfn-for="Argon2Params">
  required<span class="idlType"> [<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>] <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-Argon2Params-parallelism" id="ref-for-dfn-Argon2Params-parallelism-1"><code>parallelism</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-argon2params-memory" data-title="memory" data-dfn-for="Argon2Params">
  required<span class="idlType"> [<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>] <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-Argon2Params-memory" id="ref-for-dfn-Argon2Params-memory-1"><code>memory</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-argon2params-passes" data-title="passes" data-dfn-for="Argon2Params">
  required<span class="idlType"> [<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>] <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-Argon2Params-passes" id="ref-for-dfn-Argon2Params-passes-1"><code>passes</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-argon2params-version" data-title="version" data-dfn-for="Argon2Params">
  [<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>]<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-octet">octet</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-Argon2Params-version" id="ref-for-dfn-Argon2Params-version-1"><code>version</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-argon2params-secretvalue" data-title="secretValue" data-dfn-for="Argon2Params"><span class="idlType">
  <a data-link-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-Argon2Params-secretValue" id="ref-for-dfn-Argon2Params-secretValue-1"><code>secretValue</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-argon2params-associateddata" data-title="associatedData" data-dfn-for="Argon2Params"><span class="idlType">
  <a data-link-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-Argon2Params-associatedData" id="ref-for-dfn-Argon2Params-associatedData-1"><code>associatedData</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-dfn-for="Argon2Params" id="dfn-Argon2Params-nonce" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="nonce" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>nonce</code></dfn> member represents the nonce, which is a salt for password hashing applications.</p>
      <p>The <dfn data-dfn-for="Argon2Params" id="dfn-Argon2Params-parallelism" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="parallelism" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>parallelism</code></dfn> member represents the degree of parallelism.</p>
      <p>The <dfn data-dfn-for="Argon2Params" id="dfn-Argon2Params-memory" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="memory" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>memory</code></dfn> member represents the memory size in kibibytes. It must be at least 8 times the degree of parallelism.</p>
      <p>The <dfn data-dfn-for="Argon2Params" id="dfn-Argon2Params-passes" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="passes" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>passes</code></dfn> member represents the number of passes.</p>
      <p>The <dfn data-dfn-for="Argon2Params" id="dfn-Argon2Params-version" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="version" data-type="octet" tabindex="0" aria-haspopup="dialog"><code>version</code></dfn> member represents the version number. The default and currently only defined version is 19 (0x13).</p>
      <p>The <dfn data-dfn-for="Argon2Params" id="dfn-Argon2Params-secretValue" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="secretValue" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>secretValue</code></dfn> member represents the optional secret value.</p>
      <p>The <dfn data-dfn-for="Argon2Params" id="dfn-Argon2Params-associatedData" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="associatedData" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>associatedData</code></dfn> member represents the optional associated data.</p>
      <div class="note" role="note" id="issue-container-generatedID-7"><div role="heading" class="note-title marker" id="h-note-7" aria-level="4"><span>Note</span></div><p class="">
        For the recommended values of the parameters, see section 4 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9106" title="Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications">RFC9106</a></cite>].
      </p></div>
    </section>
    <section id="argon2-operations"><div class="header-wrapper"><h3 id="x14-4-operations"><bdi class="secno">14.4 </bdi>Operations</h3><a class="self-link" href="#argon2-operations" aria-label="Permalink for Section 14.4"></a></div>
      
      <section id="argon2-operations-derive-bits"><div class="header-wrapper"><h4 id="x14-4-1-derive-bits"><bdi class="secno">14.4.1 </bdi>Derive Bits</h4><a class="self-link" href="#argon2-operations-derive-bits" aria-label="Permalink for Section 14.4.1"></a></div>
        
        <ol>
          <li>
            <p>
              If <var>length</var> is null, or is less than 32 (4*8), then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              If the <a data-link-type="idl" href="#dfn-Argon2Params-version" class="internalDFN" id="ref-for-dfn-Argon2Params-version-2"><code>version</code></a> member
              of <var>normalizedAlgorithm</var> is present and is not 19 (0x13),
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              If the <a data-link-type="idl" href="#dfn-Argon2Params-parallelism" class="internalDFN" id="ref-for-dfn-Argon2Params-parallelism-2"><code>parallelism</code></a> member of <var>normalizedAlgorithm</var> is zero,
              or greater than 16777215 (2^24-1),
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              If the <a data-link-type="idl" href="#dfn-Argon2Params-memory" class="internalDFN" id="ref-for-dfn-Argon2Params-memory-2"><code>memory</code></a> member of <var>normalizedAlgorithm</var> is less than
              8 times the <a data-link-type="idl" href="#dfn-Argon2Params-parallelism" class="internalDFN" id="ref-for-dfn-Argon2Params-parallelism-3"><code>parallelism</code></a> member of <var>normalizedAlgorithm</var>,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              If the <a data-link-type="idl" href="#dfn-Argon2Params-passes" class="internalDFN" id="ref-for-dfn-Argon2Params-passes-2"><code>passes</code></a> member of <var>normalizedAlgorithm</var> is zero,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>
                If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>Argon2d</code>":
              </dt>
              <dd>
                Let <var>type</var> be 0.
              </dd>
              <dt>
                If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>Argon2i</code>":
              </dt>
              <dd>
                Let <var>type</var> be 1.
              </dd>
              <dt>
                If the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var> is a case-sensitive string match for
                "<code>Argon2id</code>":
              </dt>
              <dd>
                Let <var>type</var> be 2.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Let <var>secretValue</var> be the <a data-link-type="idl" href="#dfn-Argon2Params-secretValue" class="internalDFN" id="ref-for-dfn-Argon2Params-secretValue-2"><code>secretValue</code></a> member of
              <var>normalizedAlgorithm</var>, if present.
            </p>
          </li>
          <li>
            <p>
              Let <var>associatedData</var> be the <a data-link-type="idl" href="#dfn-Argon2Params-associatedData" class="internalDFN" id="ref-for-dfn-Argon2Params-associatedData-2"><code>associatedData</code></a> member of
              <var>normalizedAlgorithm</var>, if present.
            </p>
          </li>
          <li>
            <p>
              Let <var>result</var> be the result of performing the Argon2 function defined
              in Section 3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9106" title="Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications">RFC9106</a></cite>] using
              the password represented by <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle"><code>[[handle]]</code></a> internal slot of <var>key</var>
              as the message, <var>P</var>,
              the <a data-link-type="idl" href="#dfn-Argon2Params-nonce" class="internalDFN" id="ref-for-dfn-Argon2Params-nonce-2"><code>nonce</code></a> attribute of
              <var>normalizedAlgorithm</var> as the nonce, <var>S</var>,
              the value of the <a data-link-type="idl" href="#dfn-Argon2Params-parallelism" class="internalDFN" id="ref-for-dfn-Argon2Params-parallelism-4"><code>parallelism</code></a> attribute
              of <var>normalizedAlgorithm</var> as the degree of parallelism, <var>p</var>,
              the value of the <a data-link-type="idl" href="#dfn-Argon2Params-memory" class="internalDFN" id="ref-for-dfn-Argon2Params-memory-3"><code>memory</code></a> attribute
              of <var>normalizedAlgorithm</var> as the memory size, <var>m</var>,
              the value of the <a data-link-type="idl" href="#dfn-Argon2Params-passes" class="internalDFN" id="ref-for-dfn-Argon2Params-passes-3"><code>passes</code></a> attribute
              of <var>normalizedAlgorithm</var> as the number of passes, <var>t</var>,
              0x13 as the version number, <var>v</var>,
              <var>secretValue</var> (if present) as the secret value, <var>K</var>,
              <var>associatedData</var> (if present) as the associated data, <var>X</var>,
              <var>type</var> as the type, <var>y</var>, and
              <var>length</var> divided by 8 as the tag length, <var>T</var>.
            </p>
          </li>
          <li>
            <p>
              If the key derivation operation fails,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
              <a data-link-type="exception" data-lt="OperationError" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Return <var>result</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="argon2-operations-import-key"><div class="header-wrapper"><h4 id="x14-4-2-import-key"><bdi class="secno">14.4.2 </bdi>Import key</h4><a class="self-link" href="#argon2-operations-import-key" aria-label="Permalink for Section 14.4.2"></a></div>
        
        <ol>
          <li>
            <p>Let <var>keyData</var> be the key data to be imported.</p>
          </li>
          <li>
            <p>
              If <var>format</var> is not "<a data-link-type="idl" href="#dom-keyformat-raw-secret" class="internalDFN" id="ref-for-dom-keyformat-raw-secret-12"><code>raw-secret</code></a>", <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="NotSupportedError" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>
            </p>
          </li>
          <li>
            <p>
              If <var>usages</var> contains a value that is not
              "<code>deriveKey</code>"  or "<code>deriveBits</code>", then
              <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
            </p>
          </li>
          <li>
            <p>
              If <var>extractable</var> is not <code>false</code>,
              then <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
              <a data-link-type="exception" data-lt="SyntaxError" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
            </p>
          </li>
          <li>
            <p>
              Let <var>key</var> be a new <a data-link-type="interface" data-lt="CryptoKey" href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey"><code>CryptoKey</code></a>
              representing <var>keyData</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type"><code>[[type]]</code></a> internal slot of
              <var>key</var> to "<a data-link-type="enum-value" href="https://www.w3.org/TR/webcrypto-2/#dom-keytype-secret"><code>secret</code></a>".
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable"><code>[[extractable]]</code></a> internal slot of
              <var>key</var> to <code>false</code>.
            </p>
          </li>
          <li>
            <p>
              Let <var>algorithm</var> be a new <a data-link-type="dictionary" data-lt="KeyAlgorithm" href="https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>
              object.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name"><code>name</code></a> attribute of
              <var>algorithm</var> to the <a data-link-type="dict-member" href="https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name"><code>name</code></a> member of
              <var>normalizedAlgorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Set the <a href="https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm"><code>[[algorithm]]</code></a> internal
              slot of <var>key</var> to <var>algorithm</var>.
            </p>
          </li>
          <li>
            <p>
              Return <var>key</var>.
            </p>
          </li>
        </ol>
      </section>
      <section id="argon2-operations-get-key-length"><div class="header-wrapper"><h4 id="x14-4-3-get-key-length"><bdi class="secno">14.4.3 </bdi>Get key length</h4><a class="self-link" href="#argon2-operations-get-key-length" aria-label="Permalink for Section 14.4.3"></a></div>
        
        <ol>
          <li>
            <p>
              Return null.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>

  <section id="usage-example"><div class="header-wrapper"><h2 id="x15-usage-example"><bdi class="secno">15. </bdi>Usage Example</h2><a class="self-link" href="#usage-example" aria-label="Permalink for Section 15."></a></div>
    
    <p>
      This example derives a key from a password using Argon2, if available, or PBKDF2, otherwise;
      and then encrypts and decrypts some text with it using AES-OCB, if available, and AES-GCM, otherwise.
    </p>
    <div class="example" id="example-encrypt-some-data-using-a-key-derived-from-a-password">
        <div class="marker">
    <a class="self-link" href="#example-encrypt-some-data-using-a-key-derived-from-a-password">Example<bdi> 1</bdi></a><span class="example-title">: Encrypt some data using a key derived from a password</span>
  </div> <pre aria-busy="false"><code class="hljs js"><span class="hljs-keyword">const</span> password = <span class="hljs-string">'correct horse battery staple'</span>;
<span class="hljs-keyword">const</span> derivationAlg =
  <span class="hljs-title class_">SubtleCrypto</span>.<span class="hljs-property">supports</span>?.(<span class="hljs-string">'importKey'</span>, <span class="hljs-string">'Argon2id'</span>) ?
    <span class="hljs-string">'Argon2id'</span> :
    <span class="hljs-string">'PBKDF2'</span>;
<span class="hljs-keyword">const</span> encryptionAlg =
  <span class="hljs-title class_">SubtleCrypto</span>.<span class="hljs-property">supports</span>?.(<span class="hljs-string">'importKey'</span>, <span class="hljs-string">'AES-OCB'</span>) ?
    <span class="hljs-string">'AES-OCB'</span> :
    <span class="hljs-string">'AES-GCM'</span>;
<span class="hljs-keyword">const</span> passwordKey = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">importKey</span>(
  derivationAlg === <span class="hljs-string">'Argon2id'</span> ? <span class="hljs-string">'raw-secret'</span> : <span class="hljs-string">'raw'</span>,
  <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>().<span class="hljs-title function_">encode</span>(password),
  derivationAlg,
  <span class="hljs-comment">/* extractable: */</span> <span class="hljs-literal">false</span>,
  [<span class="hljs-string">'deriveKey'</span>]
);
<span class="hljs-keyword">const</span> nonce = crypto.<span class="hljs-title function_">getRandomValues</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">16</span>));
<span class="hljs-keyword">const</span> derivationParams =
  derivationAlg === <span class="hljs-string">'Argon2id'</span> ?
    {
      nonce,
      <span class="hljs-attr">parallelism</span>: <span class="hljs-number">4</span>,
      <span class="hljs-attr">memory</span>: <span class="hljs-number">2</span> ** <span class="hljs-number">21</span>,
      <span class="hljs-attr">passes</span>: <span class="hljs-number">1</span>
    } :
    {
      <span class="hljs-attr">salt</span>: nonce,
      <span class="hljs-attr">iterations</span>: <span class="hljs-number">100_000</span>,
      <span class="hljs-attr">hash</span>: <span class="hljs-string">'SHA-256'</span>
    };
<span class="hljs-keyword">const</span> key = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">deriveKey</span>(
  {
    <span class="hljs-attr">name</span>: derivationAlg,
    ...derivationParams
  },
  passwordKey,
  {
    <span class="hljs-attr">name</span>: encryptionAlg,
    <span class="hljs-attr">length</span>: <span class="hljs-number">256</span>
  },
  <span class="hljs-comment">/* extractable: */</span> <span class="hljs-literal">false</span>,
  [<span class="hljs-string">'encrypt'</span>, <span class="hljs-string">'decrypt'</span>]
);
<span class="hljs-keyword">const</span> plaintext = <span class="hljs-string">'Hello, world!'</span>;
<span class="hljs-keyword">const</span> iv = crypto.<span class="hljs-title function_">getRandomValues</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">16</span>));
<span class="hljs-keyword">const</span> encrypted = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">encrypt</span>(
  { <span class="hljs-attr">name</span>: encryptionAlg, iv },
  key,
  <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>().<span class="hljs-title function_">encode</span>(plaintext)
);
<span class="hljs-comment">// Store the derivation and encryption algorithm and parameters</span>
<span class="hljs-comment">// as well as the ciphertext (e.g. in IndexedDB or a database),</span>
<span class="hljs-comment">// and retrieve them later. Then, derive the key using the</span>
<span class="hljs-comment">// original parameters and the password. Here we immediately</span>
<span class="hljs-comment">// use the same key object to decrypt again.</span>
<span class="hljs-keyword">const</span> decrypted = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>().<span class="hljs-title function_">decode</span>(<span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">decrypt</span>(
  { <span class="hljs-attr">name</span>: encryptionAlg, iv },
  key,
  encrypted
));</code></pre>
      </div>
  </section>

  <section id="jwk-mapping" class="appendix informative"><div class="header-wrapper"><h2 id="a-mapping-between-json-web-key-json-web-algorithm"><bdi class="secno">A. </bdi>Mapping between JSON Web Key / JSON Web Algorithm</h2><a class="self-link" href="#jwk-mapping" aria-label="Permalink for Appendix A."></a></div><p><em>This section is non-normative.</em></p>
    
    <p>
      Refer to algorithm-specific sections for the
      normative requirements of importing and exporting JWK.
    </p>
    <section id="algorithm-mappings"><div class="header-wrapper"><h3 id="a-1-algorithm-mappings"><bdi class="secno">A.1 </bdi>Algorithm mappings</h3><a class="self-link" href="#algorithm-mappings" aria-label="Permalink for Appendix A.1"></a></div>
    <table>
      <thead>
        <tr>
          <th scope="col">JSON Web Key</th>
          <th scope="col">AlgorithmIdentifier</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"oct"</span>,
<span class="hljs-attr">alg</span>: <span class="hljs-string">"A128OCB"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"AES-OCB"</span>,
<span class="hljs-attr">length</span>: <span class="hljs-number">128</span> }</code></pre>
          </td>
        </tr>
        <tr>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"oct"</span>,
<span class="hljs-attr">alg</span>: <span class="hljs-string">"A192OCB"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"AES-OCB"</span>,
<span class="hljs-attr">length</span>: <span class="hljs-number">192</span> }</code></pre>
          </td>
        </tr>
        <tr>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"oct"</span>,
<span class="hljs-attr">alg</span>: <span class="hljs-string">"A256OCB"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"AES-OCB"</span>,
<span class="hljs-attr">length</span>: <span class="hljs-number">256</span> }</code></pre>
          </td>
        </tr>
        <tr>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"oct"</span>,
<span class="hljs-attr">alg</span>: <span class="hljs-string">"C20P"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"ChaCha20-Poly1305"</span> }</code></pre>
          </td>
        </tr>
        <tr>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"oct"</span>,
<span class="hljs-attr">alg</span>: <span class="hljs-string">"K128"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"KMAC128"</span> }</code></pre>
          </td>
        </tr>
        <tr>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"oct"</span>,
<span class="hljs-attr">alg</span>: <span class="hljs-string">"K256"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"KMAC256"</span> }</code></pre>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="todo">TODO: register A128OCB, A192OCB, A256OCB, C20P, K128 and K256(?) with IANA in the JSON Web Signature and Encryption Algorithms registry.</div>
    <div class="todo">TODO: register encapsulateKey, encapsulateBits, decapsulateKey and decapsulateBits with IANA in the JSON Web Key Operations registry.</div>
  </section></section>

  <section id="pkcs8-mapping" class="appendix informative"><div class="header-wrapper"><h2 id="b-mapping-between-algorithm-and-pkcs-8-privatekeyinfo"><bdi class="secno">B. </bdi>Mapping between Algorithm and PKCS#8 PrivateKeyInfo</h2><a class="self-link" href="#pkcs8-mapping" aria-label="Permalink for Appendix B."></a></div><p><em>This section is non-normative.</em></p>
    
    <p>
      Refer to algorithm-specific sections for the
      normative requirements of importing and exporting PKCS#8 PrivateKeyInfo.
    </p>
    <table>
      <thead>
        <tr>
          <th scope="col">privateKeyAlgorithm</th>
          <th scope="col">privateKey format</th>
          <th scope="col">AlgorithmIdentifier</th>
          <th scope="col">Reference</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id-ml-dsa-44 (2.16.840.1.101.3.4.3.17)</td>
          <td>ML-DSA-44-PrivateKey</td>
          <td>
            "<code>ML-DSA-44</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-draft-ietf-lamps-dilithium-certificates" title="Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Digital Signature Algorithm (ML-DSA)">draft-ietf-lamps-dilithium-certificates</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-ml-dsa-65 (2.16.840.1.101.3.4.3.18)</td>
          <td>ML-DSA-65-PrivateKey</td>
          <td>
            "<code>ML-DSA-65</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-draft-ietf-lamps-dilithium-certificates" title="Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Digital Signature Algorithm (ML-DSA)">draft-ietf-lamps-dilithium-certificates</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-ml-dsa-87 (2.16.840.1.101.3.4.3.19)</td>
          <td>ML-DSA-87-PrivateKey</td>
          <td>
            "<code>ML-DSA-87</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-draft-ietf-lamps-dilithium-certificates" title="Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Digital Signature Algorithm (ML-DSA)">draft-ietf-lamps-dilithium-certificates</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-alg-ml-kem-512 (2.16.840.1.101.3.4.4.1)</td>
          <td>ML-KEM-512-PrivateKey</td>
          <td>
            "<code>ML-KEM-512</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-draft-ietf-lamps-kyber-certificates" title="Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Key-Encapsulation Mechanism (ML-KEM)">draft-ietf-lamps-kyber-certificates</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-alg-ml-kem-768 (2.16.840.1.101.3.4.4.2)</td>
          <td>ML-KEM-768-PrivateKey</td>
          <td>
            "<code>ML-KEM-768</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-draft-ietf-lamps-kyber-certificates" title="Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Key-Encapsulation Mechanism (ML-KEM)">draft-ietf-lamps-kyber-certificates</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-alg-ml-kem-1024 (2.16.840.1.101.3.4.4.3)</td>
          <td>ML-KEM-1024-PrivateKey</td>
          <td>
            "<code>ML-KEM-1024</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-draft-ietf-lamps-kyber-certificates" title="Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Key-Encapsulation Mechanism (ML-KEM)">draft-ietf-lamps-kyber-certificates</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-sha2-128s (2.16.840.1.101.3.4.3.20)</td>
          <td>OCTET STRING</td>
          <td>
            "<code>SLH-DSA-SHA2-128s</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-sha2-128f (2.16.840.1.101.3.4.3.21)</td>
          <td>OCTET STRING</td>
          <td>
            "<code>SLH-DSA-SHA2-128f</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-sha2-192s (2.16.840.1.101.3.4.3.22)</td>
          <td>OCTET STRING</td>
          <td>
            "<code>SLH-DSA-SHA2-192s</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-sha2-192f (2.16.840.1.101.3.4.3.23)</td>
          <td>OCTET STRING</td>
          <td>
            "<code>SLH-DSA-SHA2-192f</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-sha2-256s (2.16.840.1.101.3.4.3.24)</td>
          <td>OCTET STRING</td>
          <td>
            "<code>SLH-DSA-SHA2-256s</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-sha2-256f (2.16.840.1.101.3.4.3.25)</td>
          <td>OCTET STRING</td>
          <td>
            "<code>SLH-DSA-SHA2-256f</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-shake-128s (2.16.840.1.101.3.4.3.26)</td>
          <td>OCTET STRING</td>
          <td>
            "<code>SLH-DSA-SHAKE-128s</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-shake-128f (2.16.840.1.101.3.4.3.27)</td>
          <td>OCTET STRING</td>
          <td>
            "<code>SLH-DSA-SHAKE-128f</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-shake-192s (2.16.840.1.101.3.4.3.28)</td>
          <td>OCTET STRING</td>
          <td>
            "<code>SLH-DSA-SHAKE-192s</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-shake-192f (2.16.840.1.101.3.4.3.29)</td>
          <td>OCTET STRING</td>
          <td>
            "<code>SLH-DSA-SHAKE-192f</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-shake-256s (2.16.840.1.101.3.4.3.30)</td>
          <td>OCTET STRING</td>
          <td>
            "<code>SLH-DSA-SHAKE-256s</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-shake-256f (2.16.840.1.101.3.4.3.31)</td>
          <td>OCTET STRING</td>
          <td>
            "<code>SLH-DSA-SHAKE-256f</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
      </tbody>
    </table>
  </section>

  <section id="spki-mapping" class="appendix informative"><div class="header-wrapper"><h2 id="c-mapping-between-algorithm-and-subjectpublickeyinfo"><bdi class="secno">C. </bdi>Mapping between Algorithm and SubjectPublicKeyInfo</h2><a class="self-link" href="#spki-mapping" aria-label="Permalink for Appendix C."></a></div><p><em>This section is non-normative.</em></p>
    
    <p class="norm">
      Refer to algorithm-specific sections for the
      normative requirements of importing and exporting SPKI.
    </p>
    <table>
      <thead>
        <tr>
          <th scope="col">Algorithm OID</th>
          <th scope="col">subjectPublicKey ASN.1 structure</th>
          <th scope="col">AlgorithmIdentifier</th>
          <th scope="col">Reference</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id-ml-dsa-44 (2.16.840.1.101.3.4.3.17)</td>
          <td>BIT STRING</td>
          <td>
            "<code>ML-DSA-44</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-draft-ietf-lamps-dilithium-certificates" title="Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Digital Signature Algorithm (ML-DSA)">draft-ietf-lamps-dilithium-certificates</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-ml-dsa-65 (2.16.840.1.101.3.4.3.18)</td>
          <td>BIT STRING</td>
          <td>
            "<code>ML-DSA-65</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-draft-ietf-lamps-dilithium-certificates" title="Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Digital Signature Algorithm (ML-DSA)">draft-ietf-lamps-dilithium-certificates</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-ml-dsa-87 (2.16.840.1.101.3.4.3.19)</td>
          <td>BIT STRING</td>
          <td>
            "<code>ML-DSA-87</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-draft-ietf-lamps-dilithium-certificates" title="Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Digital Signature Algorithm (ML-DSA)">draft-ietf-lamps-dilithium-certificates</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-alg-ml-kem-512 (2.16.840.1.101.3.4.4.1)</td>
          <td>BIT STRING</td>
          <td>
            "<code>ML-KEM-512</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-draft-ietf-lamps-kyber-certificates" title="Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Key-Encapsulation Mechanism (ML-KEM)">draft-ietf-lamps-kyber-certificates</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-alg-ml-kem-768 (2.16.840.1.101.3.4.4.2)</td>
          <td>BIT STRING</td>
          <td>
            "<code>ML-KEM-768</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-draft-ietf-lamps-kyber-certificates" title="Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Key-Encapsulation Mechanism (ML-KEM)">draft-ietf-lamps-kyber-certificates</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-alg-ml-kem-1024 (2.16.840.1.101.3.4.4.3)</td>
          <td>BIT STRING</td>
          <td>
            "<code>ML-KEM-1024</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-draft-ietf-lamps-kyber-certificates" title="Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Key-Encapsulation Mechanism (ML-KEM)">draft-ietf-lamps-kyber-certificates</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-sha2-128s (2.16.840.1.101.3.4.3.20)</td>
          <td>BIT STRING</td>
          <td>
            "<code>SLH-DSA-SHA2-128s</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-sha2-128f (2.16.840.1.101.3.4.3.21)</td>
          <td>BIT STRING</td>
          <td>
            "<code>SLH-DSA-SHA2-128f</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-sha2-192s (2.16.840.1.101.3.4.3.22)</td>
          <td>BIT STRING</td>
          <td>
            "<code>SLH-DSA-SHA2-192s</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-sha2-192f (2.16.840.1.101.3.4.3.23)</td>
          <td>BIT STRING</td>
          <td>
            "<code>SLH-DSA-SHA2-192f</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-sha2-256s (2.16.840.1.101.3.4.3.24)</td>
          <td>BIT STRING</td>
          <td>
            "<code>SLH-DSA-SHA2-256s</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-sha2-256f (2.16.840.1.101.3.4.3.25)</td>
          <td>BIT STRING</td>
          <td>
            "<code>SLH-DSA-SHA2-256f</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-shake-128s (2.16.840.1.101.3.4.3.26)</td>
          <td>BIT STRING</td>
          <td>
            "<code>SLH-DSA-SHAKE-128s</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-shake-128f (2.16.840.1.101.3.4.3.27)</td>
          <td>BIT STRING</td>
          <td>
            "<code>SLH-DSA-SHAKE-128f</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-shake-192s (2.16.840.1.101.3.4.3.28)</td>
          <td>BIT STRING</td>
          <td>
            "<code>SLH-DSA-SHAKE-192s</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-shake-192f (2.16.840.1.101.3.4.3.29)</td>
          <td>BIT STRING</td>
          <td>
            "<code>SLH-DSA-SHAKE-192f</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-shake-256s (2.16.840.1.101.3.4.3.30)</td>
          <td>BIT STRING</td>
          <td>
            "<code>SLH-DSA-SHAKE-256s</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
        <tr>
          <td>id-slh-dsa-shake-256f (2.16.840.1.101.3.4.3.31)</td>
          <td>BIT STRING</td>
          <td>
            "<code>SLH-DSA-SHAKE-256f</code>"
          </td>
          <td>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-csor" title="Computer Security Objects Register">CSOR</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9814" title="Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)">RFC9814</a></cite>]
          </td>
        </tr>
      </tbody>
    </table>
  </section>

  <section id="conformance"><div class="header-wrapper"><h2 id="d-conformance"><bdi class="secno">D. </bdi>Conformance</h2><a class="self-link" href="#conformance" aria-label="Permalink for Section D."></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key word <em class="rfc2119">MUST</em> in this document
        is to be interpreted as described in
        <a href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, it appears in all
        capitals, as shown here.
      </p></section>



<section id="references" class="appendix"><div class="header-wrapper"><h2 id="e-references"><bdi class="secno">E. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix E."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="e-1-normative-references"><bdi class="secno">E.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix E.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-draft-ietf-cose-dilithium-07">[draft-ietf-cose-dilithium-07]</dt><dd>
      <a href="https://www.ietf.org/archive/id/draft-ietf-cose-dilithium-07.html"><cite>ML-DSA for JOSE and COSE</cite></a>.  IETF. June 2025. URL: <a href="https://www.ietf.org/archive/id/draft-ietf-cose-dilithium-07.html">https://www.ietf.org/archive/id/draft-ietf-cose-dilithium-07.html</a>
    </dd><dt id="bib-draft-ietf-jose-pqc-kem-01">[draft-ietf-jose-pqc-kem-01]</dt><dd>
      <a href="https://www.ietf.org/archive/id/draft-ietf-jose-pqc-kem-01.html"><cite>Post-Quantum Key Encapsulation Mechanisms (PQ KEMs) for JOSE and COSE</cite></a>.  IETF. May 2025. URL: <a href="https://www.ietf.org/archive/id/draft-ietf-jose-pqc-kem-01.html">https://www.ietf.org/archive/id/draft-ietf-jose-pqc-kem-01.html</a>
    </dd><dt id="bib-fips-202">[FIPS-202]</dt><dd>
      <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf"><cite>SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions</cite></a>.  NIST. August 2015. URL: <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf</a>
    </dd><dt id="bib-fips-203">[FIPS-203]</dt><dd>
      <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf"><cite>Module-Lattice-Based Key-Encapsulation Mechanism Standard</cite></a>.  NIST. August 2024. URL: <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf</a>
    </dd><dt id="bib-fips-204">[FIPS-204]</dt><dd>
      <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf"><cite>Module-Lattice-Based Digital Signature Standard</cite></a>.  NIST. August 2024. URL: <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf</a>
    </dd><dt id="bib-fips-205">[FIPS-205]</dt><dd>
      <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.205.pdf"><cite>Stateless Hash-Based Digital Signature Standard</cite></a>.  NIST. August 2024. URL: <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.205.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.205.pdf</a>
    </dd><dt id="bib-html">[html]</dt><dd>
      <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Anne van Kesteren; Domenic Denicola; Dominic Farolino; Ian Hickson; Philip Jägenstedt; Simon Pieters.  WHATWG. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
    </dd><dt id="bib-infra">[infra]</dt><dd>
      <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Anne van Kesteren; Domenic Denicola.  WHATWG. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
    </dd><dt id="bib-jwa">[JWA]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7518"><cite>JSON Web Algorithms (JWA)</cite></a>. M. Jones.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7518">https://www.rfc-editor.org/rfc/rfc7518</a>
    </dd><dt id="bib-jwk">[JWK]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7517"><cite>JSON Web Key (JWK)</cite></a>. M. Jones.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>
    </dd><dt id="bib-nist-sp800-185">[NIST-SP800-185]</dt><dd>
      <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf"><cite>NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash</cite></a>.  NIST. December 2016. URL: <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc5208">[RFC5208]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc5208"><cite>Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2</cite></a>. B. Kaliski.  IETF. May 2008. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc5208">https://www.rfc-editor.org/rfc/rfc5208</a>
    </dd><dt id="bib-rfc5280">[RFC5280]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc5280"><cite>Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</cite></a>. D. Cooper; S. Santesson; S. Farrell; S. Boeyen; R. Housley; W. Polk.  IETF. May 2008. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>
    </dd><dt id="bib-rfc7253">[RFC7253]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7253"><cite>The OCB Authenticated-Encryption Algorithm</cite></a>. T. Krovetz; P. Rogaway.  IETF. May 2014. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc7253">https://www.rfc-editor.org/rfc/rfc7253</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-rfc8439">[RFC8439]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8439"><cite>ChaCha20 and Poly1305 for IETF Protocols</cite></a>. Y. Nir; A. Langley.  IETF. June 2018. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc8439">https://www.rfc-editor.org/rfc/rfc8439</a>
    </dd><dt id="bib-rfc9106">[RFC9106]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc9106"><cite>Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications</cite></a>. A. Biryukov; D. Dinu; D. Khovratovich; S. Josefsson.  IETF. September 2021. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc9106">https://www.rfc-editor.org/rfc/rfc9106</a>
    </dd><dt id="bib-webcrypto">[webcrypto]</dt><dd>
      <a href="https://www.w3.org/TR/webcrypto-2/"><cite>Web Cryptography Level 2</cite></a>. Daniel Huigens.  W3C. 22 April 2025. FPWD. URL: <a href="https://www.w3.org/TR/webcrypto-2/">https://www.w3.org/TR/webcrypto-2/</a>
    </dd><dt id="bib-webidl">[WebIDL]</dt><dd>
      <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Edgar Chen; Timothy Gu.  WHATWG. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
    </dd></dl>
  </section><section id="informative-references"><div class="header-wrapper"><h3 id="e-2-informative-references"><bdi class="secno">E.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix E.2"></a></div>
    
    <dl class="bibliography"><dt id="bib-csor">[CSOR]</dt><dd>
      <a href="https://csrc.nist.gov/projects/computer-security-objects-register/algorithm-registration"><cite>Computer Security Objects Register</cite></a>.  NIST. URL: <a href="https://csrc.nist.gov/projects/computer-security-objects-register/algorithm-registration">https://csrc.nist.gov/projects/computer-security-objects-register/algorithm-registration</a>
    </dd><dt id="bib-draft-ietf-lamps-dilithium-certificates">[draft-ietf-lamps-dilithium-certificates]</dt><dd>
      <a href="https://datatracker.ietf.org/doc/draft-ietf-lamps-dilithium-certificates/"><cite>Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Digital Signature Algorithm (ML-DSA)</cite></a>.  IETF. URL: <a href="https://datatracker.ietf.org/doc/draft-ietf-lamps-dilithium-certificates/">https://datatracker.ietf.org/doc/draft-ietf-lamps-dilithium-certificates/</a>
    </dd><dt id="bib-draft-ietf-lamps-kyber-certificates">[draft-ietf-lamps-kyber-certificates]</dt><dd>
      <a href="https://datatracker.ietf.org/doc/draft-ietf-lamps-kyber-certificates/"><cite>Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Key-Encapsulation Mechanism (ML-KEM)</cite></a>.  IETF. URL: <a href="https://datatracker.ietf.org/doc/draft-ietf-lamps-kyber-certificates/">https://datatracker.ietf.org/doc/draft-ietf-lamps-kyber-certificates/</a>
    </dd><dt id="bib-rfc9814">[RFC9814]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc9814"><cite>Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)</cite></a>. R. Housley; S. Fluhrer; P. Kampanakis; B. Westerbaan.  IETF. July 2025. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9814">https://www.rfc-editor.org/rfc/rfc9814</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyformat" aria-label="Links in this document to definition: KeyFormat">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyformat" aria-label="Permalink for definition: KeyFormat. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyformat-raw" aria-label="Links in this document to definition: raw">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyformat-raw" aria-label="Permalink for definition: raw. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-keyformat-raw-1" title="§ 3.1.1 Key Formats">§ 3.1.1 Key Formats</a> <a href="#ref-for-dom-keyformat-raw-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-keyformat-raw-3" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyformat-spki" aria-label="Links in this document to definition: spki">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyformat-spki" aria-label="Permalink for definition: spki. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-keyformat-spki-1" title="§ 6.3.4 Import Key">§ 6.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-spki-2" title="§ 6.3.5 Export Key">§ 6.3.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-spki-3" title="§ 7.4.4 Import Key">§ 7.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-spki-4" title="§ 7.4.5 Export Key">§ 7.4.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-spki-5" title="§ 8.3.4 Import Key">§ 8.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-spki-6" title="§ 8.3.5 Export Key">§ 8.3.5 Export Key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyformat-pkcs8" aria-label="Links in this document to definition: pkcs8">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyformat-pkcs8" aria-label="Permalink for definition: pkcs8. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-keyformat-pkcs8-1" title="§ 6.3.4 Import Key">§ 6.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-pkcs8-2" title="§ 6.3.5 Export Key">§ 6.3.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-pkcs8-3" title="§ 7.4.4 Import Key">§ 7.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-pkcs8-4" title="§ 7.4.5 Export Key">§ 7.4.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-pkcs8-5" title="§ 8.3.4 Import Key">§ 8.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-pkcs8-6" title="§ 8.3.5 Export Key">§ 8.3.5 Export Key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyformat-jwk" aria-label="Links in this document to definition: jwk">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyformat-jwk" aria-label="Permalink for definition: jwk. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-keyformat-jwk-1" title="§ 6.3.4 Import Key">§ 6.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-jwk-2" title="§ 6.3.5 Export Key">§ 6.3.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-jwk-3" title="§ 7.4.4 Import Key">§ 7.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-jwk-4" title="§ 7.4.5 Export Key">§ 7.4.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-jwk-5" title="§ 8.3.4 Import Key">§ 8.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-jwk-6" title="§ 8.3.5 Export Key">§ 8.3.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-jwk-7" title="§ 9.4.4 Import Key">§ 9.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-jwk-8" title="§ 9.4.5 Export Key">§ 9.4.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-jwk-9" title="§ 10.3.4 Import Key">§ 10.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-jwk-10" title="§ 10.3.5 Export Key">§ 10.3.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-jwk-11" title="§ 13.7.4 Import Key">§ 13.7.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-jwk-12" title="§ 13.7.5 Export Key">§ 13.7.5 Export Key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyformat-raw-public" aria-label="Links in this document to definition: raw-public">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyformat-raw-public" aria-label="Permalink for definition: raw-public. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1896181443">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-keyformat-raw-public-1" title="§ 3.1.1 Key Formats">§ 3.1.1 Key Formats</a> <a href="#ref-for-dom-keyformat-raw-public-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-public-3" title="§ 6.3.4 Import Key">§ 6.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-public-4" title="§ 6.3.5 Export Key">§ 6.3.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-public-5" title="§ 7.4.4 Import Key">§ 7.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-public-6" title="§ 7.4.5 Export Key">§ 7.4.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-public-7" title="§ 8.3.4 Import Key">§ 8.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-public-8" title="§ 8.3.5 Export Key">§ 8.3.5 Export Key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyformat-raw-private" aria-label="Links in this document to definition: raw-private">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyformat-raw-private" aria-label="Permalink for definition: raw-private. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1896181443">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-keyformat-raw-private-1" title="§ 3.1.1 Key Formats">§ 3.1.1 Key Formats</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-private-2" title="§ 8.3.4 Import Key">§ 8.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-private-3" title="§ 8.3.5 Export Key">§ 8.3.5 Export Key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyformat-raw-seed" aria-label="Links in this document to definition: raw-seed">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyformat-raw-seed" aria-label="Permalink for definition: raw-seed. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1896181443">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-keyformat-raw-seed-1" title="§ 3.1.1 Key Formats">§ 3.1.1 Key Formats</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-seed-2" title="§ 6.3.4 Import Key">§ 6.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-seed-3" title="§ 6.3.5 Export Key">§ 6.3.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-seed-4" title="§ 7.4.4 Import Key">§ 7.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-seed-5" title="§ 7.4.5 Export Key">§ 7.4.5 Export Key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyformat-raw-secret" aria-label="Links in this document to definition: raw-secret">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyformat-raw-secret" aria-label="Permalink for definition: raw-secret. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1896181443">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-keyformat-raw-secret-1" title="§ 3.1.1 Key Formats">§ 3.1.1 Key Formats</a> <a href="#ref-for-dom-keyformat-raw-secret-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-keyformat-raw-secret-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-secret-4" title="§ 3.2.1 The encapsulateKey method">§ 3.2.1 The encapsulateKey method</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-secret-5" title="§ 3.2.3 The decapsulateKey method">§ 3.2.3 The decapsulateKey method</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-secret-6" title="§ 9.4.4 Import Key">§ 9.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-secret-7" title="§ 9.4.5 Export Key">§ 9.4.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-secret-8" title="§ 10.3.4 Import Key">§ 10.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-secret-9" title="§ 10.3.5 Export Key">§ 10.3.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-secret-10" title="§ 13.7.4 Import Key">§ 13.7.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-secret-11" title="§ 13.7.5 Export Key">§ 13.7.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-keyformat-raw-secret-12" title="§ 14.4.2 Import key">§ 14.4.2 Import key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyusage" aria-label="Links in this document to definition: KeyUsage">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyusage" aria-label="Permalink for definition: KeyUsage. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-keyusage-1" title="§ 3. Partial SubtleCrypto interface">§ 3. Partial SubtleCrypto interface</a> <a href="#ref-for-dom-keyusage-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-keyusage-3" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyusage-encrypt" aria-label="Links in this document to definition: encrypt">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyusage-encrypt" aria-label="Permalink for definition: encrypt. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyusage-decrypt" aria-label="Links in this document to definition: decrypt">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyusage-decrypt" aria-label="Permalink for definition: decrypt. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyusage-sign" aria-label="Links in this document to definition: sign">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyusage-sign" aria-label="Permalink for definition: sign. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyusage-verify" aria-label="Links in this document to definition: verify">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyusage-verify" aria-label="Permalink for definition: verify. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyusage-derivekey" aria-label="Links in this document to definition: deriveKey">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyusage-derivekey" aria-label="Permalink for definition: deriveKey. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyusage-derivebits" aria-label="Links in this document to definition: deriveBits">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyusage-derivebits" aria-label="Permalink for definition: deriveBits. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyusage-wrapkey" aria-label="Links in this document to definition: wrapKey">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyusage-wrapkey" aria-label="Permalink for definition: wrapKey. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyusage-unwrapkey" aria-label="Links in this document to definition: unwrapKey">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyusage-unwrapkey" aria-label="Permalink for definition: unwrapKey. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyusage-encapsulatekey" aria-label="Links in this document to definition: encapsulateKey">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyusage-encapsulatekey" aria-label="Permalink for definition: encapsulateKey. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-712964944">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-keyusage-encapsulatekey-1" title="§ 3.1.2 Key Usages">§ 3.1.2 Key Usages</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyusage-encapsulatebits" aria-label="Links in this document to definition: encapsulateBits">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyusage-encapsulatebits" aria-label="Permalink for definition: encapsulateBits. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-712964944">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-keyusage-encapsulatebits-1" title="§ 3.1.2 Key Usages">§ 3.1.2 Key Usages</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyusage-decapsulatekey" aria-label="Links in this document to definition: decapsulateKey">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyusage-decapsulatekey" aria-label="Permalink for definition: decapsulateKey. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-712964944">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-keyusage-decapsulatekey-1" title="§ 3.1.2 Key Usages">§ 3.1.2 Key Usages</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-keyusage-decapsulatebits" aria-label="Links in this document to definition: decapsulateBits">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-keyusage-decapsulatebits" aria-label="Permalink for definition: decapsulateBits. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-712964944">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-keyusage-decapsulatebits-1" title="§ 3.1.2 Key Usages">§ 3.1.2 Key Usages</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-SubtleCrypto-method-encapsulateKey" aria-label="Links in this document to definition: encapsulateKey(encapsulationAlgorithm, encapsulationKey, sharedKeyAlgorithm, extractable, usages)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-SubtleCrypto-method-encapsulateKey" aria-label="Permalink for definition: encapsulateKey(encapsulationAlgorithm, encapsulationKey, sharedKeyAlgorithm, extractable, usages). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-993669945">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-SubtleCrypto-method-encapsulateKey-1" title="§ 1. Introduction">§ 1. Introduction</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-encapsulateKey-2" title="§ 3. Partial SubtleCrypto interface">§ 3. Partial SubtleCrypto interface</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-encapsulateKey-3" title="§ 3.1.2 Key Usages">§ 3.1.2 Key Usages</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-encapsulateKey-4" title="§ 3.2.1 The encapsulateKey method">§ 3.2.1 The encapsulateKey method</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-SubtleCrypto-method-encapsulateBits" aria-label="Links in this document to definition: encapsulateBits(encapsulationAlgorithm, encapsulationKey)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-SubtleCrypto-method-encapsulateBits" aria-label="Permalink for definition: encapsulateBits(encapsulationAlgorithm, encapsulationKey). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-993669945">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-SubtleCrypto-method-encapsulateBits-1" title="§ 1. Introduction">§ 1. Introduction</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-encapsulateBits-2" title="§ 3. Partial SubtleCrypto interface">§ 3. Partial SubtleCrypto interface</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-encapsulateBits-3" title="§ 3.1.2 Key Usages">§ 3.1.2 Key Usages</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-encapsulateBits-4" title="§ 3.2.2 The encapsulateBits method">§ 3.2.2 The encapsulateBits method</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-SubtleCrypto-method-decapsulateKey" aria-label="Links in this document to definition: decapsulateKey(decapsulationAlgorithm, decapsulationKey, ciphertext, sharedKeyAlgorithm, extractable, usages)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-SubtleCrypto-method-decapsulateKey" aria-label="Permalink for definition: decapsulateKey(decapsulationAlgorithm, decapsulationKey, ciphertext, sharedKeyAlgorithm, extractable, usages). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-993669945">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-SubtleCrypto-method-decapsulateKey-1" title="§ 1. Introduction">§ 1. Introduction</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-decapsulateKey-2" title="§ 3. Partial SubtleCrypto interface">§ 3. Partial SubtleCrypto interface</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-decapsulateKey-3" title="§ 3.1.2 Key Usages">§ 3.1.2 Key Usages</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-decapsulateKey-4" title="§ 3.2.3 The decapsulateKey method">§ 3.2.3 The decapsulateKey method</a> <a href="#ref-for-dfn-SubtleCrypto-method-decapsulateKey-5" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-SubtleCrypto-method-decapsulateBits" aria-label="Links in this document to definition: decapsulateBits(decapsulationAlgorithm, decapsulationKey, ciphertext)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-SubtleCrypto-method-decapsulateBits" aria-label="Permalink for definition: decapsulateBits(decapsulationAlgorithm, decapsulationKey, ciphertext). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-993669945">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-SubtleCrypto-method-decapsulateBits-1" title="§ 1. Introduction">§ 1. Introduction</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-decapsulateBits-2" title="§ 3. Partial SubtleCrypto interface">§ 3. Partial SubtleCrypto interface</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-decapsulateBits-3" title="§ 3.1.2 Key Usages">§ 3.1.2 Key Usages</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-decapsulateBits-4" title="§ 3.2.4 The decapsulateBits method">§ 3.2.4 The decapsulateBits method</a> <a href="#ref-for-dfn-SubtleCrypto-method-decapsulateBits-5" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-SubtleCrypto-method-getPublicKey" aria-label="Links in this document to definition: getPublicKey(key, usages)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-SubtleCrypto-method-getPublicKey" aria-label="Permalink for definition: getPublicKey(key, usages). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-993669945">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-SubtleCrypto-method-getPublicKey-1" title="§ 1. Introduction">§ 1. Introduction</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-getPublicKey-2" title="§ 3. Partial SubtleCrypto interface">§ 3. Partial SubtleCrypto interface</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-getPublicKey-3" title="§ 3.2.5 The getPublicKey method">§ 3.2.5 The getPublicKey method</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-SubtleCrypto-method-supports" aria-label="Links in this document to definition: supports(operation, algorithm, length)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-SubtleCrypto-method-supports" aria-label="Permalink for definition: supports(operation, algorithm, length). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-993669945">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-SubtleCrypto-method-supports-1" title="§ 1. Introduction">§ 1. Introduction</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-supports-2" title="§ 3. Partial SubtleCrypto interface">§ 3. Partial SubtleCrypto interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-SubtleCrypto-method-supports-additionalAlgorithm" aria-label="Links in this document to definition: supports(operation, algorithm, additionalAlgorithm)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-SubtleCrypto-method-supports-additionalAlgorithm" aria-label="Permalink for definition: supports(operation, algorithm, additionalAlgorithm). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-993669945">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-SubtleCrypto-method-supports-additionalAlgorithm-1" title="§ 3. Partial SubtleCrypto interface">§ 3. Partial SubtleCrypto interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-check-support-for-algorithm" aria-label="Links in this document to definition: check support for an algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-check-support-for-algorithm" aria-label="Permalink for definition: check support for an algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-check-support-for-algorithm-1" title="§ 3.2.6 The supports method">§ 3.2.6 The supports method</a> <a href="#ref-for-dfn-check-support-for-algorithm-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-check-support-for-algorithm-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-check-support-for-algorithm-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-check-support-for-algorithm-5" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-check-support-for-algorithm-6" title="§ 3.3 Checking support for an algorithm">§ 3.3 Checking support for an algorithm</a> <a href="#ref-for-dfn-check-support-for-algorithm-7" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-EncapsulatedKey" aria-label="Links in this document to definition: EncapsulatedKey">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-EncapsulatedKey" aria-label="Permalink for definition: EncapsulatedKey. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-549016948">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-EncapsulatedKey-1" title="§ 3. Partial SubtleCrypto interface">§ 3. Partial SubtleCrypto interface</a> 
    </li><li>
      <a href="#ref-for-dfn-EncapsulatedKey-2" title="§ 3.2.1 The encapsulateKey method">§ 3.2.1 The encapsulateKey method</a> <a href="#ref-for-dfn-EncapsulatedKey-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-EncapsulatedKey-4" title="§ 4. Encapsulation dictionaries">§ 4. Encapsulation dictionaries</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-EncapsulatedKey-sharedKey" aria-label="Links in this document to definition: sharedKey">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-EncapsulatedKey-sharedKey" aria-label="Permalink for definition: sharedKey. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-549016948">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-EncapsulatedKey-sharedKey-1" title="§ 3.2.1 The encapsulateKey method">§ 3.2.1 The encapsulateKey method</a> 
    </li><li>
      <a href="#ref-for-dfn-EncapsulatedKey-sharedKey-2" title="§ 4. Encapsulation dictionaries">§ 4. Encapsulation dictionaries</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-EncapsulatedKey-ciphertext" aria-label="Links in this document to definition: ciphertext">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-EncapsulatedKey-ciphertext" aria-label="Permalink for definition: ciphertext. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-549016948">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-EncapsulatedKey-ciphertext-1" title="§ 3.2.1 The encapsulateKey method">§ 3.2.1 The encapsulateKey method</a> 
    </li><li>
      <a href="#ref-for-dfn-EncapsulatedKey-ciphertext-2" title="§ 4. Encapsulation dictionaries">§ 4. Encapsulation dictionaries</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-EncapsulatedBits" aria-label="Links in this document to definition: EncapsulatedBits">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-EncapsulatedBits" aria-label="Permalink for definition: EncapsulatedBits. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-549016948">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-EncapsulatedBits-1" title="§ 3. Partial SubtleCrypto interface">§ 3. Partial SubtleCrypto interface</a> 
    </li><li>
      <a href="#ref-for-dfn-EncapsulatedBits-2" title="§ 3.2.2 The encapsulateBits method">§ 3.2.2 The encapsulateBits method</a> 
    </li><li>
      <a href="#ref-for-dfn-EncapsulatedBits-3" title="§ 4. Encapsulation dictionaries">§ 4. Encapsulation dictionaries</a> 
    </li><li>
      <a href="#ref-for-dfn-EncapsulatedBits-4" title="§ 6.2 Registration">§ 6.2 Registration</a> 
    </li><li>
      <a href="#ref-for-dfn-EncapsulatedBits-5" title="§ 6.3.1 Encapsulate">§ 6.3.1 Encapsulate</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-EncapsulatedBits-sharedKey" aria-label="Links in this document to definition: sharedKey">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-EncapsulatedBits-sharedKey" aria-label="Permalink for definition: sharedKey. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-549016948">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-EncapsulatedBits-sharedKey-1" title="§ 3.2.1 The encapsulateKey method">§ 3.2.1 The encapsulateKey method</a> 
    </li><li>
      <a href="#ref-for-dfn-EncapsulatedBits-sharedKey-2" title="§ 4. Encapsulation dictionaries">§ 4. Encapsulation dictionaries</a> 
    </li><li>
      <a href="#ref-for-dfn-EncapsulatedBits-sharedKey-3" title="§ 6.3.1 Encapsulate">§ 6.3.1 Encapsulate</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-EncapsulatedBits-ciphertext" aria-label="Links in this document to definition: ciphertext">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-EncapsulatedBits-ciphertext" aria-label="Permalink for definition: ciphertext. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-549016948">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-EncapsulatedBits-ciphertext-1" title="§ 3.2.1 The encapsulateKey method">§ 3.2.1 The encapsulateKey method</a> 
    </li><li>
      <a href="#ref-for-dfn-EncapsulatedBits-ciphertext-2" title="§ 4. Encapsulation dictionaries">§ 4. Encapsulation dictionaries</a> 
    </li><li>
      <a href="#ref-for-dfn-EncapsulatedBits-ciphertext-3" title="§ 6.3.1 Encapsulate">§ 6.3.1 Encapsulate</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-jsonwebkey-kty" aria-label="Links in this document to definition: kty">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-jsonwebkey-kty" aria-label="Permalink for definition: kty. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-jsonwebkey-kty-1" title="§ 6.3.4 Import Key">§ 6.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-kty-2" title="§ 7.4.4 Import Key">§ 7.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-kty-3" title="§ 8.3.4 Import Key">§ 8.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-kty-4" title="§ 9.4.4 Import Key">§ 9.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-kty-5" title="§ 10.3.4 Import Key">§ 10.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-kty-6" title="§ 13.7.4 Import Key">§ 13.7.4 Import Key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-jsonwebkey-use" aria-label="Links in this document to definition: use">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-jsonwebkey-use" aria-label="Permalink for definition: use. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-jsonwebkey-use-1" title="§ 6.3.4 Import Key">§ 6.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-use-2" title="§ 7.4.4 Import Key">§ 7.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-use-3" title="§ 8.3.4 Import Key">§ 8.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-use-4" title="§ 9.4.4 Import Key">§ 9.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-use-5" title="§ 10.3.4 Import Key">§ 10.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-use-6" title="§ 13.7.4 Import Key">§ 13.7.4 Import Key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-jsonwebkey-key_ops" aria-label="Links in this document to definition: key_ops">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-jsonwebkey-key_ops" aria-label="Permalink for definition: key_ops. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-jsonwebkey-key_ops-1" title="§ 6.3.4 Import Key">§ 6.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-key_ops-2" title="§ 7.4.4 Import Key">§ 7.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-key_ops-3" title="§ 8.3.4 Import Key">§ 8.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-key_ops-4" title="§ 9.4.4 Import Key">§ 9.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-key_ops-5" title="§ 10.3.4 Import Key">§ 10.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-key_ops-6" title="§ 13.7.4 Import Key">§ 13.7.4 Import Key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-jsonwebkey-alg" aria-label="Links in this document to definition: alg">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-jsonwebkey-alg" aria-label="Permalink for definition: alg. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-jsonwebkey-alg-1" title="§ 6.3.4 Import Key">§ 6.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-alg-2" title="§ 7.4.4 Import Key">§ 7.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-alg-3" title="§ 8.3.4 Import Key">§ 8.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-alg-4" title="§ 9.4.4 Import Key">§ 9.4.4 Import Key</a> <a href="#ref-for-dom-jsonwebkey-alg-5" title="Reference 2">(2)</a> <a href="#ref-for-dom-jsonwebkey-alg-6" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-alg-7" title="§ 10.3.4 Import Key">§ 10.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-alg-8" title="§ 13.7.4 Import Key">§ 13.7.4 Import Key</a> <a href="#ref-for-dom-jsonwebkey-alg-9" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-jsonwebkey-ext" aria-label="Links in this document to definition: ext">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-jsonwebkey-ext" aria-label="Permalink for definition: ext. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-jsonwebkey-ext-1" title="§ 6.3.4 Import Key">§ 6.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-ext-2" title="§ 7.4.4 Import Key">§ 7.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-ext-3" title="§ 8.3.4 Import Key">§ 8.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-ext-4" title="§ 9.4.4 Import Key">§ 9.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-ext-5" title="§ 10.3.4 Import Key">§ 10.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-ext-6" title="§ 13.7.4 Import Key">§ 13.7.4 Import Key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-jsonwebkey-pub" aria-label="Links in this document to definition: pub">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-jsonwebkey-pub" aria-label="Permalink for definition: pub. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-jsonwebkey-pub-1" title="§ 5. JsonWebKey dictionary">§ 5. JsonWebKey dictionary</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-pub-2" title="§ 6.3.4 Import Key">§ 6.3.4 Import Key</a> <a href="#ref-for-dom-jsonwebkey-pub-3" title="Reference 2">(2)</a> <a href="#ref-for-dom-jsonwebkey-pub-4" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-pub-5" title="§ 6.3.5 Export Key">§ 6.3.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-pub-6" title="§ 7.4.4 Import Key">§ 7.4.4 Import Key</a> <a href="#ref-for-dom-jsonwebkey-pub-7" title="Reference 2">(2)</a> <a href="#ref-for-dom-jsonwebkey-pub-8" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-pub-9" title="§ 7.4.5 Export Key">§ 7.4.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-pub-10" title="§ 8.3.4 Import Key">§ 8.3.4 Import Key</a> <a href="#ref-for-dom-jsonwebkey-pub-11" title="Reference 2">(2)</a> <a href="#ref-for-dom-jsonwebkey-pub-12" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-pub-13" title="§ 8.3.5 Export Key">§ 8.3.5 Export Key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-jsonwebkey-priv" aria-label="Links in this document to definition: priv">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-jsonwebkey-priv" aria-label="Permalink for definition: priv. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-jsonwebkey-priv-1" title="§ 5. JsonWebKey dictionary">§ 5. JsonWebKey dictionary</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-priv-2" title="§ 6.3.4 Import Key">§ 6.3.4 Import Key</a> <a href="#ref-for-dom-jsonwebkey-priv-3" title="Reference 2">(2)</a> <a href="#ref-for-dom-jsonwebkey-priv-4" title="Reference 3">(3)</a> <a href="#ref-for-dom-jsonwebkey-priv-5" title="Reference 4">(4)</a> <a href="#ref-for-dom-jsonwebkey-priv-6" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-priv-7" title="§ 6.3.5 Export Key">§ 6.3.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-priv-8" title="§ 7.4.4 Import Key">§ 7.4.4 Import Key</a> <a href="#ref-for-dom-jsonwebkey-priv-9" title="Reference 2">(2)</a> <a href="#ref-for-dom-jsonwebkey-priv-10" title="Reference 3">(3)</a> <a href="#ref-for-dom-jsonwebkey-priv-11" title="Reference 4">(4)</a> <a href="#ref-for-dom-jsonwebkey-priv-12" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-priv-13" title="§ 7.4.5 Export Key">§ 7.4.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-priv-14" title="§ 8.3.4 Import Key">§ 8.3.4 Import Key</a> <a href="#ref-for-dom-jsonwebkey-priv-15" title="Reference 2">(2)</a> <a href="#ref-for-dom-jsonwebkey-priv-16" title="Reference 3">(3)</a> <a href="#ref-for-dom-jsonwebkey-priv-17" title="Reference 4">(4)</a> <a href="#ref-for-dom-jsonwebkey-priv-18" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dom-jsonwebkey-priv-19" title="§ 8.3.5 Export Key">§ 8.3.5 Export Key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-JsonWebKey" aria-label="Links in this document to definition: JsonWebKey">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-JsonWebKey" aria-label="Permalink for definition: JsonWebKey. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1604149801">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-JsonWebKey-1" title="§ 5. JsonWebKey dictionary">§ 5. JsonWebKey dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-JsonWebKey-2" title="§ 6.3.4 Import Key">§ 6.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dfn-JsonWebKey-3" title="§ 6.3.5 Export Key">§ 6.3.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dfn-JsonWebKey-4" title="§ 7.4.4 Import Key">§ 7.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dfn-JsonWebKey-5" title="§ 7.4.5 Export Key">§ 7.4.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dfn-JsonWebKey-6" title="§ 8.3.4 Import Key">§ 8.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dfn-JsonWebKey-7" title="§ 8.3.5 Export Key">§ 8.3.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dfn-JsonWebKey-8" title="§ 9.4.4 Import Key">§ 9.4.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dfn-JsonWebKey-9" title="§ 9.4.5 Export Key">§ 9.4.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dfn-JsonWebKey-10" title="§ 10.3.4 Import Key">§ 10.3.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dfn-JsonWebKey-11" title="§ 10.3.5 Export Key">§ 10.3.5 Export Key</a> 
    </li><li>
      <a href="#ref-for-dfn-JsonWebKey-12" title="§ 13.7.4 Import Key">§ 13.7.4 Import Key</a> 
    </li><li>
      <a href="#ref-for-dfn-JsonWebKey-13" title="§ 13.7.5 Export Key">§ 13.7.5 Export Key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-ContextParams" aria-label="Links in this document to definition: ContextParams">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-ContextParams" aria-label="Permalink for definition: ContextParams. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1839088126">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-ContextParams-1" title="§ 7.2 Registration">§ 7.2 Registration</a> <a href="#ref-for-dfn-ContextParams-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-ContextParams-3" title="§ 7.3 ContextParams dictionary">§ 7.3 ContextParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-ContextParams-4" title="§ 8.2 Registration">§ 8.2 Registration</a> <a href="#ref-for-dfn-ContextParams-5" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-ContextParams-context" aria-label="Links in this document to definition: context">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-ContextParams-context" aria-label="Permalink for definition: context. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1839088126">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-ContextParams-context-1" title="§ 7.3 ContextParams dictionary">§ 7.3 ContextParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-ContextParams-context-2" title="§ 7.4.1 Sign">§ 7.4.1 Sign</a> <a href="#ref-for-dfn-ContextParams-context-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-ContextParams-context-4" title="§ 7.4.2 Verify">§ 7.4.2 Verify</a> <a href="#ref-for-dfn-ContextParams-context-5" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-ContextParams-context-6" title="§ 8.3.1 Sign">§ 8.3.1 Sign</a> <a href="#ref-for-dfn-ContextParams-context-7" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-ContextParams-context-8" title="§ 8.3.2 Verify">§ 8.3.2 Verify</a> <a href="#ref-for-dfn-ContextParams-context-9" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-AeadParams" aria-label="Links in this document to definition: AeadParams">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-AeadParams" aria-label="Permalink for definition: AeadParams. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1353594407">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-AeadParams-1" title="§ 9.2 Registration">§ 9.2 Registration</a> <a href="#ref-for-dfn-AeadParams-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-3" title="§ 9.3 AeadParams dictionary">§ 9.3 AeadParams dictionary</a> <a href="#ref-for-dfn-AeadParams-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-5" title="§ 10.2 Registration">§ 10.2 Registration</a> <a href="#ref-for-dfn-AeadParams-6" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-AeadParams-iv" aria-label="Links in this document to definition: iv">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-AeadParams-iv" aria-label="Permalink for definition: iv. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1353594407">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-AeadParams-iv-1" title="§ 9.3 AeadParams dictionary">§ 9.3 AeadParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-iv-2" title="§ 9.4.1 Encrypt">§ 9.4.1 Encrypt</a> <a href="#ref-for-dfn-AeadParams-iv-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-iv-4" title="§ 9.4.2 Decrypt">§ 9.4.2 Decrypt</a> <a href="#ref-for-dfn-AeadParams-iv-5" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-iv-6" title="§ 10.3.1 Encrypt">§ 10.3.1 Encrypt</a> <a href="#ref-for-dfn-AeadParams-iv-7" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-iv-8" title="§ 10.3.2 Decrypt">§ 10.3.2 Decrypt</a> <a href="#ref-for-dfn-AeadParams-iv-9" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-AeadParams-additionalData" aria-label="Links in this document to definition: additionalData">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-AeadParams-additionalData" aria-label="Permalink for definition: additionalData. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1353594407">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-AeadParams-additionalData-1" title="§ 9.3 AeadParams dictionary">§ 9.3 AeadParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-additionalData-2" title="§ 9.4.1 Encrypt">§ 9.4.1 Encrypt</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-additionalData-3" title="§ 9.4.2 Decrypt">§ 9.4.2 Decrypt</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-additionalData-4" title="§ 10.3.1 Encrypt">§ 10.3.1 Encrypt</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-additionalData-5" title="§ 10.3.2 Decrypt">§ 10.3.2 Decrypt</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-AeadParams-tagLength" aria-label="Links in this document to definition: tagLength">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-AeadParams-tagLength" aria-label="Permalink for definition: tagLength. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1353594407">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-AeadParams-tagLength-1" title="§ 9.3 AeadParams dictionary">§ 9.3 AeadParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-tagLength-2" title="§ 9.4.1 Encrypt">§ 9.4.1 Encrypt</a> <a href="#ref-for-dfn-AeadParams-tagLength-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-AeadParams-tagLength-4" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-tagLength-5" title="§ 9.4.2 Decrypt">§ 9.4.2 Decrypt</a> <a href="#ref-for-dfn-AeadParams-tagLength-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-AeadParams-tagLength-7" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-tagLength-8" title="§ 10.3.1 Encrypt">§ 10.3.1 Encrypt</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-tagLength-9" title="§ 10.3.2 Decrypt">§ 10.3.2 Decrypt</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-CShakeParams" aria-label="Links in this document to definition: CShakeParams">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-CShakeParams" aria-label="Permalink for definition: CShakeParams. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1097481639">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-CShakeParams-1" title="§ 12.2 Registration">§ 12.2 Registration</a> 
    </li><li>
      <a href="#ref-for-dfn-CShakeParams-2" title="§ 12.3 CShakeParams dictionary">§ 12.3 CShakeParams dictionary</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-CShakeParams-length" aria-label="Links in this document to definition: length">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-CShakeParams-length" aria-label="Permalink for definition: length. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1097481639">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-CShakeParams-length-1" title="§ 12.3 CShakeParams dictionary">§ 12.3 CShakeParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-CShakeParams-length-2" title="§ 12.4.1 Digest">§ 12.4.1 Digest</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-CShakeParams-functionName" aria-label="Links in this document to definition: functionName">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-CShakeParams-functionName" aria-label="Permalink for definition: functionName. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1097481639">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-CShakeParams-functionName-1" title="§ 12.3 CShakeParams dictionary">§ 12.3 CShakeParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-CShakeParams-functionName-2" title="§ 12.4.1 Digest">§ 12.4.1 Digest</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-CShakeParams-customization" aria-label="Links in this document to definition: customization">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-CShakeParams-customization" aria-label="Permalink for definition: customization. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1097481639">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-CShakeParams-customization-1" title="§ 12.3 CShakeParams dictionary">§ 12.3 CShakeParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-CShakeParams-customization-2" title="§ 12.4.1 Digest">§ 12.4.1 Digest</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacKeyGenParams" aria-label="Links in this document to definition: KmacKeyGenParams">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacKeyGenParams" aria-label="Permalink for definition: KmacKeyGenParams. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1224700284">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacKeyGenParams-1" title="§ 13.2 Registration">§ 13.2 Registration</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacKeyGenParams-2" title="§ 13.3 KmacKeyGenParams dictionary">§ 13.3 KmacKeyGenParams dictionary</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacKeyGenParams-length" aria-label="Links in this document to definition: length">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacKeyGenParams-length" aria-label="Permalink for definition: length. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1224700284">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacKeyGenParams-length-1" title="§ 13.3 KmacKeyGenParams dictionary">§ 13.3 KmacKeyGenParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacKeyGenParams-length-2" title="§ 13.7.3 Generate Key">§ 13.7.3 Generate Key</a> <a href="#ref-for-dfn-KmacKeyGenParams-length-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacImportParams" aria-label="Links in this document to definition: KmacImportParams">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacImportParams" aria-label="Permalink for definition: KmacImportParams. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-745655368">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacImportParams-1" title="§ 13.2 Registration">§ 13.2 Registration</a> <a href="#ref-for-dfn-KmacImportParams-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacImportParams-3" title="§ 13.4 KmacImportParams dictionary">§ 13.4 KmacImportParams dictionary</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacImportParams-length" aria-label="Links in this document to definition: length">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacImportParams-length" aria-label="Permalink for definition: length. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-745655368">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacImportParams-length-1" title="§ 13.4 KmacImportParams dictionary">§ 13.4 KmacImportParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacImportParams-length-2" title="§ 13.7.4 Import Key">§ 13.7.4 Import Key</a> <a href="#ref-for-dfn-KmacImportParams-length-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-KmacImportParams-length-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-KmacImportParams-length-5" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacImportParams-length-6" title="§ 13.7.6 Get key length">§ 13.7.6 Get key length</a> <a href="#ref-for-dfn-KmacImportParams-length-7" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacKeyAlgorithm" aria-label="Links in this document to definition: KmacKeyAlgorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacKeyAlgorithm" aria-label="Permalink for definition: KmacKeyAlgorithm. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-28722634">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacKeyAlgorithm-1" title="§ 13.5 KmacKeyAlgorithm dictionary">§ 13.5 KmacKeyAlgorithm dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacKeyAlgorithm-2" title="§ 13.7.3 Generate Key">§ 13.7.3 Generate Key</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacKeyAlgorithm-3" title="§ 13.7.4 Import Key">§ 13.7.4 Import Key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacKeyAlgorithm-length" aria-label="Links in this document to definition: length">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacKeyAlgorithm-length" aria-label="Permalink for definition: length. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-28722634">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacKeyAlgorithm-length-1" title="§ 13.5 KmacKeyAlgorithm dictionary">§ 13.5 KmacKeyAlgorithm dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacKeyAlgorithm-length-2" title="§ 13.7.4 Import Key">§ 13.7.4 Import Key</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacParams" aria-label="Links in this document to definition: KmacParams">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacParams" aria-label="Permalink for definition: KmacParams. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1848208597">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacParams-1" title="§ 13.2 Registration">§ 13.2 Registration</a> <a href="#ref-for-dfn-KmacParams-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacParams-3" title="§ 13.6 KmacParams dictionary">§ 13.6 KmacParams dictionary</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacParams-length" aria-label="Links in this document to definition: length">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacParams-length" aria-label="Permalink for definition: length. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1848208597">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacParams-length-1" title="§ 13.6 KmacParams dictionary">§ 13.6 KmacParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacParams-length-2" title="§ 13.7.1 Sign">§ 13.7.1 Sign</a> <a href="#ref-for-dfn-KmacParams-length-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacParams-length-4" title="§ 13.7.2 Verify">§ 13.7.2 Verify</a> <a href="#ref-for-dfn-KmacParams-length-5" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacParams-customization" aria-label="Links in this document to definition: customization">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacParams-customization" aria-label="Permalink for definition: customization. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1848208597">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacParams-customization-1" title="§ 13.6 KmacParams dictionary">§ 13.6 KmacParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacParams-customization-2" title="§ 13.7.1 Sign">§ 13.7.1 Sign</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacParams-customization-3" title="§ 13.7.2 Verify">§ 13.7.2 Verify</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params" aria-label="Links in this document to definition: Argon2Params">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params" aria-label="Permalink for definition: Argon2Params. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-1" title="§ 14.2 Registration">§ 14.2 Registration</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-2" title="§ 14.3 Argon2Params dictionary">§ 14.3 Argon2Params dictionary</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params-nonce" aria-label="Links in this document to definition: nonce">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params-nonce" aria-label="Permalink for definition: nonce. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-nonce-1" title="§ 14.3 Argon2Params dictionary">§ 14.3 Argon2Params dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-nonce-2" title="§ 14.4.1 Derive Bits">§ 14.4.1 Derive Bits</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params-parallelism" aria-label="Links in this document to definition: parallelism">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params-parallelism" aria-label="Permalink for definition: parallelism. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-parallelism-1" title="§ 14.3 Argon2Params dictionary">§ 14.3 Argon2Params dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-parallelism-2" title="§ 14.4.1 Derive Bits">§ 14.4.1 Derive Bits</a> <a href="#ref-for-dfn-Argon2Params-parallelism-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-Argon2Params-parallelism-4" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params-memory" aria-label="Links in this document to definition: memory">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params-memory" aria-label="Permalink for definition: memory. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-memory-1" title="§ 14.3 Argon2Params dictionary">§ 14.3 Argon2Params dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-memory-2" title="§ 14.4.1 Derive Bits">§ 14.4.1 Derive Bits</a> <a href="#ref-for-dfn-Argon2Params-memory-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params-passes" aria-label="Links in this document to definition: passes">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params-passes" aria-label="Permalink for definition: passes. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-passes-1" title="§ 14.3 Argon2Params dictionary">§ 14.3 Argon2Params dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-passes-2" title="§ 14.4.1 Derive Bits">§ 14.4.1 Derive Bits</a> <a href="#ref-for-dfn-Argon2Params-passes-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params-version" aria-label="Links in this document to definition: version">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params-version" aria-label="Permalink for definition: version. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-version-1" title="§ 14.3 Argon2Params dictionary">§ 14.3 Argon2Params dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-version-2" title="§ 14.4.1 Derive Bits">§ 14.4.1 Derive Bits</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params-secretValue" aria-label="Links in this document to definition: secretValue">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params-secretValue" aria-label="Permalink for definition: secretValue. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-secretValue-1" title="§ 14.3 Argon2Params dictionary">§ 14.3 Argon2Params dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-secretValue-2" title="§ 14.4.1 Derive Bits">§ 14.4.1 Derive Bits</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params-associatedData" aria-label="Links in this document to definition: associatedData">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params-associatedData" aria-label="Permalink for definition: associatedData. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-associatedData-1" title="§ 14.3 Argon2Params dictionary">§ 14.3 Argon2Params dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-associatedData-2" title="§ 14.4.1 Derive Bits">§ 14.4.1 Derive Bits</a> 
    </li>
  </ul>
    </div><script id="respec-highlight-vars">(() => {
// @ts-check

if (document.respec) {
  document.respec.ready.then(setupVarHighlighter);
} else {
  setupVarHighlighter();
}

function setupVarHighlighter() {
  document
    .querySelectorAll("var")
    .forEach(varElem => varElem.addEventListener("click", highlightListener));
}

function highlightListener(ev) {
  ev.stopPropagation();
  const { target: varElem } = ev;
  const hightligtedElems = highlightVars(varElem);
  const resetListener = () => {
    const hlColor = getHighlightColor(varElem);
    hightligtedElems.forEach(el => removeHighlight(el, hlColor));
    [...HL_COLORS.keys()].forEach(key => HL_COLORS.set(key, true));
  };
  if (hightligtedElems.length) {
    document.body.addEventListener("click", resetListener, { once: true });
  }
}

// availability of highlight colors. colors from var.css
const HL_COLORS = new Map([
  ["respec-hl-c1", true],
  ["respec-hl-c2", true],
  ["respec-hl-c3", true],
  ["respec-hl-c4", true],
  ["respec-hl-c5", true],
  ["respec-hl-c6", true],
  ["respec-hl-c7", true],
]);

function getHighlightColor(target) {
  // return current colors if applicable
  const { value } = target.classList;
  const re = /respec-hl-\w+/;
  const activeClass = re.test(value) && value.match(re);
  if (activeClass) return activeClass[0];

  // first color preference
  if (HL_COLORS.get("respec-hl-c1") === true) return "respec-hl-c1";

  // otherwise get some other available color
  return [...HL_COLORS.keys()].find(c => HL_COLORS.get(c)) || "respec-hl-c1";
}

function highlightVars(varElem) {
  const textContent = norm(varElem.textContent);
  const parent = varElem.closest(".algorithm, section");
  const highlightColor = getHighlightColor(varElem);

  const varsToHighlight = [...parent.querySelectorAll("var")].filter(
    el =>
      norm(el.textContent) === textContent &&
      el.closest(".algorithm, section") === parent
  );

  // update availability of highlight color
  const colorStatus = varsToHighlight[0].classList.contains("respec-hl");
  HL_COLORS.set(highlightColor, colorStatus);

  // highlight vars
  if (colorStatus) {
    varsToHighlight.forEach(el => removeHighlight(el, highlightColor));
    return [];
  } else {
    varsToHighlight.forEach(el => addHighlight(el, highlightColor));
  }
  return varsToHighlight;
}

function removeHighlight(el, highlightColor) {
  el.classList.remove("respec-hl", highlightColor);
  // clean up empty class attributes so they don't come in export
  if (!el.classList.length) el.removeAttribute("class");
}

function addHighlight(elem, highlightColor) {
  elem.classList.add("respec-hl", highlightColor);
}

/**
 * Same as `norm` from src/core/utils, but our build process doesn't allow
 * imports in runtime scripts, so duplicated here.
 * @param {string} str
 */
function norm(str) {
  return str.trim().replace(/\s+/g, " ");
}
})()</script><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>